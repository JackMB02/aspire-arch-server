<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Aspire Design Lab - Admin Dashboard</title>

        <!-- Favicon -->
        <link rel="icon" type="image/png" href="/hero%20logo.png" />

        <!-- External Resources -->
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Helvetica+Neue:wght@200;300;400&display=swap"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />

        <style>
            :root {
                --primary: #2c3e50;
                --primary-dark: #1a252f;
                --primary-light: #34495e;
                --accent: #3498db;
                --accent-light: #5dade2;
                --accent-dark: #2980b9;
                --success: #27ae60;
                --warning: #f39c12;
                --danger: #e74c3c;
                --text-light: #ecf0f1;
                --text-muted: #bdc3c7;
                --bg-dark: #1e272e;
                --bg-card: #2d3436;
                --border-light: rgba(255, 255, 255, 0.1);
                --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: "Helvetica Neue", Arial, sans-serif;
                background: var(--bg-dark);
                color: var(--text-light);
                line-height: 1.6;
            }

            .hidden {
                display: none !important;
            }

            /* Login Screen */
            #loginScreen {
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                background: linear-gradient(
                    135deg,
                    var(--primary-dark),
                    var(--primary)
                );
            }

            .card {
                background: var(--bg-card);
                border-radius: 12px;
                box-shadow: var(--shadow);
                padding: 2rem;
                width: 100%;
                max-width: 500px;
                border: 1px solid var(--border-light);
            }

            .login-header {
                text-align: center;
                margin-bottom: 2rem;
            }

            .login-header h1 {
                font-size: 2.5rem;
                font-weight: 300;
                margin-bottom: 0.5rem;
                color: var(--accent-light);
            }

            .login-header p {
                color: var(--text-muted);
                font-size: 1rem;
            }

            .login-title {
                text-align: center;
                margin-bottom: 1.5rem;
                font-weight: 400;
                color: var(--text-light);
            }

            .input-group {
                margin-bottom: 1.5rem;
            }

            .input-group label {
                display: block;
                margin-bottom: 0.5rem;
                color: var(--text-muted);
                font-size: 0.9rem;
            }

            .input-group input,
            .input-group textarea,
            .input-group select {
                width: 100%;
                padding: 0.8rem 1rem;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid var(--border-light);
                border-radius: 8px;
                color: var(--text-light);
                font-size: 1rem;
                transition: all 0.3s ease;
            }

            .input-group input:focus,
            .input-group textarea:focus,
            .input-group select:focus {
                outline: none;
                border-color: var(--accent);
                box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
            }

            .input-group.full-width {
                grid-column: 1 / -1;
            }

            .button-group {
                display: flex;
                gap: 1rem;
                margin-top: 1.5rem;
            }

            .btn-primary,
            .btn-secondary,
            .btn-danger,
            .btn-warning {
                padding: 0.8rem 1.5rem;
                border: none;
                border-radius: 8px;
                font-size: 0.9rem;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 0.5rem;
                font-weight: 500;
            }

            .btn-primary {
                background: var(--accent);
                color: white;
            }

            .btn-primary:hover {
                background: var(--accent-dark);
                transform: translateY(-2px);
            }

            .btn-secondary {
                background: rgba(255, 255, 255, 0.1);
                color: var(--text-light);
                border: 1px solid var(--border-light);
            }

            .btn-secondary:hover {
                background: rgba(255, 255, 255, 0.15);
            }

            .btn-danger {
                background: var(--danger);
                color: white;
            }

            .btn-danger:hover {
                background: #c0392b;
            }

            .btn-warning {
                background: var(--warning);
                color: white;
            }

            .btn-warning:hover {
                background: #e67e22;
            }

            .login-message {
                margin-top: 1rem;
                padding: 0.8rem;
                border-radius: 8px;
                text-align: center;
            }

            .text-danger {
                color: var(--danger);
            }

            .text-warning {
                color: var(--warning);
            }

            .text-success {
                color: var(--success);
            }

            /* Dashboard */
            .dashboard-container {
                display: flex;
                min-height: 100vh;
            }

            /* Sidebar */
            .sidebar {
                width: 280px;
                background: var(--primary-dark);
                border-right: 1px solid var(--border-light);
                transition: transform 0.3s ease;
            }

            .sidebar-header {
                padding: 2rem 1.5rem 1.5rem;
                border-bottom: 1px solid var(--border-light);
                display: flex;
                align-items: center;
                gap: 1rem;
            }

            .sidebar-logo {
                width: 50px;
                height: 50px;
                object-fit: contain;
            }

            .sidebar-header-text {
                flex: 1;
            }

            .sidebar-header h1 {
                font-size: 1.5rem;
                font-weight: 300;
                margin-bottom: 0.5rem;
                color: var(--accent-light);
            }

            .subtitle {
                color: var(--text-muted);
                font-size: 0.9rem;
            }

            .nav-menu {
                padding: 1rem 0;
            }

            .nav-item {
                display: flex;
                align-items: center;
                gap: 1rem;
                padding: 1rem 1.5rem;
                color: var(--text-muted);
                cursor: pointer;
                transition: all 0.3s ease;
                border-left: 3px solid transparent;
            }

            .nav-item:hover {
                background: rgba(255, 255, 255, 0.05);
                color: var(--text-light);
            }

            .nav-item.active {
                background: rgba(52, 152, 219, 0.1);
                color: var(--accent-light);
                border-left-color: var(--accent);
            }

            .nav-item i {
                width: 20px;
                text-align: center;
            }

            /* Main Content */
            .main-content {
                flex: 1;
                display: flex;
                flex-direction: column;
            }

            /* Header */
            .header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 1.5rem 2rem;
                background: var(--primary);
                border-bottom: 1px solid var(--border-light);
            }

            .header-left {
                display: flex;
                align-items: center;
                gap: 1rem;
            }

            .mobile-menu-btn {
                display: none;
                background: none;
                border: none;
                color: var(--text-light);
                font-size: 1.2rem;
                cursor: pointer;
            }

            .header h2 {
                font-weight: 400;
                font-size: 1.5rem;
            }

            .header-right {
                display: flex;
                align-items: center;
                gap: 1.5rem;
            }

            .user-info {
                display: flex;
                align-items: center;
                gap: 1rem;
            }

            .user-avatar {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background: var(--accent);
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .user-details .user-name {
                font-weight: 500;
            }

            .user-details .user-role {
                font-size: 0.8rem;
                color: var(--text-muted);
            }

            /* Content Sections */
            .content {
                flex: 1;
                padding: 2rem;
                overflow-y: auto;
            }

            .section {
                animation: fadeIn 0.5s ease;
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            /* Stats Grid */
            .stats-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
                gap: 1.5rem;
                margin-bottom: 2rem;
            }

            .stat-card {
                background: var(--bg-card);
                border-radius: 12px;
                padding: 1.5rem;
                display: flex;
                align-items: center;
                gap: 1rem;
                border: 1px solid var(--border-light);
                transition: transform 0.3s ease;
            }

            .stat-card:hover {
                transform: translateY(-5px);
            }

            .stat-icon {
                width: 60px;
                height: 60px;
                border-radius: 12px;
                background: rgba(52, 152, 219, 0.1);
                display: flex;
                align-items: center;
                justify-content: center;
                color: var(--accent);
                font-size: 1.5rem;
            }

            .stat-value {
                font-size: 2rem;
                font-weight: 300;
                color: var(--text-light);
            }

            .stat-label {
                color: var(--text-muted);
                font-size: 0.9rem;
            }

            .stats-row {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1rem;
                margin-bottom: 2rem;
            }

            .stat-mini-card {
                background: var(--bg-card);
                border-radius: 8px;
                padding: 1rem;
                text-align: center;
                border: 1px solid var(--border-light);
            }

            .stat-mini-value {
                font-size: 1.8rem;
                font-weight: 300;
                color: var(--text-light);
                margin-bottom: 0.5rem;
            }

            .stat-mini-label {
                color: var(--text-muted);
                font-size: 0.8rem;
            }

            /* Items Grid */
            .items-grid {
                display: grid;
                gap: 1.5rem;
            }

            .item {
                background: var(--bg-card);
                border-radius: 12px;
                padding: 1.5rem;
                border: 1px solid var(--border-light);
                display: flex;
                transition: all 0.3s ease;
            }

            .item:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            }

            .item-content {
                flex: 1;
            }

            .item-content img {
                max-width: 150px !important;
                max-height: 100px !important;
                width: auto !important;
                height: auto !important;
                object-fit: contain;
                border-radius: 4px;
                margin: 0.5rem 0;
            }

            .item-title {
                font-size: 1.2rem;
                margin-bottom: 0.5rem;
                color: var(--text-light);
            }

            .item-meta {
                display: flex;
                gap: 1rem;
                margin-bottom: 1rem;
                font-size: 0.8rem;
                color: var(--text-muted);
            }

            .item-preview {
                color: var(--text-muted);
                margin-bottom: 1rem;
                line-height: 1.5;
            }

            .item-preview img {
                max-width: 150px !important;
                max-height: 100px !important;
                width: auto !important;
                height: auto !important;
                object-fit: contain;
                border-radius: 4px;
                margin: 0.5rem 0;
                display: block;
            }

            .item-actions {
                display: flex;
                gap: 0.5rem;
                flex-wrap: wrap;
            }

            .item-actions button {
                font-size: 0.8rem;
                padding: 0.5rem 1rem;
            }

            /* Submission Items */
            .submission-item {
                background: var(--bg-card);
                border-radius: 12px;
                padding: 1.5rem;
                border: 1px solid var(--border-light);
                margin-bottom: 1rem;
            }

            .submission-item img {
                max-width: 150px !important;
                max-height: 100px !important;
                width: auto !important;
                height: auto !important;
                object-fit: contain;
                border-radius: 4px;
                margin: 0.5rem 0;
            }

            .submission-header {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 1rem;
            }

            .submission-meta {
                display: flex;
                gap: 0.5rem;
                align-items: center;
                margin-top: 1rem;
            }

            .status-badge {
                padding: 0.3rem 0.8rem;
                border-radius: 20px;
                font-size: 0.7rem;
                font-weight: 500;
                text-transform: uppercase;
            }

            .status-new {
                background: rgba(52, 152, 219, 0.2);
                color: var(--accent);
            }

            .status-published {
                background: rgba(39, 174, 96, 0.2);
                color: var(--success);
            }

            .status-draft {
                background: rgba(243, 156, 18, 0.2);
                color: var(--warning);
            }

            .status-archived {
                background: rgba(149, 165, 166, 0.2);
                color: #95a5a6;
            }

            /* Tabs */
            .get-involved-tabs {
                display: flex;
                gap: 0.5rem;
                margin-bottom: 1.5rem;
                flex-wrap: wrap;
            }

            .get-involved-tab {
                padding: 0.8rem 1.5rem;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid var(--border-light);
                border-radius: 8px;
                color: var(--text-muted);
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .get-involved-tab:hover {
                background: rgba(255, 255, 255, 0.08);
            }

            .get-involved-tab.active {
                background: var(--accent);
                color: white;
                border-color: var(--accent);
            }

            .get-involved-content {
                display: none;
            }

            .get-involved-content.active {
                display: block;
            }

            /* Form Grid */
            .form-grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1.5rem;
                margin-bottom: 1.5rem;
            }

            /* Toggle Switch */
            .toggle-switch {
                display: flex;
                align-items: center;
                gap: 0.8rem;
                cursor: pointer;
            }

            .toggle-switch input {
                display: none;
            }

            .toggle-slider {
                width: 50px;
                height: 24px;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 24px;
                position: relative;
                transition: all 0.3s ease;
            }

            .toggle-slider:before {
                content: "";
                position: absolute;
                width: 20px;
                height: 20px;
                border-radius: 50%;
                background: var(--text-muted);
                top: 2px;
                left: 2px;
                transition: all 0.3s ease;
            }

            .toggle-switch input:checked + .toggle-slider {
                background: var(--accent);
            }

            .toggle-switch input:checked + .toggle-slider:before {
                transform: translateX(26px);
                background: white;
            }

            /* File Upload */
            .file-upload-container {
                border: 2px dashed var(--border-light);
                border-radius: 8px;
                padding: 2rem;
                text-align: center;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .file-upload-container:hover {
                border-color: var(--accent);
                background: rgba(52, 152, 219, 0.05);
            }

            .upload-icon {
                font-size: 2rem;
                color: var(--text-muted);
                margin-bottom: 1rem;
            }

            .file-upload-container h4 {
                margin-bottom: 0.5rem;
                color: var(--text-light);
            }

            .file-upload-container p {
                color: var(--text-muted);
                margin-bottom: 0.5rem;
            }

            .upload-hint {
                font-size: 0.8rem;
            }

            .file-input {
                display: none;
            }

            .image-preview {
                margin-top: 1rem;
            }

            .image-preview img {
                max-width: 200px;
                border-radius: 8px;
                border: 1px solid var(--border-light);
            }

            .gallery-preview {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
                gap: 0.5rem;
                margin-top: 1rem;
            }

            .gallery-preview img {
                width: 100%;
                height: 80px;
                object-fit: cover;
                border-radius: 6px;
                border: 1px solid var(--border-light);
            }

            /* Modal */
            .modal {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                padding: 1rem;
            }

            .modal .card {
                max-height: 90vh;
                overflow-y: auto;
                max-width: 800px;
                width: 100%;
            }

            .card-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1.5rem;
                padding-bottom: 1rem;
                border-bottom: 1px solid var(--border-light);
            }

            .card-title {
                font-size: 1.5rem;
                font-weight: 400;
                color: var(--text-light);
            }

            /* Filter Buttons */
            .media-filter-buttons {
                display: flex;
                gap: 0.5rem;
                margin-bottom: 1.5rem;
                flex-wrap: wrap;
            }

            .filter-btn {
                padding: 0.5rem 1rem;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid var(--border-light);
                border-radius: 20px;
                color: var(--text-muted);
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 0.8rem;
            }

            .filter-btn:hover {
                background: rgba(255, 255, 255, 0.08);
            }

            .filter-btn.active {
                background: var(--accent);
                color: white;
                border-color: var(--accent);
            }

            /* Filter Section */
            .filter-section {
                margin-bottom: 1.5rem;
                padding: 1rem;
                background: rgba(255, 255, 255, 0.03);
                border-radius: 8px;
                border: 1px solid var(--border-light);
            }

            /* Overlay */
            .overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 999;
                display: none;
            }

            .overlay.active {
                display: block;
            }

            /* Loading Overlay */
            .loading-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 9999;
            }

            .loading-spinner {
                text-align: center;
                color: var(--accent-light);
            }

            .loading-spinner i {
                font-size: 3rem;
                margin-bottom: 1rem;
            }

            .loading-spinner p {
                font-size: 1.2rem;
                margin-top: 1rem;
            }

            /* Responsive */
            @media (max-width: 1024px) {
                .sidebar {
                    position: fixed;
                    top: 0;
                    left: 0;
                    height: 100%;
                    z-index: 1000;
                    transform: translateX(-100%);
                }

                .sidebar.open {
                    transform: translateX(0);
                }

                .mobile-menu-btn {
                    display: block;
                }

                .form-grid {
                    grid-template-columns: 1fr;
                }
            }

            @media (max-width: 768px) {
                .stats-grid {
                    grid-template-columns: 1fr;
                }

                .header {
                    padding: 1rem;
                }

                .content {
                    padding: 1rem;
                }

                .get-involved-tabs {
                    flex-direction: column;
                }

                .get-involved-tab {
                    justify-content: center;
                }

                .button-group {
                    flex-direction: column;
                }

                .button-group button {
                    width: 100%;
                    justify-content: center;
                }

                .submission-header {
                    flex-direction: column;
                    gap: 1rem;
                }

                .submission-meta {
                    flex-wrap: wrap;
                }
            }
        </style>
    </head>
    <body>
        <!-- Login Screen -->
        <div id="loginScreen">
            <div class="card" id="loginCard">
                <div class="login-header">
                    <h1>Aspire Design Lab</h1>
                    <p>Admin Dashboard</p>
                </div>

                <h3 class="login-title">Login to Dashboard</h3>

                <div class="input-group">
                    <label for="username">Username</label>
                    <input
                        id="username"
                        placeholder="Enter username"
                        value="admin"
                    />
                </div>

                <div class="input-group">
                    <label for="password">Password</label>
                    <input
                        id="password"
                        placeholder="Enter password"
                        type="password"
                        value="changeme"
                    />
                </div>

                <div class="button-group login-buttons">
                    <button id="loginBtn" class="btn-primary" type="button">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                </div>

                <div id="loginMsg" class="login-message"></div>
            </div>
        </div>

        <!-- Global Loading Overlay -->
        <div id="loadingOverlay" class="loading-overlay hidden">
            <div class="loading-spinner">
                <i class="fas fa-spinner fa-spin"></i>
                <p id="loadingText">Processing...</p>
            </div>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="hidden">
            <div class="dashboard-container">
                <!-- Sidebar -->
                <div class="sidebar" id="sidebar">
                    <div class="sidebar-header">
                        <img
                            src="/hero%20logo.png"
                            alt="Aspire Logo"
                            class="sidebar-logo"
                        />
                        <div class="sidebar-header-text">
                            <h1>Aspire Design Lab</h1>
                            <div class="subtitle">Admin Dashboard</div>
                        </div>
                    </div>

                    <div class="nav-menu">
                        <div class="nav-item active" data-section="dashboard">
                            <i class="fas fa-chart-line"></i>
                            <span>Dashboard</span>
                        </div>

                        <div class="nav-item" data-section="contact">
                            <i class="fas fa-envelope"></i>
                            <span>Contact Management</span>
                        </div>

                        <div class="nav-item" data-section="getinvolved">
                            <i class="fas fa-handshake"></i>
                            <span>Get Involved</span>
                        </div>

                        <div class="nav-item" data-section="media">
                            <i class="fas fa-images"></i>
                            <span>Media Library</span>
                        </div>

                        <div class="nav-item" data-section="education">
                            <i class="fas fa-graduation-cap"></i>
                            <span>Education</span>
                        </div>

                        <div class="nav-item" data-section="design">
                            <i class="fas fa-pencil-ruler"></i>
                            <span>Design Projects</span>
                        </div>

                        <div class="nav-item" data-section="newsevents">
                            <i class="fas fa-newspaper"></i>
                            <span>News & Events</span>
                        </div>

                        <div class="nav-item" data-section="research">
                            <i class="fas fa-lightbulb"></i>
                            <span>Research Insights</span>
                        </div>

                        <div class="nav-item" data-section="colleagues">
                            <i class="fas fa-university"></i>
                            <span>Architecture Colleagues</span>
                        </div>

                        <div class="nav-item" data-section="settings">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </div>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="main-content">
                    <!-- Header -->
                    <div class="header">
                        <div class="header-left">
                            <button
                                class="mobile-menu-btn"
                                id="mobileMenuBtn"
                                type="button"
                            >
                                <i class="fas fa-bars"></i>
                            </button>
                            <h2 id="pageTitle">Dashboard</h2>
                        </div>

                        <div class="header-right">
                            <div class="user-info">
                                <div class="user-avatar">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="user-details">
                                    <div class="user-name">Admin User</div>
                                    <div class="user-role">Administrator</div>
                                </div>
                            </div>

                            <button
                                id="logoutBtn"
                                class="btn-secondary"
                                type="button"
                            >
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </button>
                        </div>
                    </div>

                    <!-- Content Sections -->
                    <div class="content">
                        <!-- Dashboard Section -->
                        <div id="dashboardSection" class="section">
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-newspaper"></i>
                                    </div>
                                    <div class="stat-value" id="newsCount">
                                        12
                                    </div>
                                    <div class="stat-label">News Items</div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-calendar-alt"></i>
                                    </div>
                                    <div class="stat-value" id="eventsCount">
                                        8
                                    </div>
                                    <div class="stat-label">Events</div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-project-diagram"></i>
                                    </div>
                                    <div class="stat-value" id="projectCount">
                                        24
                                    </div>
                                    <div class="stat-label">Projects</div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-lightbulb"></i>
                                    </div>
                                    <div class="stat-value" id="insightCount">
                                        15
                                    </div>
                                    <div class="stat-label">
                                        Research Insights
                                    </div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-envelope"></i>
                                    </div>
                                    <div class="stat-value" id="contactCount">
                                        32
                                    </div>
                                    <div class="stat-label">
                                        Contact Submissions
                                    </div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-graduation-cap"></i>
                                    </div>
                                    <div class="stat-value" id="workshopCount">
                                        6
                                    </div>
                                    <div class="stat-label">Workshops</div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-book"></i>
                                    </div>
                                    <div class="stat-value" id="tutorialCount">
                                        18
                                    </div>
                                    <div class="stat-label">Tutorials</div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-university"></i>
                                    </div>
                                    <div
                                        class="stat-value"
                                        id="colleaguesContactCount"
                                    >
                                        9
                                    </div>
                                    <div class="stat-label">
                                        Colleagues Contacts
                                    </div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-pencil-ruler"></i>
                                    </div>
                                    <div
                                        class="stat-value"
                                        id="designProjectsCount"
                                    >
                                        27
                                    </div>
                                    <div class="stat-label">
                                        Design Projects
                                    </div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-chart-bar"></i>
                                    </div>
                                    <div
                                        class="stat-value"
                                        id="researchArticlesCount"
                                    >
                                        14
                                    </div>
                                    <div class="stat-label">
                                        Research Articles
                                    </div>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">Recent Activity</h3>
                                </div>
                                <div id="recentItems" class="items-grid">
                                    <!-- Recent items will be loaded here -->
                                </div>
                            </div>
                        </div>

                        <!-- Contact Management Section -->
                        <div id="contactSection" class="section hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        Contact Form Submissions
                                    </h3>
                                    <div class="button-group">
                                        <button
                                            id="refreshSubmissions"
                                            class="btn-secondary"
                                            type="button"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh
                                        </button>
                                    </div>
                                </div>

                                <div class="stats-row">
                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="totalSubmissions"
                                        >
                                            12
                                        </div>
                                        <div class="stat-mini-label">
                                            Total Submissions
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="newSubmissions"
                                        >
                                            3
                                        </div>
                                        <div class="stat-mini-label">New</div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="repliedSubmissions"
                                        >
                                            7
                                        </div>
                                        <div class="stat-mini-label">
                                            Replied
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="recentSubmissions"
                                        >
                                            5
                                        </div>
                                        <div class="stat-mini-label">
                                            Last 7 Days
                                        </div>
                                    </div>
                                </div>

                                <div id="submissionsList">
                                    <!-- Submissions will be loaded here -->
                                </div>
                            </div>
                        </div>

                        <!-- Get Involved Management Section -->
                        <div id="getinvolvedSection" class="section hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        Get Involved Management
                                    </h3>
                                    <div class="button-group">
                                        <button
                                            id="refreshGetInvolved"
                                            class="btn-secondary"
                                            type="button"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh All
                                        </button>
                                    </div>
                                </div>

                                <div class="get-involved-tabs">
                                    <button
                                        class="get-involved-tab active"
                                        data-tab="membership"
                                        type="button"
                                    >
                                        <i class="fas fa-users"></i> Membership
                                        Applications
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="donations"
                                        type="button"
                                    >
                                        <i class="fas fa-donate"></i> Donations
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="feedback"
                                        type="button"
                                    >
                                        <i class="fas fa-comment"></i> Feedback
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="ideas"
                                        type="button"
                                    >
                                        <i class="fas fa-lightbulb"></i> Ideas
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="partnerships"
                                        type="button"
                                    >
                                        <i class="fas fa-handshake"></i>
                                        Partnerships
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="stories"
                                        type="button"
                                    >
                                        <i class="fas fa-book"></i> Community
                                        Stories
                                    </button>
                                </div>

                                <!-- Membership Applications -->
                                <div
                                    id="membershipTab"
                                    class="get-involved-content active"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Membership Applications
                                        </h4>
                                        <button
                                            class="btn-secondary"
                                            type="button"
                                            onclick="loadMembershipApplications()"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh
                                        </button>
                                    </div>
                                    <div id="membershipList" class="items-grid">
                                        <!-- Membership applications will be loaded here -->
                                    </div>
                                </div>

                                <!-- Donations -->
                                <div
                                    id="donationsTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">Donations</h4>
                                        <button
                                            class="btn-secondary"
                                            type="button"
                                            onclick="loadDonations()"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh
                                        </button>
                                    </div>
                                    <div id="donationsList" class="items-grid">
                                        <!-- Donations will be loaded here -->
                                    </div>
                                </div>

                                <!-- Feedback -->
                                <div
                                    id="feedbackTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Feedback Submissions
                                        </h4>
                                        <button
                                            class="btn-secondary"
                                            type="button"
                                            onclick="loadFeedback()"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh
                                        </button>
                                    </div>
                                    <div id="feedbackList" class="items-grid">
                                        <!-- Feedback will be loaded here -->
                                    </div>
                                </div>

                                <!-- Ideas -->
                                <div id="ideasTab" class="get-involved-content">
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Idea Submissions
                                        </h4>
                                        <button
                                            class="btn-secondary"
                                            type="button"
                                            onclick="loadIdeas()"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh
                                        </button>
                                    </div>
                                    <div id="ideasList" class="items-grid">
                                        <!-- Ideas will be loaded here -->
                                    </div>
                                </div>

                                <!-- Partnerships -->
                                <div
                                    id="partnershipsTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Partnership Inquiries
                                        </h4>
                                        <button
                                            class="btn-secondary"
                                            type="button"
                                            onclick="loadPartnerships()"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh
                                        </button>
                                    </div>
                                    <div
                                        id="partnershipsList"
                                        class="items-grid"
                                    >
                                        <!-- Partnerships will be loaded here -->
                                    </div>
                                </div>

                                <!-- Community Stories -->
                                <div
                                    id="storiesTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Community Stories
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadStories()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddStoryModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Story
                                            </button>
                                        </div>
                                    </div>
                                    <div id="storiesList" class="items-grid">
                                        <!-- Stories will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Media Library Section -->
                        <div id="mediaSection" class="section hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        Media Library Management
                                    </h3>
                                    <div class="button-group">
                                        <button
                                            id="refreshMedia"
                                            class="btn-secondary"
                                            type="button"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh All
                                        </button>
                                    </div>
                                </div>

                                <!-- Media Stats -->
                                <div class="stats-row">
                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="photosCount"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Photos
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="videosCount"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Videos
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="designsCount"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Designs
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="testimonialsCount"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Testimonials
                                        </div>
                                    </div>
                                </div>

                                <!-- Media Tabs -->
                                <div class="get-involved-tabs">
                                    <button
                                        class="get-involved-tab active"
                                        data-tab="photos"
                                        type="button"
                                    >
                                        <i class="fas fa-camera"></i> Photos
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="videos"
                                        type="button"
                                    >
                                        <i class="fas fa-video"></i> Videos
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="designs"
                                        type="button"
                                    >
                                        <i class="fas fa-paint-brush"></i>
                                        Designs
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="testimonials"
                                        type="button"
                                    >
                                        <i class="fas fa-quote-left"></i>
                                        Testimonials
                                    </button>
                                </div>

                                <!-- Photos Tab -->
                                <div
                                    id="photosTab"
                                    class="get-involved-content active"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Photo Albums Management
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadPhotos()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddPhotoModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Photo
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Photo Categories - Inline Filter Buttons -->
                                    <div class="media-filter-buttons">
                                        <button
                                            class="filter-btn active"
                                            data-category="All"
                                            type="button"
                                        >
                                            All
                                        </button>
                                        <button
                                            class="filter-btn"
                                            data-category="Architecture"
                                            type="button"
                                        >
                                            Architecture
                                        </button>
                                        <button
                                            class="filter-btn"
                                            data-category="Nature"
                                            type="button"
                                        >
                                            Nature
                                        </button>
                                        <button
                                            class="filter-btn"
                                            data-category="Residential"
                                            type="button"
                                        >
                                            Residential
                                        </button>
                                        <button
                                            class="filter-btn"
                                            data-category="Public"
                                            type="button"
                                        >
                                            Public
                                        </button>
                                        <button
                                            class="filter-btn"
                                            data-category="Commercial"
                                            type="button"
                                        >
                                            Commercial
                                        </button>
                                        <button
                                            class="filter-btn"
                                            data-category="Cultural"
                                            type="button"
                                        >
                                            Cultural
                                        </button>
                                    </div>

                                    <div id="photosList" class="items-grid">
                                        <!-- Photos will be loaded here -->
                                    </div>
                                </div>

                                <!-- Videos Tab -->
                                <div
                                    id="videosTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Video Stories Management
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadVideos()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddVideoModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Video
                                            </button>
                                        </div>
                                    </div>

                                    <div id="videosList" class="items-grid">
                                        <!-- Videos will be loaded here -->
                                    </div>
                                </div>

                                <!-- Designs Tab -->
                                <div
                                    id="designsTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Design Visualizations Management
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadDesigns()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddDesignModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Design
                                            </button>
                                        </div>
                                    </div>

                                    <div id="designsList" class="items-grid">
                                        <!-- Designs will be loaded here -->
                                    </div>
                                </div>

                                <!-- Testimonials Tab -->
                                <div
                                    id="testimonialsTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Community Testimonials Management
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadTestimonials()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddTestimonialModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Testimonial
                                            </button>
                                        </div>
                                    </div>

                                    <div
                                        id="testimonialsList"
                                        class="items-grid"
                                    >
                                        <!-- Testimonials will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Education Management Section -->
                        <div id="educationSection" class="section hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        Education Management
                                    </h3>
                                    <div class="button-group">
                                        <button
                                            id="refreshEducation"
                                            class="btn-secondary"
                                            type="button"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh All
                                        </button>
                                    </div>
                                </div>

                                <!-- Education Stats -->
                                <div class="stats-row">
                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="workshopsCount"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Workshops
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="tutorialsCount"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Tutorials
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="exhibitionsCount"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Exhibitions
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="totalEnrolled"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Total Enrolled
                                        </div>
                                    </div>
                                </div>

                                <!-- Education Tabs -->
                                <div class="get-involved-tabs">
                                    <button
                                        class="get-involved-tab active"
                                        data-tab="workshops"
                                        type="button"
                                    >
                                        <i
                                            class="fas fa-chalkboard-teacher"
                                        ></i>
                                        Workshops
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="tutorials"
                                        type="button"
                                    >
                                        <i class="fas fa-book"></i> Tutorials
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="exhibitions"
                                        type="button"
                                    >
                                        <i class="fas fa-palette"></i>
                                        Exhibitions
                                    </button>
                                </div>

                                <!-- Workshops Tab -->
                                <div
                                    id="workshopsTab"
                                    class="get-involved-content active"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Workshops Management
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadWorkshops()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddWorkshopModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Workshop
                                            </button>
                                        </div>
                                    </div>

                                    <div id="workshopsList" class="items-grid">
                                        <!-- Workshops will be loaded here -->
                                    </div>
                                </div>

                                <!-- Tutorials Tab -->
                                <div
                                    id="tutorialsTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Tutorials Management
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadTutorials()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddTutorialModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Tutorial
                                            </button>
                                        </div>
                                    </div>

                                    <div id="tutorialsList" class="items-grid">
                                        <!-- Tutorials will be loaded here -->
                                    </div>
                                </div>

                                <!-- Exhibitions Tab -->
                                <div
                                    id="exhibitionsTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Exhibitions Management
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadExhibitions()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddExhibitionModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Exhibition
                                            </button>
                                        </div>
                                    </div>

                                    <div
                                        id="exhibitionsList"
                                        class="items-grid"
                                    >
                                        <!-- Exhibitions will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Design Projects Management Section -->
                        <div id="designSection" class="section hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        Design Projects Management
                                    </h3>
                                    <div class="button-group">
                                        <button
                                            id="refreshDesign"
                                            class="btn-secondary"
                                            type="button"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh All
                                        </button>
                                    </div>
                                </div>

                                <!-- Design Projects Stats -->
                                <div class="stats-row">
                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="designTotalProjects"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Total Projects
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="designAcademicProjects"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Academic Projects
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="designProfessionalProjects"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Professional Projects
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="designCompetitionProjects"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Competition Projects
                                        </div>
                                    </div>
                                </div>

                                <!-- Design Projects Tabs -->
                                <div class="get-involved-tabs">
                                    <button
                                        class="get-involved-tab active"
                                        data-tab="design-all"
                                        type="button"
                                    >
                                        <i class="fas fa-th"></i> All Projects
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="design-academic"
                                        type="button"
                                    >
                                        <i class="fas fa-graduation-cap"></i>
                                        Academic
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="design-professional"
                                        type="button"
                                    >
                                        <i class="fas fa-briefcase"></i>
                                        Professional
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="design-competition"
                                        type="button"
                                    >
                                        <i class="fas fa-trophy"></i>
                                        Competition
                                    </button>
                                </div>

                                <!-- All Projects Tab -->
                                <div
                                    id="design-allTab"
                                    class="get-involved-content active"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            All Design Projects
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadDesignProjects()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddDesignProjectModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Project
                                            </button>
                                        </div>
                                    </div>

                                    <div class="filter-section">
                                        <div class="input-group">
                                            <label for="sectorFilter"
                                                >Filter by Sector:</label
                                            >
                                            <select
                                                id="sectorFilter"
                                                onchange="filterDesignProjectsBySector()"
                                            >
                                                <option value="">
                                                    All Sectors
                                                </option>
                                                <option value="residential">
                                                    Residential Architecture
                                                </option>
                                                <option value="interior">
                                                    Interior Design
                                                </option>
                                                <option value="refurbishment">
                                                    Refurbishment
                                                </option>
                                                <option value="cultural">
                                                    Cultural Architecture
                                                </option>
                                                <option value="commercial">
                                                    Commercial & Offices
                                                </option>
                                                <option value="hospitality">
                                                    Hospitality Architecture
                                                </option>
                                                <option value="public">
                                                    Public Architecture
                                                </option>
                                                <option value="healthcare">
                                                    Healthcare Architecture
                                                </option>
                                                <option value="educational">
                                                    Educational Architecture
                                                </option>
                                                <option value="sports">
                                                    Sports Architecture
                                                </option>
                                                <option value="religious">
                                                    Religious Architecture
                                                </option>
                                                <option value="industrial">
                                                    Industrial & Infrastructure
                                                </option>
                                                <option value="landscape">
                                                    Landscape & Urbanism
                                                </option>
                                            </select>
                                        </div>
                                    </div>

                                    <div
                                        id="designProjectsList"
                                        class="items-grid"
                                    >
                                        <!-- Design projects will be loaded here -->
                                    </div>
                                </div>

                                <!-- Academic Projects Tab -->
                                <div
                                    id="design-academicTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Academic Design Projects
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadAcademicProjects()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddDesignProjectModal('academic')"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Academic Project
                                            </button>
                                        </div>
                                    </div>

                                    <div class="filter-section">
                                        <div class="input-group">
                                            <label for="academicSectorFilter"
                                                >Filter by Sector:</label
                                            >
                                            <select
                                                id="academicSectorFilter"
                                                onchange="filterAcademicProjectsBySector()"
                                            >
                                                <option value="">
                                                    All Sectors
                                                </option>
                                                <option value="residential">
                                                    Residential Architecture
                                                </option>
                                                <option value="interior">
                                                    Interior Design
                                                </option>
                                                <option value="refurbishment">
                                                    Refurbishment
                                                </option>
                                                <option value="cultural">
                                                    Cultural Architecture
                                                </option>
                                                <option value="commercial">
                                                    Commercial & Offices
                                                </option>
                                                <option value="hospitality">
                                                    Hospitality Architecture
                                                </option>
                                                <option value="public">
                                                    Public Architecture
                                                </option>
                                                <option value="healthcare">
                                                    Healthcare Architecture
                                                </option>
                                                <option value="educational">
                                                    Educational Architecture
                                                </option>
                                                <option value="sports">
                                                    Sports Architecture
                                                </option>
                                                <option value="religious">
                                                    Religious Architecture
                                                </option>
                                                <option value="industrial">
                                                    Industrial & Infrastructure
                                                </option>
                                                <option value="landscape">
                                                    Landscape & Urbanism
                                                </option>
                                            </select>
                                        </div>
                                    </div>

                                    <div
                                        id="academicProjectsList"
                                        class="items-grid"
                                    >
                                        <!-- Academic projects will be loaded here -->
                                    </div>
                                </div>

                                <!-- Professional Projects Tab -->
                                <div
                                    id="design-professionalTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Professional Design Projects
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadProfessionalProjects()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddDesignProjectModal('professional')"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Professional Project
                                            </button>
                                        </div>
                                    </div>

                                    <div class="filter-section">
                                        <div class="input-group">
                                            <label
                                                for="professionalSectorFilter"
                                                >Filter by Sector:</label
                                            >
                                            <select
                                                id="professionalSectorFilter"
                                                onchange="filterProfessionalProjectsBySector()"
                                            >
                                                <option value="">
                                                    All Sectors
                                                </option>
                                                <option value="residential">
                                                    Residential Architecture
                                                </option>
                                                <option value="interior">
                                                    Interior Design
                                                </option>
                                                <option value="refurbishment">
                                                    Refurbishment
                                                </option>
                                                <option value="cultural">
                                                    Cultural Architecture
                                                </option>
                                                <option value="commercial">
                                                    Commercial & Offices
                                                </option>
                                                <option value="hospitality">
                                                    Hospitality Architecture
                                                </option>
                                                <option value="public">
                                                    Public Architecture
                                                </option>
                                                <option value="healthcare">
                                                    Healthcare Architecture
                                                </option>
                                                <option value="educational">
                                                    Educational Architecture
                                                </option>
                                                <option value="sports">
                                                    Sports Architecture
                                                </option>
                                                <option value="religious">
                                                    Religious Architecture
                                                </option>
                                                <option value="industrial">
                                                    Industrial & Infrastructure
                                                </option>
                                                <option value="landscape">
                                                    Landscape & Urbanism
                                                </option>
                                            </select>
                                        </div>
                                    </div>

                                    <div
                                        id="professionalProjectsList"
                                        class="items-grid"
                                    >
                                        <!-- Professional projects will be loaded here -->
                                    </div>
                                </div>

                                <!-- Competition Projects Tab -->
                                <div
                                    id="design-competitionTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Competition Design Projects
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadCompetitionProjects()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddDesignProjectModal('competition')"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Competition Project
                                            </button>
                                        </div>
                                    </div>

                                    <div class="filter-section">
                                        <div class="input-group">
                                            <label for="competitionSectorFilter"
                                                >Filter by Sector:</label
                                            >
                                            <select
                                                id="competitionSectorFilter"
                                                onchange="filterCompetitionProjectsBySector()"
                                            >
                                                <option value="">
                                                    All Sectors
                                                </option>
                                                <option value="residential">
                                                    Residential Architecture
                                                </option>
                                                <option value="interior">
                                                    Interior Design
                                                </option>
                                                <option value="refurbishment">
                                                    Refurbishment
                                                </option>
                                                <option value="cultural">
                                                    Cultural Architecture
                                                </option>
                                                <option value="commercial">
                                                    Commercial & Offices
                                                </option>
                                                <option value="hospitality">
                                                    Hospitality Architecture
                                                </option>
                                                <option value="public">
                                                    Public Architecture
                                                </option>
                                                <option value="healthcare">
                                                    Healthcare Architecture
                                                </option>
                                                <option value="educational">
                                                    Educational Architecture
                                                </option>
                                                <option value="sports">
                                                    Sports Architecture
                                                </option>
                                                <option value="religious">
                                                    Religious Architecture
                                                </option>
                                                <option value="industrial">
                                                    Industrial & Infrastructure
                                                </option>
                                                <option value="landscape">
                                                    Landscape & Urbanism
                                                </option>
                                            </select>
                                        </div>
                                    </div>

                                    <div
                                        id="competitionProjectsList"
                                        class="items-grid"
                                    >
                                        <!-- Competition projects will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- News & Events Management Section -->
                        <div id="newseventsSection" class="section hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        News & Events Management
                                    </h3>
                                    <div class="button-group">
                                        <button
                                            id="refreshNewsEvents"
                                            class="btn-secondary"
                                            type="button"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh All
                                        </button>
                                    </div>
                                </div>

                                <!-- News & Events Stats -->
                                <div class="stats-row">
                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="newsTotal"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Total News
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="eventsTotal"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Total Events
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="newsFeatured"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Featured News
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="eventsFeatured"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Featured Events
                                        </div>
                                    </div>
                                </div>

                                <!-- News & Events Tabs -->
                                <div class="get-involved-tabs">
                                    <button
                                        class="get-involved-tab active"
                                        data-tab="newsevents-all"
                                        type="button"
                                    >
                                        <i class="fas fa-th"></i> All
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="newsevents-news"
                                        type="button"
                                    >
                                        <i class="fas fa-newspaper"></i> News
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="newsevents-events"
                                        type="button"
                                    >
                                        <i class="fas fa-calendar-alt"></i>
                                        Events
                                    </button>
                                </div>

                                <!-- All News & Events Tab -->
                                <div
                                    id="newsevents-allTab"
                                    class="get-involved-content active"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            All News & Events
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadAllNewsEvents()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddNewsModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                News
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddEventModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Event
                                            </button>
                                        </div>
                                    </div>
                                    <div
                                        id="allNewsEventsList"
                                        class="items-grid"
                                    >
                                        <!-- All news and events will be loaded here -->
                                    </div>
                                </div>

                                <!-- News Tab -->
                                <div
                                    id="newsevents-newsTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            News Articles
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadNewsArticles()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddNewsModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                News
                                            </button>
                                        </div>
                                    </div>
                                    <div
                                        id="newsArticlesList"
                                        class="items-grid"
                                    >
                                        <!-- News articles will be loaded here -->
                                    </div>
                                </div>

                                <!-- Events Tab -->
                                <div
                                    id="newsevents-eventsTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">Events</h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadEvents()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddEventModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Event
                                            </button>
                                        </div>
                                    </div>
                                    <div id="eventsList" class="items-grid">
                                        <!-- Events will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Research Insights Management Section -->
                        <div id="researchSection" class="section hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        Research Insights Management
                                    </h3>
                                    <div class="button-group">
                                        <button
                                            id="refreshResearch"
                                            class="btn-secondary"
                                            type="button"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh All
                                        </button>
                                    </div>
                                </div>

                                <!-- Research Insights Stats -->
                                <div class="stats-row">
                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="researchTotalArticles"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Total Articles
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="researchSustainable"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Sustainable Design
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="researchClimate"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Climate Resilience
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="researchSocial"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Social Impact
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="researchFeatured"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Featured
                                        </div>
                                    </div>
                                </div>

                                <!-- Research Tabs -->
                                <div class="get-involved-tabs">
                                    <button
                                        class="get-involved-tab active"
                                        data-tab="research-all"
                                        type="button"
                                    >
                                        <i class="fas fa-th"></i> All Articles
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="research-sustainable"
                                        type="button"
                                    >
                                        <i class="fas fa-leaf"></i> Sustainable
                                        Design
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="research-climate"
                                        type="button"
                                    >
                                        <i class="fas fa-cloud-sun"></i> Climate
                                        Resilience
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="research-social"
                                        type="button"
                                    >
                                        <i class="fas fa-users"></i> Social
                                        Impact
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="research-technological"
                                        type="button"
                                    >
                                        <i class="fas fa-microchip"></i>
                                        Technological Innovation
                                    </button>
                                </div>

                                <!-- All Articles Tab -->
                                <div
                                    id="research-allTab"
                                    class="get-involved-content active"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            All Research Articles
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadResearchArticles()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddResearchModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Article
                                            </button>
                                        </div>
                                    </div>
                                    <div
                                        id="researchArticlesList"
                                        class="items-grid"
                                    >
                                        <!-- Research articles will be loaded here -->
                                    </div>
                                </div>

                                <!-- Sustainable Design Tab -->
                                <div
                                    id="research-sustainableTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Sustainable Design Research
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadSustainableResearch()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddResearchModal('sustainable')"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Sustainable Article
                                            </button>
                                        </div>
                                    </div>
                                    <div
                                        id="sustainableResearchList"
                                        class="items-grid"
                                    >
                                        <!-- Sustainable research articles will be loaded here -->
                                    </div>
                                </div>

                                <!-- Climate Resilience Tab -->
                                <div
                                    id="research-climateTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Climate Resilience Research
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadClimateResearch()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddResearchModal('climate')"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Climate Article
                                            </button>
                                        </div>
                                    </div>
                                    <div
                                        id="climateResearchList"
                                        class="items-grid"
                                    >
                                        <!-- Climate research articles will be loaded here -->
                                    </div>
                                </div>

                                <!-- Social Impact Tab -->
                                <div
                                    id="research-socialTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Social Impact Research
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadSocialResearch()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddResearchModal('social')"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Social Article
                                            </button>
                                        </div>
                                    </div>
                                    <div
                                        id="socialResearchList"
                                        class="items-grid"
                                    >
                                        <!-- Social research articles will be loaded here -->
                                    </div>
                                </div>

                                <!-- Technological Innovation Tab -->
                                <div
                                    id="research-technologicalTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Technological Innovation Research
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadTechnologicalResearch()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddResearchModal('technological')"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Tech Article
                                            </button>
                                        </div>
                                    </div>
                                    <div
                                        id="technologicalResearchList"
                                        class="items-grid"
                                    >
                                        <!-- Technological research articles will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Architecture Colleagues Lab Management Section -->
                        <div id="colleaguesSection" class="section hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        Architecture Colleagues Lab Management
                                    </h3>
                                    <div class="button-group">
                                        <button
                                            id="refreshColleagues"
                                            class="btn-secondary"
                                            type="button"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh All
                                        </button>
                                    </div>
                                </div>

                                <!-- Colleagues Stats -->
                                <div class="stats-row">
                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="colleaguesTotalContacts"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Total Contacts
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="colleaguesTeamMembers"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Team Members
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="colleaguesInitiatives"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            Initiatives
                                        </div>
                                    </div>

                                    <div class="stat-mini-card">
                                        <div
                                            class="stat-mini-value"
                                            id="colleaguesNewContacts"
                                        >
                                            0
                                        </div>
                                        <div class="stat-mini-label">
                                            New Contacts
                                        </div>
                                    </div>
                                </div>

                                <!-- Colleagues Tabs -->
                                <div class="get-involved-tabs">
                                    <button
                                        class="get-involved-tab active"
                                        data-tab="colleagues-contacts"
                                        type="button"
                                    >
                                        <i class="fas fa-envelope"></i> Contact
                                        Submissions
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="colleagues-team"
                                        type="button"
                                    >
                                        <i class="fas fa-users"></i> Team
                                        Members
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="colleagues-initiatives"
                                        type="button"
                                    >
                                        <i class="fas fa-rocket"></i>
                                        Initiatives
                                    </button>
                                    <button
                                        class="get-involved-tab"
                                        data-tab="colleagues-mission"
                                        type="button"
                                    >
                                        <i class="fas fa-bullseye"></i> Mission
                                        & Values
                                    </button>
                                </div>

                                <!-- Contacts Tab -->
                                <div
                                    id="colleagues-contactsTab"
                                    class="get-involved-content active"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Contact Form Submissions
                                        </h4>
                                        <button
                                            class="btn-secondary"
                                            type="button"
                                            onclick="loadColleaguesContacts()"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh
                                        </button>
                                    </div>
                                    <div
                                        id="colleaguesContactsList"
                                        class="items-grid"
                                    >
                                        <!-- Contact submissions will be loaded here -->
                                    </div>
                                </div>

                                <!-- Team Tab -->
                                <div
                                    id="colleagues-teamTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Team Members Management
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadTeamMembers()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddTeamMemberModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Team Member
                                            </button>
                                        </div>
                                    </div>
                                    <div
                                        id="colleaguesTeamList"
                                        class="items-grid"
                                    >
                                        <!-- Team members will be loaded here -->
                                    </div>
                                </div>

                                <!-- Initiatives Tab -->
                                <div
                                    id="colleagues-initiativesTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Initiatives Management
                                        </h4>
                                        <div class="button-group">
                                            <button
                                                class="btn-secondary"
                                                type="button"
                                                onclick="loadColleaguesInitiatives()"
                                            >
                                                <i class="fas fa-sync-alt"></i>
                                                Refresh
                                            </button>
                                            <button
                                                class="btn-primary"
                                                type="button"
                                                onclick="showAddInitiativeModal()"
                                            >
                                                <i class="fas fa-plus"></i> Add
                                                Initiative
                                            </button>
                                        </div>
                                    </div>
                                    <div
                                        id="colleaguesInitiativesList"
                                        class="items-grid"
                                    >
                                        <!-- Initiatives will be loaded here -->
                                    </div>
                                </div>

                                <!-- Mission & Values Tab -->
                                <div
                                    id="colleagues-missionTab"
                                    class="get-involved-content"
                                >
                                    <div class="card-header">
                                        <h4 class="card-title">
                                            Mission & Values Management
                                        </h4>
                                        <button
                                            class="btn-secondary"
                                            type="button"
                                            onclick="loadColleaguesMission()"
                                        >
                                            <i class="fas fa-sync-alt"></i>
                                            Refresh
                                        </button>
                                    </div>
                                    <div id="colleaguesMissionContent">
                                        <!-- Mission and values will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Settings Section -->
                        <div id="settingsSection" class="section hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title">Settings</h3>
                                    <p
                                        style="
                                            color: var(--text-muted);
                                            font-size: 0.9rem;
                                            margin: 0.5rem 0 0 0;
                                        "
                                    >
                                        Configure your admin dashboard
                                        preferences
                                    </p>
                                </div>

                                <div
                                    style="
                                        display: grid;
                                        gap: 2rem;
                                        margin-top: 2rem;
                                    "
                                >
                                    <!-- Account Settings -->
                                    <div class="settings-group">
                                        <h4
                                            style="
                                                color: var(--accent-light);
                                                margin-bottom: 1rem;
                                                font-weight: 300;
                                            "
                                        >
                                            <i class="fas fa-user"></i> Account
                                            Information
                                        </h4>
                                        <div class="form-grid">
                                            <div class="input-group">
                                                <label>Username</label>
                                                <input
                                                    type="text"
                                                    id="settingsUsername"
                                                    placeholder="Admin"
                                                    readonly
                                                    style="
                                                        background: rgba(
                                                            255,
                                                            255,
                                                            255,
                                                            0.05
                                                        );
                                                    "
                                                />
                                            </div>
                                            <div class="input-group">
                                                <label>Email</label>
                                                <input
                                                    type="email"
                                                    id="settingsEmail"
                                                    placeholder="admin@aspire.com"
                                                    readonly
                                                    style="
                                                        background: rgba(
                                                            255,
                                                            255,
                                                            255,
                                                            0.05
                                                        );
                                                    "
                                                />
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Dashboard Preferences -->
                                    <div class="settings-group">
                                        <h4
                                            style="
                                                color: var(--accent-light);
                                                margin-bottom: 1rem;
                                                font-weight: 300;
                                            "
                                        >
                                            <i class="fas fa-cog"></i> Dashboard
                                            Preferences
                                        </h4>
                                        <div class="form-grid">
                                            <div class="input-group">
                                                <label class="toggle-switch">
                                                    <input
                                                        type="checkbox"
                                                        id="settingsAutoRefresh"
                                                        checked
                                                    />
                                                    <span
                                                        class="toggle-slider"
                                                    ></span>
                                                    <span
                                                        >Auto-refresh data every
                                                        5 minutes</span
                                                    >
                                                </label>
                                            </div>
                                            <div class="input-group">
                                                <label class="toggle-switch">
                                                    <input
                                                        type="checkbox"
                                                        id="settingsShowDrafts"
                                                        checked
                                                    />
                                                    <span
                                                        class="toggle-slider"
                                                    ></span>
                                                    <span
                                                        >Show draft items by
                                                        default</span
                                                    >
                                                </label>
                                            </div>
                                            <div class="input-group">
                                                <label class="toggle-switch">
                                                    <input
                                                        type="checkbox"
                                                        id="settingsCompactView"
                                                    />
                                                    <span
                                                        class="toggle-slider"
                                                    ></span>
                                                    <span
                                                        >Use compact view for
                                                        lists</span
                                                    >
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Notification Settings -->
                                    <div class="settings-group">
                                        <h4
                                            style="
                                                color: var(--accent-light);
                                                margin-bottom: 1rem;
                                                font-weight: 300;
                                            "
                                        >
                                            <i class="fas fa-bell"></i>
                                            Notifications
                                        </h4>
                                        <div class="form-grid">
                                            <div class="input-group">
                                                <label class="toggle-switch">
                                                    <input
                                                        type="checkbox"
                                                        id="settingsNotifyNewSubmissions"
                                                        checked
                                                    />
                                                    <span
                                                        class="toggle-slider"
                                                    ></span>
                                                    <span
                                                        >New form
                                                        submissions</span
                                                    >
                                                </label>
                                            </div>
                                            <div class="input-group">
                                                <label class="toggle-switch">
                                                    <input
                                                        type="checkbox"
                                                        id="settingsNotifyNewComments"
                                                        checked
                                                    />
                                                    <span
                                                        class="toggle-slider"
                                                    ></span>
                                                    <span
                                                        >New comments and
                                                        feedback</span
                                                    >
                                                </label>
                                            </div>
                                            <div class="input-group">
                                                <label class="toggle-switch">
                                                    <input
                                                        type="checkbox"
                                                        id="settingsNotifySystemAlerts"
                                                        checked
                                                    />
                                                    <span
                                                        class="toggle-slider"
                                                    ></span>
                                                    <span
                                                        >System alerts and
                                                        updates</span
                                                    >
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- System Information -->
                                    <div class="settings-group">
                                        <h4
                                            style="
                                                color: var(--accent-light);
                                                margin-bottom: 1rem;
                                                font-weight: 300;
                                            "
                                        >
                                            <i class="fas fa-info-circle"></i>
                                            System Information
                                        </h4>
                                        <div
                                            style="
                                                background: rgba(
                                                    255,
                                                    255,
                                                    255,
                                                    0.02
                                                );
                                                padding: 1.5rem;
                                                border-radius: 8px;
                                                border: 1px solid
                                                    var(--border-light);
                                            "
                                        >
                                            <div
                                                style="
                                                    display: grid;
                                                    grid-template-columns: repeat(
                                                        auto-fit,
                                                        minmax(200px, 1fr)
                                                    );
                                                    gap: 1.5rem;
                                                    font-size: 0.9rem;
                                                "
                                            >
                                                <div style="text-align: center">
                                                    <div
                                                        style="
                                                            color: var(
                                                                --text-muted
                                                            );
                                                            font-size: 0.8rem;
                                                            margin-bottom: 0.5rem;
                                                        "
                                                    >
                                                        Version
                                                    </div>
                                                    <div
                                                        style="
                                                            color: var(
                                                                --text-primary
                                                            );
                                                            font-weight: 500;
                                                        "
                                                    >
                                                        1.0.0
                                                    </div>
                                                </div>
                                                <div style="text-align: center">
                                                    <div
                                                        style="
                                                            color: var(
                                                                --text-muted
                                                            );
                                                            font-size: 0.8rem;
                                                            margin-bottom: 0.5rem;
                                                        "
                                                    >
                                                        Last Updated
                                                    </div>
                                                    <div
                                                        style="
                                                            color: var(
                                                                --text-primary
                                                            );
                                                            font-weight: 500;
                                                        "
                                                    >
                                                        Nov 3, 2025
                                                    </div>
                                                </div>
                                                <div style="text-align: center">
                                                    <div
                                                        style="
                                                            color: var(
                                                                --text-muted
                                                            );
                                                            font-size: 0.8rem;
                                                            margin-bottom: 0.5rem;
                                                        "
                                                    >
                                                        Server Status
                                                    </div>
                                                    <div
                                                        style="
                                                            color: var(
                                                                --success
                                                            );
                                                            font-weight: 500;
                                                        "
                                                    >
                                                        <i
                                                            class="fas fa-circle"
                                                            style="
                                                                font-size: 0.6rem;
                                                            "
                                                        ></i>
                                                        Online
                                                    </div>
                                                </div>
                                                <div style="text-align: center">
                                                    <div
                                                        style="
                                                            color: var(
                                                                --text-muted
                                                            );
                                                            font-size: 0.8rem;
                                                            margin-bottom: 0.5rem;
                                                        "
                                                    >
                                                        Database
                                                    </div>
                                                    <div
                                                        style="
                                                            color: var(
                                                                --success
                                                            );
                                                            font-weight: 500;
                                                        "
                                                    >
                                                        <i
                                                            class="fas fa-circle"
                                                            style="
                                                                font-size: 0.6rem;
                                                            "
                                                        ></i>
                                                        Connected
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Action Buttons -->
                                    <div class="button-group">
                                        <button
                                            class="btn-primary"
                                            onclick="saveSettings()"
                                        >
                                            <i class="fas fa-save"></i> Save
                                            Settings
                                        </button>
                                        <button
                                            class="btn-secondary"
                                            onclick="resetSettings()"
                                        >
                                            <i class="fas fa-undo"></i> Reset to
                                            Defaults
                                        </button>
                                        <button
                                            class="btn-danger"
                                            onclick="clearCache()"
                                        >
                                            <i class="fas fa-trash"></i> Clear
                                            Cache
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile Overlay -->
        <div class="overlay" id="overlay"></div>

        <!-- ===== ADD MODALS SECTION ===== -->

        <!-- Add News Modal -->
        <div id="addNewsModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add News Article</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddNewsModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addNewsForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addNewsTitle">Title *</label>
                            <input id="addNewsTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="addNewsExcerpt">Excerpt *</label>
                            <textarea id="addNewsExcerpt" required></textarea>
                        </div>

                        <div class="input-group full-width">
                            <label for="addNewsContent">Content *</label>
                            <textarea id="addNewsContent" required></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addNewsCategory">Category</label>
                            <input
                                id="addNewsCategory"
                                type="text"
                                placeholder="e.g., Announcement, Award"
                            />
                        </div>

                        <div class="input-group">
                            <label for="addNewsAuthor">Author *</label>
                            <input id="addNewsAuthor" type="text" required />
                        </div>

                        <div class="input-group">
                            <label for="addNewsDate">Date *</label>
                            <input id="addNewsDate" type="date" required />
                        </div>

                        <div class="input-group">
                            <label for="addNewsReadTime">Read Time</label>
                            <input
                                id="addNewsReadTime"
                                type="text"
                                placeholder="e.g., 3 min read"
                            />
                        </div>

                        <!-- News Image Upload -->
                        <div class="input-group full-width">
                            <label for="addNewsImage">News Image</label>
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('addNewsImageInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h4>Upload News Image</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Recommended: 1200x800px, max 20MB
                                </p>
                                <input
                                    type="file"
                                    id="addNewsImageInput"
                                    class="file-input"
                                    accept="image/*"
                                />
                            </div>
                            <div
                                id="addNewsImagePreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="addNewsFeatured" />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addNewsPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add News
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddNewsModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Event Modal -->
        <div id="addEventModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Event</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddEventModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addEventForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addEventTitle">Title *</label>
                            <input id="addEventTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="addEventDescription"
                                >Description *</label
                            >
                            <textarea
                                id="addEventDescription"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group full-width">
                            <label for="addEventExcerpt">Excerpt *</label>
                            <textarea id="addEventExcerpt" required></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addEventDate">Event Date *</label>
                            <input id="addEventDate" type="date" required />
                        </div>

                        <div class="input-group">
                            <label for="addEventTime">Event Time *</label>
                            <input
                                id="addEventTime"
                                type="text"
                                placeholder="e.g., 2:00 PM - 5:00 PM"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="addEventLocation">Location *</label>
                            <input id="addEventLocation" type="text" required />
                        </div>

                        <div class="input-group">
                            <label for="addEventCategory">Category</label>
                            <input
                                id="addEventCategory"
                                type="text"
                                placeholder="e.g., Workshop, Conference"
                            />
                        </div>

                        <div class="input-group">
                            <label for="addEventAuthor">Author *</label>
                            <input id="addEventAuthor" type="text" required />
                        </div>

                        <div class="input-group">
                            <label for="addEventReadTime">Read Time</label>
                            <input
                                id="addEventReadTime"
                                type="text"
                                placeholder="e.g., 2 min read"
                            />
                        </div>

                        <!-- Event Image Upload -->
                        <div class="input-group full-width">
                            <label for="addEventImage">Event Image</label>
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('addEventImageInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h4>Upload Event Image</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Recommended: 1200x800px, max 20MB
                                </p>
                                <input
                                    type="file"
                                    id="addEventImageInput"
                                    class="file-input"
                                    accept="image/*"
                                />
                            </div>
                            <div
                                id="addEventImagePreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="addEventFeatured" />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addEventPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Event
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddEventModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Design Project Modal -->
        <div id="addDesignProjectModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Design Project</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddDesignProjectModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addDesignProjectForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addDesignProjectTitle">Title *</label>
                            <input
                                id="addDesignProjectTitle"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="addDesignProjectSummary"
                                >Summary *</label
                            >
                            <textarea
                                id="addDesignProjectSummary"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addDesignProjectCategory"
                                >Category *</label
                            >
                            <select id="addDesignProjectCategory" required>
                                <option value="academic">Academic</option>
                                <option value="professional">
                                    Professional
                                </option>
                                <option value="competition">Competition</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label for="addDesignProjectSector">Sector *</label>
                            <select id="addDesignProjectSector" required>
                                <option value="">Select Sector</option>
                                <option value="residential">
                                    Residential Architecture
                                </option>
                                <option value="interior">
                                    Interior Design
                                </option>
                                <option value="refurbishment">
                                    Refurbishment
                                </option>
                                <option value="cultural">
                                    Cultural Architecture
                                </option>
                                <option value="commercial">
                                    Commercial & Offices
                                </option>
                                <option value="hospitality">
                                    Hospitality Architecture
                                </option>
                                <option value="public">
                                    Public Architecture
                                </option>
                                <option value="healthcare">
                                    Healthcare Architecture
                                </option>
                                <option value="educational">
                                    Educational Architecture
                                </option>
                                <option value="sports">
                                    Sports Architecture
                                </option>
                                <option value="religious">
                                    Religious Architecture
                                </option>
                                <option value="industrial">
                                    Industrial & Infrastructure
                                </option>
                                <option value="landscape">
                                    Landscape & Urbanism
                                </option>
                            </select>
                        </div>

                        <!-- Main Image Upload -->
                        <div class="input-group full-width">
                            <label for="addDesignProjectMainImage"
                                >Main Image *</label
                            >
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('addMainImageInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h4>Upload Main Image</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Recommended: 1200x800px, max 20MB
                                </p>
                                <input
                                    type="file"
                                    id="addMainImageInput"
                                    class="file-input"
                                    accept="image/*"
                                    required
                                />
                            </div>
                            <div
                                id="addMainImagePreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <!-- Content Builder Section -->
                        <div class="input-group full-width">
                            <label>Project Content Builder</label>
                            <p
                                style="
                                    color: var(--text-muted);
                                    font-size: 0.9rem;
                                    margin-bottom: 1rem;
                                "
                            >
                                Build your project content by adding text blocks
                                and images in any order you want
                            </p>

                            <div
                                style="
                                    margin-bottom: 1rem;
                                    display: flex;
                                    gap: 0.5rem;
                                "
                            >
                                <button
                                    type="button"
                                    class="btn-secondary"
                                    onclick="addContentBlock('text')"
                                    style="flex: 1"
                                >
                                    <i class="fas fa-heading"></i> Add Text
                                    Block
                                </button>
                                <button
                                    type="button"
                                    class="btn-secondary"
                                    onclick="addContentBlock('image')"
                                    style="flex: 1"
                                >
                                    <i class="fas fa-image"></i> Add Image
                                </button>
                            </div>

                            <div
                                id="contentBlocksContainer"
                                style="
                                    border: 1px solid var(--border-light);
                                    border-radius: 8px;
                                    padding: 1rem;
                                    min-height: 100px;
                                    background: rgba(0, 0, 0, 0.2);
                                "
                            >
                                <p
                                    id="emptyContentMessage"
                                    style="
                                        color: var(--text-muted);
                                        text-align: center;
                                    "
                                >
                                    No content blocks yet. Click the buttons
                                    above to add text or images.
                                </p>
                            </div>
                        </div>

                        <div class="input-group">
                            <label for="addDesignProjectDisplayOrder"
                                >Display Order</label
                            >
                            <input
                                id="addDesignProjectDisplayOrder"
                                type="number"
                                min="0"
                                value="0"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addDesignProjectFeatured"
                                />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addDesignProjectPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Project
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddDesignProjectModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Research Article Modal -->
        <div id="addResearchModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Research Article</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddResearchModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addResearchForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addResearchTitle">Title *</label>
                            <input id="addResearchTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="addResearchAbstract">Abstract *</label>
                            <textarea
                                id="addResearchAbstract"
                                required
                                placeholder="Brief summary of the research"
                            ></textarea>
                        </div>

                        <div class="input-group full-width">
                            <label for="addResearchContent"
                                >Full Content *</label
                            >
                            <textarea
                                id="addResearchContent"
                                required
                                placeholder="Detailed research content"
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addResearchCategory">Category *</label>
                            <select id="addResearchCategory" required>
                                <option value="sustainable">
                                    Sustainable Design
                                </option>
                                <option value="climate">
                                    Climate Resilience
                                </option>
                                <option value="social">Social Impact</option>
                                <option value="technological">
                                    Technological Innovation
                                </option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label for="addResearchAuthors">Authors *</label>
                            <input
                                id="addResearchAuthors"
                                type="text"
                                required
                                placeholder="John Doe, Jane Smith"
                            />
                        </div>

                        <div class="input-group">
                            <label for="addResearchPublicationDate"
                                >Publication Date</label
                            >
                            <input
                                id="addResearchPublicationDate"
                                type="date"
                            />
                        </div>

                        <div class="input-group">
                            <label for="addResearchMainImageFile"
                                >Main Image (Upload File)</label
                            >
                            <input
                                id="addResearchMainImageFile"
                                type="file"
                                accept="image/*"
                            />
                        </div>

                        <div class="input-group">
                            <label for="addResearchMainImage"
                                >Or Main Image URL</label
                            >
                            <input
                                id="addResearchMainImage"
                                type="text"
                                placeholder="https://example.com/image.jpg"
                            />
                        </div>

                        <div class="input-group">
                            <label for="addResearchDisplayOrder"
                                >Display Order</label
                            >
                            <input
                                id="addResearchDisplayOrder"
                                type="number"
                                min="0"
                                value="0"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addResearchFeatured"
                                />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addResearchPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Article
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddResearchModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Workshop Modal -->
        <div id="addWorkshopModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Workshop</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddWorkshopModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addWorkshopForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addWorkshopTitle">Title *</label>
                            <input id="addWorkshopTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="addWorkshopDescription"
                                >Description *</label
                            >
                            <textarea
                                id="addWorkshopDescription"
                                required
                                placeholder="Workshop description..."
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addWorkshopInstructor"
                                >Instructor *</label
                            >
                            <input
                                id="addWorkshopInstructor"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="addWorkshopDate">Date *</label>
                            <input id="addWorkshopDate" type="date" required />
                        </div>

                        <div class="input-group">
                            <label for="addWorkshopTime">Time *</label>
                            <input
                                id="addWorkshopTime"
                                type="text"
                                placeholder="e.g., 2:00 PM - 4:00 PM"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="addWorkshopLocation">Location</label>
                            <input
                                id="addWorkshopLocation"
                                type="text"
                                placeholder="Online or physical location"
                            />
                        </div>

                        <div class="input-group">
                            <label for="addWorkshopCapacity">Capacity</label>
                            <input
                                id="addWorkshopCapacity"
                                type="number"
                                placeholder="Maximum participants"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addWorkshopPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Workshop
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddWorkshopModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Team Member Modal -->
        <div id="addTeamMemberModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Team Member</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddTeamMemberModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addTeamMemberForm">
                    <div class="form-grid">
                        <div class="input-group">
                            <label for="addTeamMemberName">Name *</label>
                            <input
                                id="addTeamMemberName"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="addTeamMemberRole">Role *</label>
                            <input
                                id="addTeamMemberRole"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="addTeamMemberBio">Bio *</label>
                            <textarea id="addTeamMemberBio" required></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addTeamMemberImageFile"
                                >Profile Image</label
                            >
                            <input
                                type="file"
                                id="addTeamMemberImageFile"
                                accept="image/*"
                            />
                            <small>Optional: Team member photo</small>
                        </div>

                        <div class="input-group">
                            <label for="addTeamMemberImageUrl"
                                >Or Image URL</label
                            >
                            <input id="addTeamMemberImageUrl" type="url" />
                        </div>

                        <div class="input-group">
                            <label for="addTeamMemberOrder"
                                >Display Order</label
                            >
                            <input
                                id="addTeamMemberOrder"
                                type="number"
                                min="0"
                                value="0"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addTeamMemberActive"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Active</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Team Member
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddTeamMemberModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Photo Modal -->
        <div id="addPhotoModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Photo</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddPhotoModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addPhotoForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addPhotoTitle">Title *</label>
                            <input id="addPhotoTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="addPhotoDescription">Description</label>
                            <textarea id="addPhotoDescription"></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addPhotoCategory">Category *</label>
                            <select id="addPhotoCategory" required>
                                <option value="Architecture">
                                    Architecture
                                </option>
                                <option value="Nature">Nature</option>
                                <option value="Residential">Residential</option>
                                <option value="Public">Public</option>
                                <option value="Commercial">Commercial</option>
                                <option value="Cultural">Cultural</option>
                            </select>
                        </div>

                        <!-- Gallery Selection/Creation -->
                        <div class="input-group full-width">
                            <label>Gallery *</label>
                            <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                                <button type="button" class="btn-secondary" id="useExistingGalleryBtn" onclick="toggleGalleryMode('existing')" style="flex: 1;">
                                    <i class="fas fa-folder-open"></i> Select Existing
                                </button>
                                <button type="button" class="btn-secondary" id="createNewGalleryBtn" onclick="toggleGalleryMode('new')" style="flex: 1;">
                                    <i class="fas fa-folder-plus"></i> Create New
                                </button>
                            </div>
                            
                            <!-- Existing Gallery Selection -->
                            <div id="existingGallerySection" style="display: none;">
                                <select id="addPhotoExistingGallery" style="width: 100%; padding: 0.8rem; background: rgba(255, 255, 255, 0.05); border: 1px solid var(--border-light); border-radius: 8px; color: var(--text-light);">
                                    <option value="">Loading galleries...</option>
                                </select>
                            </div>
                            
                            <!-- New Gallery Creation -->
                            <div id="newGallerySection" style="display: none;">
                                <input 
                                    type="text" 
                                    id="addPhotoNewGallery" 
                                    placeholder="Enter new gallery name (e.g., Summer 2024 Projects)"
                                    style="width: 100%; padding: 0.8rem; background: rgba(255, 255, 255, 0.05); border: 1px solid var(--border-light); border-radius: 8px; color: var(--text-light);"
                                />
                            </div>
                        </div>

                        <div class="input-group full-width">
                            <label for="addPhotoFileInput"
                                >Photo Upload *</label
                            >
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('addPhotoFileInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h4>Upload Photo</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Recommended: 1200x800px, max 20MB
                                </p>
                                <input
                                    type="file"
                                    id="addPhotoFileInput"
                                    class="file-input"
                                    accept="image/*"
                                    required
                                />
                            </div>
                            <div
                                id="addPhotoPreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="addPhotoFeatured" />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addPhotoPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Photo
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddPhotoModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Story Modal -->
        <div id="addStoryModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Community Story</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddStoryModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addStoryForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addStoryTitle">Story Title *</label>
                            <input id="addStoryTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="addStoryContent">Story Content *</label>
                            <textarea id="addStoryContent" required></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addStoryAuthorName"
                                >Author Name *</label
                            >
                            <input
                                id="addStoryAuthorName"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="addStoryAuthorTitle"
                                >Author Title</label
                            >
                            <input
                                id="addStoryAuthorTitle"
                                type="text"
                                placeholder="e.g., Community Member, Volunteer"
                            />
                        </div>

                        <div class="input-group">
                            <label for="addStoryCategory">Category</label>
                            <input
                                id="addStoryCategory"
                                type="text"
                                placeholder="e.g., Volunteer Experience, Success Story"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="addStoryFeatured" />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addStoryPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Story
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddStoryModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Testimonial Modal -->
        <div id="addTestimonialModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Testimonial</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddTestimonialModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addTestimonialForm">
                    <div class="form-grid">
                        <div class="input-group">
                            <label for="addTestimonialName">Name *</label>
                            <input
                                id="addTestimonialName"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="addTestimonialRole"
                                >Role/Position *</label
                            >
                            <input
                                id="addTestimonialRole"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="addTestimonialOrganization"
                                >Organization</label
                            >
                            <input
                                id="addTestimonialOrganization"
                                type="text"
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="addTestimonialQuote"
                                >Testimonial Quote *</label
                            >
                            <textarea
                                id="addTestimonialQuote"
                                required
                                placeholder="What they said about us..."
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addTestimonialProject"
                                >Related Project</label
                            >
                            <input id="addTestimonialProject" type="text" />
                        </div>

                        <div class="input-group">
                            <label for="addTestimonialRating"
                                >Rating (1-5)</label
                            >
                            <select id="addTestimonialRating">
                                <option value="5">5 Stars</option>
                                <option value="4">4 Stars</option>
                                <option value="3">3 Stars</option>
                                <option value="2">2 Stars</option>
                                <option value="1">1 Star</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addTestimonialFeatured"
                                />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addTestimonialPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Testimonial
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddTestimonialModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Initiative Modal -->
        <div id="addInitiativeModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Initiative</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddInitiativeModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addInitiativeForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addInitiativeTitle">Title *</label>
                            <input
                                id="addInitiativeTitle"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="addInitiativeDescription"
                                >Description *</label
                            >
                            <textarea
                                id="addInitiativeDescription"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addInitiativeStatus">Status *</label>
                            <select id="addInitiativeStatus" required>
                                <option value="planned">Planned</option>
                                <option value="in_progress">In Progress</option>
                                <option value="completed">Completed</option>
                                <option value="on_hold">On Hold</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label for="addInitiativeTargetDate"
                                >Target Date</label
                            >
                            <input id="addInitiativeTargetDate" type="date" />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addInitiativeActive"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Active</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Initiative
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddInitiativeModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Video Modal -->
        <div id="addVideoModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Video</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddVideoModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addVideoForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addVideoTitle">Title *</label>
                            <input id="addVideoTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="addVideoDescription">Description</label>
                            <textarea id="addVideoDescription"></textarea>
                        </div>

                        <div class="input-group full-width">
                            <label for="addVideoFileInput"
                                >Video Upload (Local File)</label
                            >
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('addVideoFileInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-video"></i>
                                </div>
                                <h4>Upload Video</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Supported: MP4, WebM, max 100MB
                                </p>
                                <input
                                    type="file"
                                    id="addVideoFileInput"
                                    class="file-input"
                                    accept="video/*"
                                />
                            </div>
                            <div
                                id="addVideoFilePreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label for="addVideoURL">Or Video URL</label>
                            <input
                                id="addVideoURL"
                                type="url"
                                placeholder="https://youtube.com/embed/..."
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="addVideoThumbnailInput"
                                >Thumbnail Image *</label
                            >
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('addVideoThumbnailInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-image"></i>
                                </div>
                                <h4>Upload Thumbnail</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Supported: JPG, PNG, max 20MB
                                </p>
                                <input
                                    type="file"
                                    id="addVideoThumbnailInput"
                                    class="file-input"
                                    accept="image/*"
                                />
                            </div>
                            <div
                                id="addVideoThumbnailPreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label for="addVideoCategory">Category</label>
                            <input
                                id="addVideoCategory"
                                type="text"
                                placeholder="e.g., Tutorial, Project Showcase"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="addVideoFeatured" />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addVideoPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Video
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddVideoModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Tutorial Modal -->
        <div id="addTutorialModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Tutorial</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddTutorialModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addTutorialForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addTutorialTitle">Title *</label>
                            <input id="addTutorialTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="addTutorialDescription"
                                >Description *</label
                            >
                            <textarea
                                id="addTutorialDescription"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addTutorialInstructor"
                                >Instructor *</label
                            >
                            <input
                                id="addTutorialInstructor"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="addTutorialDuration">Duration</label>
                            <input
                                id="addTutorialDuration"
                                type="text"
                                placeholder="e.g., 2 hours"
                            />
                        </div>

                        <div class="input-group">
                            <label for="addTutorialLevel">Level</label>
                            <select id="addTutorialLevel">
                                <option value="beginner">Beginner</option>
                                <option value="intermediate">
                                    Intermediate
                                </option>
                                <option value="advanced">Advanced</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addTutorialPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Tutorial
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddTutorialModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Exhibition Modal -->
        <div id="addExhibitionModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Exhibition</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddExhibitionModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addExhibitionForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addExhibitionTitle">Title *</label>
                            <input
                                id="addExhibitionTitle"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="addExhibitionDescription"
                                >Description *</label
                            >
                            <textarea
                                id="addExhibitionDescription"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addExhibitionStartDate"
                                >Start Date *</label
                            >
                            <input
                                id="addExhibitionStartDate"
                                type="date"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="addExhibitionEndDate">End Date *</label>
                            <input
                                id="addExhibitionEndDate"
                                type="date"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="addExhibitionLocation">Location</label>
                            <input id="addExhibitionLocation" type="text" />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addExhibitionPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Exhibition
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddExhibitionModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Design Modal -->
        <div id="addDesignModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Add Design</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideAddDesignModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="addDesignForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="addDesignTitle">Title *</label>
                            <input id="addDesignTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="addDesignDescription"
                                >Description</label
                            >
                            <textarea id="addDesignDescription"></textarea>
                        </div>

                        <div class="input-group">
                            <label for="addDesignCategory">Category *</label>
                            <select id="addDesignCategory" required>
                                <option value="Architecture">
                                    Architecture
                                </option>
                                <option value="Interior">
                                    Interior Design
                                </option>
                                <option value="Urban">Urban Planning</option>
                                <option value="Landscape">Landscape</option>
                            </select>
                        </div>

                        <div class="input-group full-width">
                            <label for="addDesignFileInput"
                                >Design File Upload *</label
                            >
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('addDesignFileInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h4>Upload Design File</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Supports: JPG, PNG, PDF, max 10MB
                                </p>
                                <input
                                    type="file"
                                    id="addDesignFileInput"
                                    class="file-input"
                                    accept="image/*,.pdf"
                                    required
                                />
                            </div>
                            <div
                                id="addDesignPreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="addDesignFeatured" />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="addDesignPublished"
                                    checked
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Add Design
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideAddDesignModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- ===== EDIT MODALS SECTION ===== -->

        <!-- Edit News Modal -->
        <div id="editNewsModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit News Article</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditNewsModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editNewsForm">
                    <input type="hidden" id="editNewsId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editNewsTitle">Title *</label>
                            <input id="editNewsTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="editNewsExcerpt">Excerpt *</label>
                            <textarea id="editNewsExcerpt" required></textarea>
                        </div>

                        <div class="input-group full-width">
                            <label for="editNewsContent">Content *</label>
                            <textarea id="editNewsContent" required></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editNewsCategory">Category</label>
                            <input
                                id="editNewsCategory"
                                type="text"
                                placeholder="e.g., Announcement, Award"
                            />
                        </div>

                        <div class="input-group">
                            <label for="editNewsAuthor">Author *</label>
                            <input id="editNewsAuthor" type="text" required />
                        </div>

                        <div class="input-group">
                            <label for="editNewsDate">Date *</label>
                            <input id="editNewsDate" type="date" required />
                        </div>

                        <div class="input-group">
                            <label for="editNewsReadTime">Read Time</label>
                            <input
                                id="editNewsReadTime"
                                type="text"
                                placeholder="e.g., 3 min read"
                            />
                        </div>

                        <!-- News Image Upload -->
                        <div class="input-group full-width">
                            <label for="editNewsImage">News Image</label>
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('editNewsImageInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h4>Upload News Image</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Recommended: 1200x800px, max 20MB
                                </p>
                                <input
                                    type="file"
                                    id="editNewsImageInput"
                                    class="file-input"
                                    accept="image/*"
                                />
                            </div>
                            <div
                                id="editNewsImagePreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="editNewsFeatured" />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="editNewsPublished" />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update News
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditNewsModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Event Modal -->
        <div id="editEventModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Event</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditEventModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editEventForm">
                    <input type="hidden" id="editEventId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editEventTitle">Title *</label>
                            <input id="editEventTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="editEventDescription"
                                >Description *</label
                            >
                            <textarea
                                id="editEventDescription"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group full-width">
                            <label for="editEventExcerpt">Excerpt *</label>
                            <textarea id="editEventExcerpt" required></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editEventDate">Event Date *</label>
                            <input id="editEventDate" type="date" required />
                        </div>

                        <div class="input-group">
                            <label for="editEventTime">Event Time *</label>
                            <input
                                id="editEventTime"
                                type="text"
                                placeholder="e.g., 2:00 PM - 5:00 PM"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="editEventLocation">Location *</label>
                            <input
                                id="editEventLocation"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="editEventCategory">Category</label>
                            <input
                                id="editEventCategory"
                                type="text"
                                placeholder="e.g., Workshop, Conference"
                            />
                        </div>

                        <div class="input-group">
                            <label for="editEventAuthor">Author *</label>
                            <input id="editEventAuthor" type="text" required />
                        </div>

                        <div class="input-group">
                            <label for="editEventReadTime">Read Time</label>
                            <input
                                id="editEventReadTime"
                                type="text"
                                placeholder="e.g., 2 min read"
                            />
                        </div>

                        <!-- Event Image Upload -->
                        <div class="input-group full-width">
                            <label for="editEventImage">Event Image</label>
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('editEventImageInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h4>Upload Event Image</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Recommended: 1200x800px, max 20MB
                                </p>
                                <input
                                    type="file"
                                    id="editEventImageInput"
                                    class="file-input"
                                    accept="image/*"
                                />
                            </div>
                            <div
                                id="editEventImagePreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="editEventFeatured" />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editEventPublished"
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Event
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditEventModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Contact Submission Modal -->
        <div id="editContactModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Contact Submission</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditContactModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editContactForm">
                    <input type="hidden" id="editContactId" />
                    <div class="form-grid">
                        <div class="input-group">
                            <label for="editContactName">Name *</label>
                            <input id="editContactName" type="text" required />
                        </div>

                        <div class="input-group">
                            <label for="editContactEmail">Email *</label>
                            <input
                                id="editContactEmail"
                                type="email"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="editContactMessage">Message *</label>
                            <textarea
                                id="editContactMessage"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editContactStatus">Status</label>
                            <select id="editContactStatus">
                                <option value="new">New</option>
                                <option value="read">Read</option>
                                <option value="replied">Replied</option>
                                <option value="archived">Archived</option>
                            </select>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Submission
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditContactModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Design Project Modal -->
        <div id="editDesignProjectModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Design Project</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditDesignProjectModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <!-- Current Content Preview Section -->
                <div id="editProjectPreview" style="padding: 1.5rem; background: rgba(0, 0, 0, 0.2); border-radius: 8px; margin: 0 1.5rem 1.5rem;">
                    <h4 style="color: var(--accent-light); margin-bottom: 1rem;"><i class="fas fa-eye"></i> Current Project Content</h4>
                    <div id="editProjectPreviewContent" style="color: var(--text-muted);"></div>
                </div>

                <form id="editDesignProjectForm">
                    <input type="hidden" id="editDesignProjectId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editDesignProjectTitle">Title *</label>
                            <input
                                id="editDesignProjectTitle"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="editDesignProjectSummary"
                                >Summary *</label
                            >
                            <textarea
                                id="editDesignProjectSummary"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group full-width">
                            <label for="editDesignProjectDescription"
                                >Description *</label
                            >
                            <textarea
                                id="editDesignProjectDescription"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editDesignProjectCategory"
                                >Category *</label
                            >
                            <select id="editDesignProjectCategory" required>
                                <option value="academic">Academic</option>
                                <option value="professional">
                                    Professional
                                </option>
                                <option value="competition">Competition</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label for="editDesignProjectSector"
                                >Sector *</label
                            >
                            <select id="editDesignProjectSector" required>
                                <option value="">Select Sector</option>
                                <option value="residential">
                                    Residential Architecture
                                </option>
                                <option value="interior">
                                    Interior Design
                                </option>
                                <option value="refurbishment">
                                    Refurbishment
                                </option>
                                <option value="cultural">
                                    Cultural Architecture
                                </option>
                                <option value="commercial">
                                    Commercial & Offices
                                </option>
                                <option value="hospitality">
                                    Hospitality Architecture
                                </option>
                                <option value="public">
                                    Public Architecture
                                </option>
                                <option value="healthcare">
                                    Healthcare Architecture
                                </option>
                                <option value="educational">
                                    Educational Architecture
                                </option>
                                <option value="sports">
                                    Sports Architecture
                                </option>
                                <option value="religious">
                                    Religious Architecture
                                </option>
                                <option value="industrial">
                                    Industrial & Infrastructure
                                </option>
                                <option value="landscape">
                                    Landscape & Urbanism
                                </option>
                            </select>
                        </div>

                        <!-- Main Image Upload -->
                        <div class="input-group full-width">
                            <label for="editDesignProjectMainImage"
                                >Main Image *</label
                            >
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('editMainImageInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h4>Upload Main Image</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Recommended: 1200x800px, max 20MB
                                </p>
                                <input
                                    type="file"
                                    id="editMainImageInput"
                                    class="file-input"
                                    accept="image/*"
                                />
                            </div>
                            <div
                                id="editMainImagePreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <!-- Content Builder Section -->
                        <div class="input-group full-width">
                            <label>Project Content Builder</label>
                            <p
                                style="
                                    color: var(--text-muted);
                                    font-size: 0.9rem;
                                    margin-bottom: 1rem;
                                "
                            >
                                Build your project content by adding text blocks
                                and images in any order you want
                            </p>

                            <div
                                style="
                                    margin-bottom: 1rem;
                                    display: flex;
                                    gap: 0.5rem;
                                "
                            >
                                <button
                                    type="button"
                                    class="btn-secondary"
                                    onclick="addEditContentBlock('text')"
                                    style="flex: 1"
                                >
                                    <i class="fas fa-heading"></i> Add Text
                                    Block
                                </button>
                                <button
                                    type="button"
                                    class="btn-secondary"
                                    onclick="addEditContentBlock('image')"
                                    style="flex: 1"
                                >
                                    <i class="fas fa-image"></i> Add Image
                                </button>
                            </div>

                            <div
                                id="editContentBlocksContainer"
                                style="
                                    border: 1px solid var(--border-light);
                                    border-radius: 8px;
                                    padding: 1rem;
                                    min-height: 100px;
                                    background: rgba(0, 0, 0, 0.2);
                                "
                            >
                                <p
                                    id="editEmptyContentMessage"
                                    style="
                                        color: var(--text-muted);
                                        text-align: center;
                                    "
                                >
                                    No content blocks yet. Click the buttons
                                    above to add text or images.
                                </p>
                            </div>
                        </div>

                        <div class="input-group">
                            <label for="editDesignProjectDisplayOrder"
                                >Display Order</label
                            >
                            <input
                                id="editDesignProjectDisplayOrder"
                                type="number"
                                min="0"
                                value="0"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editDesignProjectFeatured"
                                />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editDesignProjectPublished"
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Project
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditDesignProjectModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Research Article Modal -->
        <div id="editResearchModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Research Article</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditResearchModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editResearchForm">
                    <input type="hidden" id="editResearchId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editResearchTitle">Title *</label>
                            <input
                                id="editResearchTitle"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="editResearchAbstract">Abstract *</label>
                            <textarea
                                id="editResearchAbstract"
                                required
                                placeholder="Brief summary of the research"
                            ></textarea>
                        </div>

                        <div class="input-group full-width">
                            <label for="editResearchContent"
                                >Full Content *</label
                            >
                            <textarea
                                id="editResearchContent"
                                required
                                placeholder="Detailed research content"
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editResearchCategory">Category *</label>
                            <select id="editResearchCategory" required>
                                <option value="sustainable">
                                    Sustainable Design
                                </option>
                                <option value="climate">
                                    Climate Resilience
                                </option>
                                <option value="social">Social Impact</option>
                                <option value="technological">
                                    Technological Innovation
                                </option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label for="editResearchAuthors">Authors *</label>
                            <input
                                id="editResearchAuthors"
                                type="text"
                                required
                                placeholder="John Doe, Jane Smith"
                            />
                        </div>

                        <div class="input-group">
                            <label for="editResearchPublicationDate"
                                >Publication Date</label
                            >
                            <input
                                id="editResearchPublicationDate"
                                type="date"
                            />
                        </div>

                        <div class="input-group">
                            <label for="editResearchMainImage"
                                >Main Image URL</label
                            >
                            <input
                                id="editResearchMainImage"
                                type="text"
                                placeholder="/images/research/image.jpg"
                            />
                        </div>

                        <div class="input-group">
                            <label for="editResearchDisplayOrder"
                                >Display Order</label
                            >
                            <input
                                id="editResearchDisplayOrder"
                                type="number"
                                min="0"
                                value="0"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editResearchFeatured"
                                />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editResearchPublished"
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Article
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditResearchModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Workshop Modal -->
        <div id="editWorkshopModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Workshop</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditWorkshopModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editWorkshopForm">
                    <input type="hidden" id="editWorkshopId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editWorkshopTitle">Title *</label>
                            <input
                                id="editWorkshopTitle"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="editWorkshopDescription"
                                >Description *</label
                            >
                            <textarea
                                id="editWorkshopDescription"
                                required
                                placeholder="Workshop description..."
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editWorkshopInstructor"
                                >Instructor *</label
                            >
                            <input
                                id="editWorkshopInstructor"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="editWorkshopDate">Date *</label>
                            <input id="editWorkshopDate" type="date" required />
                        </div>

                        <div class="input-group">
                            <label for="editWorkshopTime">Time *</label>
                            <input
                                id="editWorkshopTime"
                                type="text"
                                placeholder="e.g., 2:00 PM - 4:00 PM"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="editWorkshopLocation">Location</label>
                            <input
                                id="editWorkshopLocation"
                                type="text"
                                placeholder="Online or physical location"
                            />
                        </div>

                        <div class="input-group">
                            <label for="editWorkshopCapacity">Capacity</label>
                            <input
                                id="editWorkshopCapacity"
                                type="number"
                                placeholder="Maximum participants"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editWorkshopPublished"
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Workshop
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditWorkshopModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Team Member Modal -->
        <div id="editTeamMemberModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Team Member</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditTeamMemberModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editTeamMemberForm">
                    <input type="hidden" id="editTeamMemberId" />
                    <div class="form-grid">
                        <div class="input-group">
                            <label for="editTeamMemberName">Name *</label>
                            <input
                                id="editTeamMemberName"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="editTeamMemberRole">Role *</label>
                            <input
                                id="editTeamMemberRole"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="editTeamMemberBio">Bio *</label>
                            <textarea
                                id="editTeamMemberBio"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editTeamMemberImageFile"
                                >Profile Image</label
                            >
                            <input
                                type="file"
                                id="editTeamMemberImageFile"
                                accept="image/*"
                            />
                            <small>Optional: Team member photo</small>
                        </div>

                        <div class="input-group">
                            <label for="editTeamMemberImageUrl"
                                >Or Image URL</label
                            >
                            <input id="editTeamMemberImageUrl" type="url" />
                        </div>

                        <div class="input-group">
                            <label for="editTeamMemberOrder"
                                >Display Order</label
                            >
                            <input
                                id="editTeamMemberOrder"
                                type="number"
                                min="0"
                                value="0"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editTeamMemberActive"
                                />
                                <span class="toggle-slider"></span>
                                <span>Active</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Team Member
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditTeamMemberModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Tutorial Modal -->
        <div id="editTutorialModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Tutorial</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditTutorialModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editTutorialForm">
                    <input type="hidden" id="editTutorialId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editTutorialTitle">Title *</label>
                            <input
                                id="editTutorialTitle"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="editTutorialDescription"
                                >Description *</label
                            >
                            <textarea
                                id="editTutorialDescription"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editTutorialCategory">Category *</label>
                            <input
                                id="editTutorialCategory"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="editTutorialFormat">Format</label>
                            <input
                                id="editTutorialFormat"
                                type="text"
                                placeholder="e.g., Video, PDF"
                            />
                        </div>

                        <div class="input-group">
                            <label for="editTutorialDuration">Duration</label>
                            <input
                                id="editTutorialDuration"
                                type="text"
                                placeholder="e.g., 2 hours"
                            />
                        </div>

                        <div class="input-group">
                            <label for="editTutorialLevel">Level</label>
                            <select id="editTutorialLevel">
                                <option value="beginner">Beginner</option>
                                <option value="intermediate">
                                    Intermediate
                                </option>
                                <option value="advanced">Advanced</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editTutorialPublished"
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Tutorial
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditTutorialModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Exhibition Modal -->
        <div id="editExhibitionModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Exhibition</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditExhibitionModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editExhibitionForm">
                    <input type="hidden" id="editExhibitionId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editExhibitionTitle">Title *</label>
                            <input
                                id="editExhibitionTitle"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="editExhibitionDescription"
                                >Description *</label
                            >
                            <textarea
                                id="editExhibitionDescription"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editExhibitionStartDate"
                                >Start Date *</label
                            >
                            <input
                                id="editExhibitionStartDate"
                                type="date"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="editExhibitionEndDate"
                                >End Date *</label
                            >
                            <input
                                id="editExhibitionEndDate"
                                type="date"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="editExhibitionLocation">Location</label>
                            <input id="editExhibitionLocation" type="text" />
                        </div>

                        <div class="input-group">
                            <label for="editExhibitionCurator">Curator</label>
                            <input id="editExhibitionCurator" type="text" />
                        </div>

                        <div class="input-group full-width">
                            <label for="editExhibitionCuratorBio"
                                >Curator Bio</label
                            >
                            <textarea id="editExhibitionCuratorBio"></textarea>
                        </div>

                        <div class="input-group full-width">
                            <label for="editExhibitionVirtualTour"
                                >Virtual Tour URL</label
                            >
                            <input
                                id="editExhibitionVirtualTour"
                                type="url"
                                placeholder="https://"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editExhibitionPublished"
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Exhibition
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditExhibitionModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Photo Modal -->
        <div id="editPhotoModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Photo</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditPhotoModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editPhotoForm">
                    <input type="hidden" id="editPhotoId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editPhotoTitle">Title *</label>
                            <input id="editPhotoTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="editPhotoDescription"
                                >Description</label
                            >
                            <textarea id="editPhotoDescription"></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editPhotoCategory">Category *</label>
                            <select id="editPhotoCategory" required>
                                <option value="Architecture">
                                    Architecture
                                </option>
                                <option value="Nature">Nature</option>
                                <option value="Residential">Residential</option>
                                <option value="Public">Public</option>
                                <option value="Commercial">Commercial</option>
                                <option value="Cultural">Cultural</option>
                            </select>
                        </div>

                        <!-- Gallery Selection/Creation -->
                        <div class="input-group full-width">
                            <label>Gallery</label>
                            <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                                <button type="button" class="btn-secondary" id="editUseExistingGalleryBtn" onclick="toggleEditGalleryMode('existing')" style="flex: 1;">
                                    <i class="fas fa-folder-open"></i> Select Existing
                                </button>
                                <button type="button" class="btn-secondary" id="editCreateNewGalleryBtn" onclick="toggleEditGalleryMode('new')" style="flex: 1;">
                                    <i class="fas fa-folder-plus"></i> Create New
                                </button>
                            </div>
                            
                            <!-- Existing Gallery Selection -->
                            <div id="editExistingGallerySection" style="display: none;">
                                <select id="editPhotoExistingGallery" style="width: 100%; padding: 0.8rem; background: rgba(255, 255, 255, 0.05); border: 1px solid var(--border-light); border-radius: 8px; color: var(--text-light);">
                                    <option value="">Loading galleries...</option>
                                </select>
                            </div>
                            
                            <!-- New Gallery Creation -->
                            <div id="editNewGallerySection" style="display: none;">
                                <input 
                                    type="text" 
                                    id="editPhotoNewGallery" 
                                    placeholder="Enter new gallery name (e.g., Summer 2024 Projects)"
                                    style="width: 100%; padding: 0.8rem; background: rgba(255, 255, 255, 0.05); border: 1px solid var(--border-light); border-radius: 8px; color: var(--text-light);"
                                />
                            </div>
                        </div>

                        <div class="input-group full-width">
                            <label for="editPhotoFileInput">Photo Upload</label>
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('editPhotoFileInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h4>Upload New Photo</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Recommended: 1200x800px, max 20MB
                                </p>
                                <input
                                    type="file"
                                    id="editPhotoFileInput"
                                    class="file-input"
                                    accept="image/*"
                                />
                            </div>
                            <div
                                id="editPhotoPreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="editPhotoFeatured" />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editPhotoPublished"
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Photo
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditPhotoModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Video Modal -->
        <div id="editVideoModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Video</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditVideoModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editVideoForm">
                    <input type="hidden" id="editVideoId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editVideoTitle">Title *</label>
                            <input id="editVideoTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="editVideoDescription"
                                >Description</label
                            >
                            <textarea id="editVideoDescription"></textarea>
                        </div>

                        <div class="input-group full-width">
                            <label for="editVideoFileInput"
                                >Video Upload (Local File)</label
                            >
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('editVideoFileInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-video"></i>
                                </div>
                                <h4>Upload New Video</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Supported: MP4, WebM, max 100MB
                                </p>
                                <input
                                    type="file"
                                    id="editVideoFileInput"
                                    class="file-input"
                                    accept="video/*"
                                />
                            </div>
                            <div
                                id="editVideoFilePreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label for="editVideoURL">Or Video URL</label>
                            <input
                                id="editVideoURL"
                                type="url"
                                placeholder="https://youtube.com/embed/..."
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="editVideoThumbnailInput"
                                >Thumbnail Image</label
                            >
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('editVideoThumbnailInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-image"></i>
                                </div>
                                <h4>Upload New Thumbnail</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Supported: JPG, PNG, max 20MB
                                </p>
                                <input
                                    type="file"
                                    id="editVideoThumbnailInput"
                                    class="file-input"
                                    accept="image/*"
                                />
                            </div>
                            <div
                                id="editVideoThumbnailPreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label for="editVideoCategory">Category</label>
                            <input
                                id="editVideoCategory"
                                type="text"
                                placeholder="e.g., Tutorial, Project Showcase"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="editVideoFeatured" />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editVideoPublished"
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Video
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditVideoModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Design Modal -->
        <div id="editDesignModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Design</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditDesignModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editDesignForm">
                    <input type="hidden" id="editDesignId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editDesignTitle">Title *</label>
                            <input id="editDesignTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="editDesignDescription"
                                >Description</label
                            >
                            <textarea id="editDesignDescription"></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editDesignCategory">Category *</label>
                            <select id="editDesignCategory" required>
                                <option value="Architecture">
                                    Architecture
                                </option>
                                <option value="Interior">
                                    Interior Design
                                </option>
                                <option value="Urban">Urban Planning</option>
                                <option value="Landscape">Landscape</option>
                            </select>
                        </div>

                        <div class="input-group full-width">
                            <label for="editDesignFileInput"
                                >Design File Upload</label
                            >
                            <div
                                class="file-upload-container"
                                onclick="document.getElementById('editDesignFileInput').click()"
                            >
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h4>Upload New Design File</h4>
                                <p>Click to browse or drag and drop</p>
                                <p class="upload-hint">
                                    Supports: JPG, PNG, PDF, max 10MB
                                </p>
                                <input
                                    type="file"
                                    id="editDesignFileInput"
                                    class="file-input"
                                    accept="image/*,.pdf"
                                />
                            </div>
                            <div
                                id="editDesignPreview"
                                class="image-preview"
                            ></div>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editDesignFeatured"
                                />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editDesignPublished"
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Design
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditDesignModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Testimonial Modal -->
        <div id="editTestimonialModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Testimonial</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditTestimonialModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editTestimonialForm">
                    <input type="hidden" id="editTestimonialId" />
                    <div class="form-grid">
                        <div class="input-group">
                            <label for="editTestimonialName">Name *</label>
                            <input
                                id="editTestimonialName"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="editTestimonialRole"
                                >Role/Position *</label
                            >
                            <input
                                id="editTestimonialRole"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="editTestimonialOrganization"
                                >Organization</label
                            >
                            <input
                                id="editTestimonialOrganization"
                                type="text"
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="editTestimonialQuote"
                                >Testimonial Quote *</label
                            >
                            <textarea
                                id="editTestimonialQuote"
                                required
                                placeholder="What they said about us..."
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editTestimonialProject"
                                >Related Project</label
                            >
                            <input id="editTestimonialProject" type="text" />
                        </div>

                        <div class="input-group">
                            <label for="editTestimonialRating"
                                >Rating (1-5)</label
                            >
                            <select id="editTestimonialRating">
                                <option value="5">5 Stars</option>
                                <option value="4">4 Stars</option>
                                <option value="3">3 Stars</option>
                                <option value="2">2 Stars</option>
                                <option value="1">1 Star</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editTestimonialFeatured"
                                />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editTestimonialPublished"
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Testimonial
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditTestimonialModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Story Modal -->
        <div id="editStoryModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Community Story</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditStoryModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editStoryForm">
                    <input type="hidden" id="editStoryId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editStoryTitle">Story Title *</label>
                            <input id="editStoryTitle" type="text" required />
                        </div>

                        <div class="input-group full-width">
                            <label for="editStoryContent"
                                >Story Content *</label
                            >
                            <textarea id="editStoryContent" required></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editStoryAuthorName"
                                >Author Name *</label
                            >
                            <input
                                id="editStoryAuthorName"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group">
                            <label for="editStoryAuthorTitle"
                                >Author Title</label
                            >
                            <input
                                id="editStoryAuthorTitle"
                                type="text"
                                placeholder="e.g., Community Member, Volunteer"
                            />
                        </div>

                        <div class="input-group">
                            <label for="editStoryCategory">Category</label>
                            <input
                                id="editStoryCategory"
                                type="text"
                                placeholder="e.g., Volunteer Experience, Success Story"
                            />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="editStoryFeatured" />
                                <span class="toggle-slider"></span>
                                <span>Featured</span>
                            </label>
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editStoryPublished"
                                />
                                <span class="toggle-slider"></span>
                                <span>Published</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Story
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditStoryModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Initiative Modal -->
        <div id="editInitiativeModal" class="modal hidden">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Initiative</h3>
                    <button
                        class="btn-secondary"
                        type="button"
                        onclick="hideEditInitiativeModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <form id="editInitiativeForm">
                    <input type="hidden" id="editInitiativeId" />
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editInitiativeTitle">Title *</label>
                            <input
                                id="editInitiativeTitle"
                                type="text"
                                required
                            />
                        </div>

                        <div class="input-group full-width">
                            <label for="editInitiativeDescription"
                                >Description *</label
                            >
                            <textarea
                                id="editInitiativeDescription"
                                required
                            ></textarea>
                        </div>

                        <div class="input-group">
                            <label for="editInitiativeStatus">Status *</label>
                            <select id="editInitiativeStatus" required>
                                <option value="planned">Planned</option>
                                <option value="in_progress">In Progress</option>
                                <option value="completed">Completed</option>
                                <option value="on_hold">On Hold</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label for="editInitiativeTargetDate"
                                >Target Date</label
                            >
                            <input id="editInitiativeTargetDate" type="date" />
                        </div>

                        <div class="input-group">
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="editInitiativeActive"
                                />
                                <span class="toggle-slider"></span>
                                <span>Active</span>
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Initiative
                        </button>
                        <button
                            type="button"
                            class="btn-secondary"
                            onclick="hideEditInitiativeModal()"
                        >
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <script>
            // Enhanced API configuration with better error handling
            const API_BASE_URL =
                window.location.hostname === "localhost" ||
                window.location.hostname === "127.0.0.1"
                    ? "http://localhost:4000/api"
                    : "https://aspire-arch-server.onrender.com/api";

            console.log(" Using API URL:", API_BASE_URL);

            // Global state
            let authToken = null;
            let allItems = [];
            let contactSubmissions = [];
            let currentGetInvolvedTab = "membership";
            let currentMediaTab = "photos";
            let currentEducationTab = "workshops";
            let currentColleaguesTab = "colleagues-contacts";
            let currentResearchTab = "research-all";
            let currentDesignTab = "design-all";
            let currentNewsEventsTab = "newsevents-all";
            let currentPhotoCategory = "All";

            // Loading overlay functions
            function showLoading(text = 'Processing...') {
                const overlay = document.getElementById('loadingOverlay');
                const loadingText = document.getElementById('loadingText');
                if (overlay && loadingText) {
                    loadingText.textContent = text;
                    overlay.classList.remove('hidden');
                }
            }

            function hideLoading() {
                const overlay = document.getElementById('loadingOverlay');
                if (overlay) {
                    overlay.classList.add('hidden');
                }
            }

            // Stats objects
            let mediaStats = {
                photos: 0,
                videos: 0,
                designs: 0,
                testimonials: 0,
            };
            let educationStats = {
                workshops: 0,
                tutorials: 0,
                exhibitions: 0,
                totalEnrolled: 0,
            };
            let colleaguesStats = {
                contacts: 0,
                team: 0,
                initiatives: 0,
                newContacts: 0,
            };
            let researchStats = {
                articles: 0,
                sustainable: 0,
                climate: 0,
                social: 0,
                technological: 0,
                featured: 0,
            };
            let designStats = {
                total: 0,
                academic: 0,
                professional: 0,
                competition: 0,
                featured: 0,
            };
            let newsEventsStats = {
                news: 0,
                events: 0,
                featuredNews: 0,
                featuredEvents: 0,
            };

            // Sector mapping
            const sectorLabels = {
                residential: "Residential Architecture",
                interior: "Interior Design",
                refurbishment: "Refurbishment",
                cultural: "Cultural Architecture",
                commercial: "Commercial & Offices",
                hospitality: "Hospitality Architecture",
                public: "Public Architecture",
                healthcare: "Healthcare Architecture",
                educational: "Educational Architecture",
                sports: "Sports Architecture",
                religious: "Religious Architecture",
                industrial: "Industrial & Infrastructure",
                landscape: "Landscape & Urbanism",
            };

            // DOM Elements
            const loginScreen = document.getElementById("loginScreen");
            const dashboard = document.getElementById("dashboard");
            const sidebar = document.getElementById("sidebar");
            const mobileMenuBtn = document.getElementById("mobileMenuBtn");
            const overlay = document.getElementById("overlay");
            const pageTitle = document.getElementById("pageTitle");
            const navItems = document.querySelectorAll(".nav-item");
            const sections = document.querySelectorAll(".section");

            // ===== ENHANCED AUTHENTICATION SYSTEM =====

            // Enhanced API Request with better token handling
            async function apiRequest(endpoint, options = {}) {
                const url = `${API_BASE_URL}${endpoint}`;

                // Get current token with validation
                const currentToken = getValidToken();
                if (!currentToken && !endpoint.includes("/auth/login")) {
                    console.warn(
                        "No valid token available, redirecting to login"
                    );
                    showLogin();
                    throw new Error("Authentication required");
                }

                const config = {
                    headers: {
                        "Content-Type": "application/json",
                        ...(currentToken
                            ? { Authorization: `Bearer ${currentToken}` }
                            : {}),
                        ...options.headers,
                    },
                    ...options,
                };

                // For FormData requests, remove Content-Type header
                if (options.body instanceof FormData) {
                    delete config.headers["Content-Type"];
                }

                try {
                    console.log(
                        ` API Request: ${options.method || "GET"} ${url}`
                    );

                    const response = await fetch(url, config);

                    if (response.status === 401) {
                        console.error(" Authentication failed (401)");
                        clearAuthData();
                        showLogin();
                        throw new Error(
                            "Authentication failed. Please login again."
                        );
                    }

                    if (!response.ok) {
                        const errorText = await response.text();
                        console.error(" API Error Response:", errorText);
                        let errorData;
                        try {
                            errorData = JSON.parse(errorText);
                        } catch {
                            errorData = {
                                error: `HTTP ${response.status}: ${response.statusText}`,
                            };
                        }
                        throw new Error(
                            errorData.error ||
                                `HTTP error! status: ${response.status}`
                        );
                    }

                    const data = await response.json();
                    console.log(` API Success for ${endpoint}`);
                    return data;
                } catch (error) {
                    console.error(" API Request failed:", error);

                    // If it's an auth error, redirect to login
                    if (
                        error.message.includes("Authentication failed") ||
                        error.message.includes("Authentication required")
                    ) {
                        showLogin();
                    }

                    throw error;
                }
            }

            // Token management functions
            function getValidToken() {
                const token = authToken || localStorage.getItem("aspire_token");
                if (!token) return null;

                // Basic token validation
                try {
                    const payload = JSON.parse(atob(token.split(".")[1]));
                    const isExpired =
                        payload.exp && Date.now() >= payload.exp * 1000;
                    if (isExpired) {
                        console.warn("Token expired");
                        clearAuthData();
                        return null;
                    }
                    return token;
                } catch (error) {
                    console.warn("Invalid token format");
                    clearAuthData();
                    return null;
                }
            }

            function clearAuthData() {
                authToken = null;
                localStorage.removeItem("aspire_token");
                localStorage.removeItem("aspire_token_timestamp");
            }

            function storeAuthData(token) {
                authToken = token;
                localStorage.setItem("aspire_token", token);
                localStorage.setItem(
                    "aspire_token_timestamp",
                    Date.now().toString()
                );
            }

            // Upload file to Cloudinary via API
            async function uploadFile(file, type) {
                showLoading(`Uploading ${type}...`);
                try {
                    console.log(
                        ` Uploading ${type} file to Cloudinary:`,
                        file.name,
                        file.size,
                        file.type
                    );

                    // Show warning for very large videos
                    if (file.type.startsWith('video/') && file.size > 50 * 1024 * 1024) {
                        console.warn(` Large video file detected: ${(file.size / 1024 / 1024).toFixed(2)}MB - This may take a while to upload...`);
                    }

                    // Compress image if it's too large (over 2MB for faster uploads)
                    let processedFile = file;
                    if (file.type.startsWith('image/') && file.size > 2 * 1024 * 1024) {
                        showLoading('Compressing image...');
                        console.log(' Image is large, compressing for faster upload...');
                        processedFile = await compressImage(file, 2, 0.7); // More aggressive compression
                        console.log(` Compressed from ${(file.size / 1024 / 1024).toFixed(2)}MB to ${(processedFile.size / 1024 / 1024).toFixed(2)}MB`);
                    }

                    showLoading(`Uploading to Cloudinary...`);
                    
                    // Create FormData and upload to server
                    const formData = new FormData();
                    formData.append('file', processedFile);
                    formData.append('type', type);

                    const response = await fetch(`${API_BASE_URL}/upload`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${localStorage.getItem('token')}`
                        },
                        body: formData
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || 'Upload failed');
                    }

                    const result = await response.json();
                    console.log(" File uploaded successfully:", result.fileUrl);
                    
                    hideLoading();
                    // Return the Cloudinary URL
                    return result.fileUrl;
                } catch (error) {
                    hideLoading();
                    console.error(" File upload error:", error);
                    throw error;
                }
            }

            // Helper function to compress large images
            async function compressImage(file, maxSizeMB = 5, quality = 0.8) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = (e) => {
                        const img = new Image();
                        img.src = e.target.result;
                        img.onload = () => {
                            const canvas = document.createElement('canvas');
                            let width = img.width;
                            let height = img.height;

                            // Calculate new dimensions to keep aspect ratio
                            const maxDimension = 2048; // Max width or height
                            if (width > maxDimension || height > maxDimension) {
                                if (width > height) {
                                    height = (height / width) * maxDimension;
                                    width = maxDimension;
                                } else {
                                    width = (width / height) * maxDimension;
                                    height = maxDimension;
                                }
                            }

                            canvas.width = width;
                            canvas.height = height;

                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(img, 0, 0, width, height);

                            // Try different quality levels until file size is acceptable
                            canvas.toBlob(
                                (blob) => {
                                    if (blob) {
                                        // Create a new File object from the blob
                                        const compressedFile = new File([blob], file.name, {
                                            type: 'image/jpeg',
                                            lastModified: Date.now(),
                                        });
                                        resolve(compressedFile);
                                    } else {
                                        reject(new Error('Image compression failed'));
                                    }
                                },
                                'image/jpeg',
                                quality
                            );
                        };
                        img.onerror = () => reject(new Error('Failed to load image'));
                    };
                    reader.onerror = () => reject(new Error('Failed to read file'));
                });
            }

            // Helper function to convert file to base64
            function fileToBase64(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = (error) => reject(error);
                });
            }

            // ===== ENHANCED AUTHENTICATION FLOW =====

            async function handleLogin() {
                const username = document.getElementById("username").value;
                const password = document.getElementById("password").value;
                const loginMsg = document.getElementById("loginMsg");

                if (!username || !password) {
                    loginMsg.innerHTML =
                        '<span class="text-danger">Please enter both username and password</span>';
                    return;
                }

                try {
                    loginMsg.innerHTML =
                        '<span class="text-warning">Logging in...</span>';

                    console.log(" Attempting login with:", {
                        username,
                        API_BASE_URL,
                    });

                    const result = await fetch(`${API_BASE_URL}/auth/login`, {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({ username, password }),
                    });

                    console.log(" Login response status:", result.status);

                    if (!result.ok) {
                        const errorText = await result.text();
                        console.error(" Login failed:", errorText);
                        let errorData;
                        try {
                            errorData = JSON.parse(errorText);
                        } catch {
                            errorData = {
                                error: `HTTP ${result.status}: ${result.statusText}`,
                            };
                        }
                        throw new Error(
                            errorData.error || `Login failed: ${result.status}`
                        );
                    }

                    const data = await result.json();
                    console.log(" Login response data:", data);

                    if (data.token) {
                        storeAuthData(data.token);
                        console.log(" Login successful, token stored");
                        await showDashboard();
                    } else {
                        throw new Error("No token received from server");
                    }
                } catch (error) {
                    console.error(" Login error:", error);
                    loginMsg.innerHTML = `<span class="text-danger">${
                        error.message ||
                        "Login failed. Check credentials and server connection."
                    }</span>`;
                }
            }

            function showLogin() {
                console.log(" Showing login screen");
                if (dashboard) dashboard.classList.add("hidden");
                if (loginScreen) loginScreen.classList.remove("hidden");
                clearAuthData();
            }

            async function showDashboard() {
                const token = getValidToken();
                if (!token) {
                    console.log(" No valid token, redirecting to login");
                    showLogin();
                    return;
                }

                try {
                    console.log(" Valid token found, showing dashboard");
                    if (loginScreen) loginScreen.classList.add("hidden");
                    if (dashboard) dashboard.classList.remove("hidden");

                    // Initialize the dashboard
                    await initializeDashboard();
                    console.log(" Dashboard initialized successfully");
                } catch (error) {
                    console.error(" Failed to initialize dashboard:", error);
                    showLogin();
                }
            }

            async function initializeDashboard() {
                try {
                    // Test API connection first
                    console.log(" Testing API connection...");
                    await apiRequest("/health");
                    console.log(" API connection successful");

                    // Load dashboard data
                    await loadDashboardData();

                    // Initialize event listeners
                    initializeEventListeners();

                    // Initialize navigation
                    initializeNavigation();
                } catch (error) {
                    console.error(" Dashboard initialization failed:", error);
                    throw error;
                }
            }

            // ===== ENHANCED NAVIGATION SYSTEM =====

            // Initialize navigation
            function initializeNavigation() {
                navItems.forEach((item) => {
                    item.addEventListener("click", () => {
                        const section = item.getAttribute("data-section");
                        showSection(section);

                        // Update active nav item
                        navItems.forEach((nav) =>
                            nav.classList.remove("active")
                        );
                        item.classList.add("active");

                        // Update page title
                        pageTitle.textContent =
                            item.querySelector("span").textContent;

                        // Load section-specific data
                        loadSectionData(section);

                        // Close mobile menu
                        if (window.innerWidth <= 1024) {
                            sidebar.classList.remove("open");
                            overlay.classList.remove("active");
                        }
                    });
                });
            }

            function showSection(sectionName) {
                sections.forEach((section) => {
                    section.classList.add("hidden");
                });
                const targetSection = document.getElementById(
                    sectionName + "Section"
                );
                if (targetSection) {
                    targetSection.classList.remove("hidden");
                }
            }

            function loadSectionData(section) {
                const sectionHandlers = {
                    contact: loadContactData,
                    dashboard: loadDashboardData,
                    getinvolved: () => showGetInvolvedTab("membership"),
                    media: () => {
                        loadMediaStats();
                        showMediaTab("photos");
                    },
                    education: () => {
                        loadEducationStats();
                        showEducationTab("workshops");
                    },
                    design: () => {
                        loadDesignStats();
                        showDesignTab("design-all");
                    },
                    newsevents: () => {
                        loadNewsEventsStats();
                        showNewsEventsTab("newsevents-all");
                    },
                    research: () => {
                        loadResearchStats();
                        showResearchTab("research-all");
                    },
                    colleagues: () => {
                        loadColleaguesStats();
                        showColleaguesTab("colleagues-contacts");
                    },
                };

                const handler = sectionHandlers[section];
                if (handler) handler();
            }

            // ===== ENHANCED DASHBOARD SYSTEM =====

            async function loadDashboardData() {
                try {
                    console.log(" Loading dashboard data...");
                    await Promise.all([
                        loadItems(),
                        loadContactStats(),
                        loadEducationStats(),
                        loadColleaguesStats(),
                        loadResearchStats(),
                        loadDesignStats(),
                        loadNewsEventsStats(),
                    ]);
                } catch (error) {
                    console.error("Failed to load dashboard data:", error);
                    setDefaultStats();
                }
            }

            async function loadItems() {
                try {
                    console.log(" Loading items...");
                    const data = await apiRequest("/items");
                    allItems = Array.isArray(data) ? data : [];
                    renderItems(allItems);
                    updateStats(allItems);
                } catch (error) {
                    console.error("Failed to load items:", error);
                    allItems = [];
                    renderItems([]);
                    updateStats([]);
                }
            }

            function setDefaultStats() {
                const stats = {
                    newsCount: "0",
                    projectCount: "0",
                    insightCount: "0",
                    contactCount: "0",
                    workshopCount: "0",
                    tutorialCount: "0",
                    colleaguesContactCount: "0",
                    designProjectsCount: "0",
                    researchArticlesCount: "0",
                };

                Object.entries(stats).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) element.textContent = value;
                });

                const recentContainer = document.getElementById("recentItems");
                if (recentContainer) {
                    recentContainer.innerHTML =
                        '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No recent activity</p>';
                }
            }

            function updateStats(items) {
                const counts = {
                    news: items.filter((item) => item.type === "news").length,
                    project: items.filter((item) => item.type === "project")
                        .length,
                    insight: items.filter((item) => item.type === "insight")
                        .length,
                    event: items.filter((item) => item.type === "event").length,
                    course: items.filter((item) => item.type === "course")
                        .length,
                };

                const elements = {
                    newsCount: counts.news,
                    projectCount: counts.project,
                    insightCount: counts.insight,
                };

                Object.entries(elements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) element.textContent = value;
                });

                // Update recent items
                const recentItems = items.slice(0, 5);
                const recentContainer = document.getElementById("recentItems");
                if (recentContainer) {
                    recentContainer.innerHTML = "";

                    if (recentItems.length === 0) {
                        recentContainer.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No recent activity</p>';
                        return;
                    }

                    recentItems.forEach((item) => {
                        const el = createItemElement(item);
                        recentContainer.appendChild(el);
                    });
                }
            }

            function renderItems(items) {
                const container = document.getElementById("items");
                if (!container) return;

                container.innerHTML = "";

                if (items.length === 0) {
                    container.innerHTML =
                        '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No content items found.</p>';
                    return;
                }

                items.forEach((item) => {
                    const el = createItemElement(item);
                    container.appendChild(el);
                });
            }

            function createItemElement(item) {
                const el = document.createElement("div");
                el.className = "item";

                const content = document.createElement("div");
                content.className = "item-content";

                const title = document.createElement("h4");
                title.className = "item-title";
                title.textContent = item.title || "Untitled";

                const meta = document.createElement("div");
                meta.className = "item-meta";

                const type = document.createElement("span");
                type.className = "item-type";
                type.textContent = item.type || "unknown";

                const date = document.createElement("span");
                date.className = "item-date";
                date.textContent = item.created_at
                    ? new Date(item.created_at).toLocaleDateString()
                    : "Unknown date";

                meta.appendChild(type);
                meta.appendChild(date);

                const preview = document.createElement("div");
                preview.className = "item-preview";
                const contentText = item.content || "";
                preview.innerHTML =
                    contentText.substring(0, 150) +
                    (contentText.length > 150 ? "..." : "");

                content.appendChild(title);
                content.appendChild(meta);
                content.appendChild(preview);

                // Add files list if any
                if (
                    item.files &&
                    Array.isArray(item.files) &&
                    item.files.length > 0
                ) {
                    const filesList = document.createElement("div");
                    filesList.className = "files-list";
                    item.files.forEach((file) => {
                        const fileItem = document.createElement("div");
                        fileItem.className = "file-item";
                        const icon = document.createElement("span");
                        icon.innerHTML =
                            file.type && file.type.startsWith("image/")
                                ? ""
                                : "";
                        const link = document.createElement("a");
                        link.href = file.path || "#";
                        link.target = "_blank";
                        link.textContent = file.name || "File";
                        fileItem.appendChild(icon);
                        fileItem.appendChild(link);
                        filesList.appendChild(fileItem);
                    });
                    content.appendChild(filesList);
                }

                const actions = document.createElement("div");
                actions.className = "item-actions";

                const editBtn = document.createElement("button");
                editBtn.className = "btn-secondary";
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                editBtn.onclick = () => editItem(item);

                const del = document.createElement("button");
                del.className = "btn-danger";
                del.innerHTML = '<i class="fas fa-trash"></i> Delete';
                del.onclick = async () => {
                    if (confirm("Are you sure you want to delete this item?")) {
                        try {
                            await apiRequest(`/items/admin/${item.id}`, {
                                method: "DELETE",
                            });
                            await loadItems();
                        } catch (error) {
                            console.error("Delete failed:", error);
                            alert("Failed to delete item: " + error.message);
                        }
                    }
                };

                actions.appendChild(editBtn);
                actions.appendChild(del);
                content.appendChild(actions);

                if (item.image) {
                    const img = document.createElement("img");
                    img.src = item.image;
                    img.alt = item.title || "Item image";
                    el.appendChild(img);
                }

                el.appendChild(content);
                return el;
            }

            // ===== ENHANCED EDIT FUNCTIONALITY =====

            function editItem(item) {
                // Create edit modal dynamically
                const editModal = document.createElement("div");
                editModal.className = "modal";
                editModal.innerHTML = `
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Item</h3>
                    <button class="btn-secondary" type="button" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <form id="editItemForm">
                    <div class="form-grid">
                        <div class="input-group full-width">
                            <label for="editTitle">Title *</label>
                            <input id="editTitle" type="text" value="${
                                item.title || ""
                            }" required>
                        </div>
                        <div class="input-group full-width">
                            <label for="editContent">Content *</label>
                            <textarea id="editContent" required>${
                                item.content || ""
                            }</textarea>
                        </div>
                        <div class="input-group">
                            <label for="editType">Type *</label>
                            <select id="editType" required>
                                <option value="news" ${
                                    item.type === "news" ? "selected" : ""
                                }>News</option>
                                <option value="project" ${
                                    item.type === "project" ? "selected" : ""
                                }>Project</option>
                                <option value="insight" ${
                                    item.type === "insight" ? "selected" : ""
                                }>Insight</option>
                                <option value="event" ${
                                    item.type === "event" ? "selected" : ""
                                }>Event</option>
                            </select>
                        </div>
                    </div>
                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Item
                        </button>
                        <button type="button" class="btn-secondary" onclick="this.closest('.modal').remove()">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        `;

                document.body.appendChild(editModal);

                // Handle form submission
                document
                    .getElementById("editItemForm")
                    .addEventListener("submit", async (e) => {
                        e.preventDefault();

                        const updatedData = {
                            title: document.getElementById("editTitle").value,
                            content:
                                document.getElementById("editContent").value,
                            type: document.getElementById("editType").value,
                        };

                        try {
                            await apiRequest(`/items/${item.id}`, {
                                method: "PUT",
                                body: JSON.stringify(updatedData),
                            });

                            editModal.remove();
                            await loadItems();
                            alert("Item updated successfully!");
                        } catch (error) {
                            console.error("Failed to update item:", error);
                            alert("Failed to update item: " + error.message);
                        }
                    });
            }

            // ===== ENHANCED CONTACT MANAGEMENT =====

            async function loadContactData() {
                try {
                    console.log(" Loading contact data...");
                    await loadContactSubmissions();
                } catch (error) {
                    console.error("Failed to load contact data:", error);
                }
            }

            async function loadContactSubmissions() {
                try {
                    console.log(" Loading contact submissions...");
                    const data = await apiRequest("/contact/submissions");
                    console.log(" Raw submissions data:", data);

                    contactSubmissions = Array.isArray(data)
                        ? data
                        : Array.isArray(data.data)
                        ? data.data
                        : [];

                    console.log(
                        ` Processed ${contactSubmissions.length} submissions`
                    );

                    renderContactSubmissions(contactSubmissions);
                    updateContactStats(contactSubmissions);
                } catch (error) {
                    console.error("Failed to load contact submissions:", error);
                    contactSubmissions = [];
                    renderContactSubmissions([]);
                    updateContactStats([]);
                }
            }
            async function loadContactInfo() {
                try {
                    const data = await apiRequest("/contact/admin/info");
                    contactInfo = Array.isArray(data)
                        ? data
                        : Array.isArray(data.data)
                        ? data.data
                        : [];
                    renderContactInfo(contactInfo);
                } catch (error) {
                    console.error("Failed to load contact info:", error);
                    contactInfo = [];
                    renderContactInfo([]);
                }
            }

            async function loadEmailSettings() {
                try {
                    const data = await apiRequest("/contact/email-settings");
                    emailSettings = Array.isArray(data)
                        ? data
                        : Array.isArray(data.data)
                        ? data.data
                        : [];
                    renderEmailSettings(emailSettings);
                } catch (error) {
                    console.error("Failed to load email settings:", error);
                    emailSettings = [];
                    renderEmailSettings([]);
                }
            }

            function renderContactInfo(info) {
                const container = document.getElementById("contactInfoList");
                if (!container) return;

                container.innerHTML = "";

                if (info.length === 0) {
                    container.innerHTML =
                        '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No contact information found.</p>';
                    return;
                }

                info.forEach((item) => {
                    const el = document.createElement("div");
                    el.className = "contact-info-item";

                    const header = document.createElement("div");
                    header.className = "contact-info-header";

                    const left = document.createElement("div");
                    left.innerHTML = `
            <h4 style="margin: 0 0 0.5rem 0; color: var(--accent-light);">${
                item.title || "No title"
            }</h4>
            <p style="margin: 0; color: var(--text-muted); font-size: 0.9rem;">${
                item.type || "No type"
            }</p>
        `;

                    const right = document.createElement("label");
                    right.className = "toggle-switch";
                    right.innerHTML = `
            <input type="checkbox" ${
                item.is_active ? "checked" : ""
            } onchange="updateContactInfo(${item.id}, this.checked)">
            <span class="toggle-slider"></span>
        `;

                    header.appendChild(left);
                    header.appendChild(right);

                    const value = document.createElement("div");
                    value.style.marginTop = "1rem";
                    value.innerHTML = `
            <textarea style="width: 100%; min-height: 80px; padding: 0.8rem; background: rgba(255,255,255,0.05); border: 1px solid var(--border-light); border-radius: 8px; color: var(--text-light);" 
                      onblur="updateContactInfoValue(${item.id}, this.value)">${
                        item.value || ""
                    }</textarea>
        `;

                    el.appendChild(header);
                    el.appendChild(value);
                    container.appendChild(el);
                });
            }

            function renderEmailSettings(settings) {
                const container = document.getElementById("emailSettingsList");
                if (!container) return;

                container.innerHTML = "";

                if (settings.length === 0) {
                    container.innerHTML =
                        '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No email settings found.</p>';
                    return;
                }

                settings.forEach((setting) => {
                    const el = document.createElement("div");
                    el.className = "email-setting-item";

                    el.innerHTML = `
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                <div class="input-group">
                    <label>Recipient Email</label>
                    <input type="email" value="${
                        setting.recipient_email || ""
                    }" 
                           onblur="updateEmailSetting(${
                               setting.id
                           }, 'recipient_email', this.value)"
                           style="width: 100%;">
                </div>
                <div class="input-group">
                    <label>Subject Template</label>
                    <input type="text" value="${
                        setting.subject_template || ""
                    }" 
                           onblur="updateEmailSetting(${
                               setting.id
                           }, 'subject_template', this.value)"
                           style="width: 100%;">
                </div>
            </div>
            <div class="input-group">
                <label class="toggle-switch" style="display: flex; align-items: center; gap: 1rem;">
                    <span>Enabled</span>
                    <input type="checkbox" ${setting.enabled ? "checked" : ""} 
                           onchange="updateEmailSetting(${
                               setting.id
                           }, 'enabled', this.checked)">
                    <span class="toggle-slider"></span>
                </label>
            </div>
        `;

                    container.appendChild(el);
                });
            }

            // Add global functions for contact management
            window.updateContactInfo = async function (id, isActive) {
                try {
                    const item = contactInfo.find((i) => i.id === id);
                    if (item) {
                        await apiRequest(`/contact/info/${id}`, {
                            method: "PUT",
                            body: JSON.stringify({
                                ...item,
                                is_active: isActive,
                            }),
                        });
                    }
                } catch (error) {
                    console.error("Failed to update contact info:", error);
                    alert("Failed to update contact info: " + error.message);
                }
            };

            window.updateContactInfoValue = async function (id, value) {
                try {
                    const item = contactInfo.find((i) => i.id === id);
                    if (item) {
                        await apiRequest(`/contact/info/${id}`, {
                            method: "PUT",
                            body: JSON.stringify({ ...item, value }),
                        });
                    }
                } catch (error) {
                    console.error(
                        "Failed to update contact info value:",
                        error
                    );
                    alert("Failed to update contact info: " + error.message);
                }
            };

            window.updateEmailSetting = async function (id, field, value) {
                try {
                    const setting = emailSettings.find((s) => s.id === id);
                    if (setting) {
                        await apiRequest(`/contact/email-settings/${id}`, {
                            method: "PUT",
                            body: JSON.stringify({
                                ...setting,
                                [field]: value,
                            }),
                        });
                    }
                } catch (error) {
                    console.error("Failed to update email setting:", error);
                    alert("Failed to update email setting: " + error.message);
                }
            };

            async function loadContactStats() {
                try {
                    const stats = await apiRequest(
                        "/contact/submissions/stats"
                    );
                    const contactCountElement =
                        document.getElementById("contactCount");
                    if (
                        contactCountElement &&
                        stats &&
                        typeof stats.total !== "undefined"
                    ) {
                        contactCountElement.textContent = stats.total;
                    }
                } catch (error) {
                    console.error("Failed to load contact stats:", error);
                    const contactCountElement =
                        document.getElementById("contactCount");
                    if (contactCountElement)
                        contactCountElement.textContent = "0";
                }
            }

            function updateContactStats(submissions) {
                const total = submissions.length;
                const newCount = submissions.filter(
                    (s) => s.status === "new"
                ).length;
                const repliedCount = submissions.filter(
                    (s) => s.status === "replied"
                ).length;
                const recentCount = submissions.filter((s) => {
                    if (!s.created_at) return false;
                    const sevenDaysAgo = new Date();
                    sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
                    return new Date(s.created_at) >= sevenDaysAgo;
                }).length;

                const elements = {
                    totalSubmissions: total,
                    newSubmissions: newCount,
                    repliedSubmissions: repliedCount,
                    recentSubmissions: recentCount,
                };

                Object.entries(elements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) element.textContent = value;
                });
            }

            function renderContactSubmissions(submissions) {
                const container = document.getElementById("submissionsList");
                if (!container) return;

                container.innerHTML = "";

                if (submissions.length === 0) {
                    container.innerHTML =
                        '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No contact submissions found.</p>';
                    return;
                }

                submissions.forEach((submission) => {
                    const el = document.createElement("div");
                    el.className = "submission-item";

                    const header = document.createElement("div");
                    header.className = "submission-header";

                    const left = document.createElement("div");
                    left.innerHTML = `
            <h4 style="margin: 0 0 0.5rem 0; color: var(--accent-light);">${
                submission.name || "No name"
            }</h4>
            <p style="margin: 0; color: var(--text-muted);">${
                submission.email || "No email"
            }</p>
        `;

                    const right = document.createElement("div");
                    right.innerHTML = `
            <span class="status-badge status-${submission.status || "new"}">${
                        submission.status || "new"
                    }</span>
            <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                ${
                    submission.created_at
                        ? new Date(submission.created_at).toLocaleDateString()
                        : "Unknown date"
                }
            </div>
        `;

                    header.appendChild(left);
                    header.appendChild(right);

                    const meta = document.createElement("div");
                    meta.className = "submission-meta";

                    const statusSelect = document.createElement("select");
                    statusSelect.innerHTML = `
            <option value="new" ${
                (submission.status || "new") === "new" ? "selected" : ""
            }>New</option>
            <option value="read" ${
                (submission.status || "new") === "read" ? "selected" : ""
            }>Read</option>
            <option value="replied" ${
                (submission.status || "new") === "replied" ? "selected" : ""
            }>Replied</option>
            <option value="archived" ${
                (submission.status || "new") === "archived" ? "selected" : ""
            }>Archived</option>
        `;
                    statusSelect.onchange = async (e) => {
                        await updateSubmissionStatus(
                            submission.id,
                            e.target.value
                        );
                    };

                    const editBtn = document.createElement("button");
                    editBtn.className = "btn-secondary";
                    editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                    editBtn.onclick = () => editContactSubmission(submission);

                    const deleteBtn = document.createElement("button");
                    deleteBtn.className = "btn-danger";
                    deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Delete';
                    deleteBtn.onclick = async () => {
                        if (confirm("Delete this submission?")) {
                            try {
                                console.log(
                                    " Deleting contact submission:",
                                    submission.id
                                );
                                await apiRequest(
                                    `/contact/submissions/admin/${submission.id}`,
                                    { method: "DELETE" }
                                );
                                await loadContactSubmissions();
                                alert("Submission deleted successfully!");
                            } catch (error) {
                                console.error("Delete failed:", error);
                                alert(
                                    "Failed to delete submission: " +
                                        error.message
                                );
                            }
                        }
                    };

                    meta.appendChild(statusSelect);
                    meta.appendChild(editBtn);
                    meta.appendChild(deleteBtn);

                    const message = document.createElement("div");
                    message.style.padding = "1rem";
                    message.style.background = "rgba(255,255,255,0.03)";
                    message.style.borderRadius = "8px";
                    message.style.marginTop = "1rem";
                    message.textContent = submission.message || "No message";

                    el.appendChild(header);
                    el.appendChild(meta);
                    el.appendChild(message);
                    container.appendChild(el);
                });
            }

            function editContactSubmission(submission) {
                const editModal = document.createElement("div");
                editModal.className = "modal";
                editModal.innerHTML = `
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Edit Contact Submission</h3>
                    <button class="btn-secondary" type="button" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <form id="editContactForm">
                    <div class="form-grid">
                        <div class="input-group">
                            <label for="editContactName">Name *</label>
                            <input id="editContactName" type="text" value="${
                                submission.name || ""
                            }" required>
                        </div>
                        <div class="input-group">
                            <label for="editContactEmail">Email *</label>
                            <input id="editContactEmail" type="email" value="${
                                submission.email || ""
                            }" required>
                        </div>
                        <div class="input-group full-width">
                            <label for="editContactMessage">Message *</label>
                            <textarea id="editContactMessage" required>${
                                submission.message || ""
                            }</textarea>
                        </div>
                        <div class="input-group">
                            <label for="editContactStatus">Status</label>
                            <select id="editContactStatus">
                                <option value="new" ${
                                    submission.status === "new"
                                        ? "selected"
                                        : ""
                                }>New</option>
                                <option value="read" ${
                                    submission.status === "read"
                                        ? "selected"
                                        : ""
                                }>Read</option>
                                <option value="replied" ${
                                    submission.status === "replied"
                                        ? "selected"
                                        : ""
                                }>Replied</option>
                                <option value="archived" ${
                                    submission.status === "archived"
                                        ? "selected"
                                        : ""
                                }>Archived</option>
                            </select>
                        </div>
                    </div>
                    <div class="button-group">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Update Submission
                        </button>
                        <button type="button" class="btn-secondary" onclick="this.closest('.modal').remove()">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        `;

                document.body.appendChild(editModal);

                document
                    .getElementById("editContactForm")
                    .addEventListener("submit", async (e) => {
                        e.preventDefault();

                        const updatedData = {
                            name: document.getElementById("editContactName")
                                .value,
                            email: document.getElementById("editContactEmail")
                                .value,
                            message:
                                document.getElementById("editContactMessage")
                                    .value,
                            status: document.getElementById("editContactStatus")
                                .value,
                        };

                        try {
                            await apiRequest(
                                `/contact/submissions/${submission.id}`,
                                {
                                    method: "PUT",
                                    body: JSON.stringify(updatedData),
                                }
                            );

                            editModal.remove();
                            await loadContactSubmissions();
                            alert("Contact submission updated successfully!");
                        } catch (error) {
                            console.error(
                                "Failed to update contact submission:",
                                error
                            );
                            alert(
                                "Failed to update contact submission: " +
                                    error.message
                            );
                        }
                    });
            }

            async function updateSubmissionStatus(id, status) {
                try {
                    await apiRequest(`/contact/submissions/${id}/status`, {
                        method: "PUT",
                        body: JSON.stringify({ status }),
                    });
                    await loadContactSubmissions();
                } catch (error) {
                    console.error("Failed to update status:", error);
                    alert("Failed to update status: " + error.message);
                }
            }

            async function deleteSubmission(id) {
                try {
                    await apiRequest(`/contact/submissions/admin/${id}`, {
                        method: "DELETE",
                    });
                    await loadContactSubmissions();
                } catch (error) {
                    console.error("Failed to delete submission:", error);
                    alert("Failed to delete submission: " + error.message);
                }
            }

            // ===== ENHANCED GET INVOLVED MANAGEMENT =====

            async function loadMembershipApplications() {
                try {
                    const data = await apiRequest(
                        "/get-involved/admin/membership"
                    );
                    const container = document.getElementById("membershipList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No membership applications found.</p>';
                        return;
                    }

                    data.forEach((application) => {
                        const el = createGetInvolvedElement(
                            application,
                            "membership"
                        );
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error(
                        "Failed to load membership applications:",
                        error
                    );
                    const container = document.getElementById("membershipList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading membership applications.</p>';
                    }
                }
            }

            async function loadDonations() {
                try {
                    const data = await apiRequest(
                        "/get-involved/admin/donations"
                    );
                    const container = document.getElementById("donationsList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No donations found.</p>';
                        return;
                    }

                    data.forEach((donation) => {
                        const el = createGetInvolvedElement(
                            donation,
                            "donations"
                        );
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load donations:", error);
                    const container = document.getElementById("donationsList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading donations.</p>';
                    }
                }
            }

            async function loadFeedback() {
                try {
                    const data = await apiRequest(
                        "/get-involved/admin/feedback"
                    );
                    const container = document.getElementById("feedbackList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No feedback submissions found.</p>';
                        return;
                    }

                    data.forEach((feedback) => {
                        const el = createGetInvolvedElement(
                            feedback,
                            "feedback"
                        );
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load feedback:", error);
                    const container = document.getElementById("feedbackList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading feedback.</p>';
                    }
                }
            }

            async function loadIdeas() {
                try {
                    const data = await apiRequest("/get-involved/admin/ideas");
                    const container = document.getElementById("ideasList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No idea submissions found.</p>';
                        return;
                    }

                    data.forEach((idea) => {
                        const el = createGetInvolvedElement(idea, "ideas");
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load ideas:", error);
                    const container = document.getElementById("ideasList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading ideas.</p>';
                    }
                }
            }

            async function loadPartnerships() {
                try {
                    const data = await apiRequest(
                        "/get-involved/admin/partnerships"
                    );
                    const container =
                        document.getElementById("partnershipsList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No partnership inquiries found.</p>';
                        return;
                    }

                    data.forEach((partnership) => {
                        const el = createGetInvolvedElement(
                            partnership,
                            "partnerships"
                        );
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load partnerships:", error);
                    const container =
                        document.getElementById("partnershipsList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading partnerships.</p>';
                    }
                }
            }

            async function loadStories() {
                try {
                    const data = await apiRequest(
                        "/get-involved/admin/stories"
                    );
                    const container = document.getElementById("storiesList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No community stories found.</p>';
                        return;
                    }

                    data.forEach((story) => {
                        const el = createStoryElement(story);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load stories:", error);
                    const container = document.getElementById("storiesList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading stories.</p>';
                    }
                }
            }

            function createGetInvolvedElement(item, type) {
                const el = document.createElement("div");
                el.className = "submission-item";

                const header = document.createElement("div");
                header.className = "submission-header";

                const left = document.createElement("div");
                left.innerHTML = `
            <h4 style="margin: 0 0 0.5rem 0; color: var(--accent-light);">${
                item.full_name || "No name"
            }</h4>
            <p style="margin: 0; color: var(--text-muted);">${
                item.email || "No email"
            }</p>
        `;

                const right = document.createElement("div");

                // Add type-specific badges
                let badges = "";
                if (type === "donations" && item.amount) {
                    badges += `<span class="amount-badge">$${item.amount}</span>`;
                }
                if (type === "ideas" && item.priority) {
                    badges += `<span class="priority-badge priority-${item.priority}">${item.priority}</span>`;
                }

                right.innerHTML = `
            <span class="status-badge status-${item.status || "new"}">${
                    item.status || "new"
                }</span>
            ${badges}
            <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                ${
                    item.created_at
                        ? new Date(item.created_at).toLocaleDateString()
                        : "Unknown date"
                }
            </div>
        `;

                header.appendChild(left);
                header.appendChild(right);

                const meta = document.createElement("div");
                meta.className = "submission-meta";

                const statusSelect = document.createElement("select");
                statusSelect.innerHTML = getStatusOptions(type, item.status);
                statusSelect.onchange = async (e) => {
                    await updateGetInvolvedStatus(
                        type,
                        item.id,
                        e.target.value
                    );
                };

                const editBtn = document.createElement("button");
                editBtn.className = "btn-secondary";
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                editBtn.onclick = () => editGetInvolvedItem(item, type);

                const deleteBtn = document.createElement("button");
                deleteBtn.className = "btn-danger";
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Delete';
                deleteBtn.onclick = async () => {
                    if (confirm("Delete this submission?")) {
                        await deleteGetInvolvedSubmission(type, item.id);
                    }
                };

                meta.appendChild(statusSelect);
                meta.appendChild(editBtn);
                meta.appendChild(deleteBtn);

                const content = document.createElement("div");
                content.style.padding = "1rem";
                content.style.background = "rgba(255,255,255,0.03)";
                content.style.borderRadius = "8px";
                content.style.marginTop = "1rem";
                content.innerHTML = getSubmissionContent(item, type);

                el.appendChild(header);
                el.appendChild(meta);
                el.appendChild(content);
                return el;
            }

            function createStoryElement(story) {
                const el = document.createElement("div");
                el.className = `submission-item ${
                    story.is_featured ? "story-featured" : ""
                } ${story.is_published ? "story-published" : "story-draft"}`;

                const header = document.createElement("div");
                header.className = "submission-header";

                const left = document.createElement("div");
                left.innerHTML = `
            <h4 style="margin: 0 0 0.5rem 0; color: var(--accent-light);">${
                story.story_title
            }</h4>
            <p style="margin: 0; color: var(--text-muted);">By ${
                story.author_name
            }${story.author_title ? `, ${story.author_title}` : ""}</p>
        `;

                const right = document.createElement("div");
                right.innerHTML = `
            <span class="status-badge status-${story.status || "published"}">${
                    story.status || "published"
                }</span>
            ${
                story.is_featured
                    ? '<span class="priority-badge priority-high" style="margin-left: 0.5rem;">Featured</span>'
                    : ""
            }
            <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                ${
                    story.created_at
                        ? new Date(story.created_at).toLocaleDateString()
                        : "Unknown date"
                }
            </div>
        `;

                header.appendChild(left);
                header.appendChild(right);

                const meta = document.createElement("div");
                meta.className = "submission-meta";

                const statusSelect = document.createElement("select");
                statusSelect.innerHTML = getStatusOptions(
                    "stories",
                    story.status
                );
                statusSelect.onchange = async (e) => {
                    await updateGetInvolvedStatus(
                        "stories",
                        story.id,
                        e.target.value
                    );
                };

                // NEW CODE - FIX
                const editBtn = document.createElement("button");
                editBtn.className = "btn-secondary";
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                editBtn.onclick = () => editStory(story);

                const deleteBtn = document.createElement("button");
                deleteBtn.className = "btn-danger";
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Delete';
                deleteBtn.onclick = async () => {
                    if (confirm("Delete this story?")) {
                        await deleteGetInvolvedSubmission("stories", story.id);
                    }
                };

                meta.appendChild(statusSelect);
                meta.appendChild(editBtn);
                meta.appendChild(deleteBtn);

                const content = document.createElement("div");
                content.style.padding = "1rem";
                content.style.background = "rgba(255,255,255,0.03)";
                content.style.borderRadius = "8px";
                content.style.marginTop = "1rem";
                content.textContent =
                    story.story_content.substring(0, 200) +
                    (story.story_content.length > 200 ? "..." : "");

                el.appendChild(header);
                el.appendChild(meta);
                el.appendChild(content);
                return el;
            }

            function getStatusOptions(type, currentStatus) {
                const baseOptions = {
                    membership: `
                <option value="pending" ${
                    currentStatus === "pending" ? "selected" : ""
                }>Pending</option>
                <option value="approved" ${
                    currentStatus === "approved" ? "selected" : ""
                }>Approved</option>
                <option value="rejected" ${
                    currentStatus === "rejected" ? "selected" : ""
                }>Rejected</option>
                <option value="archived" ${
                    currentStatus === "archived" ? "selected" : ""
                }>Archived</option>
            `,
                    donations: `
                <option value="pending" ${
                    currentStatus === "pending" ? "selected" : ""
                }>Pending</option>
                <option value="verified" ${
                    currentStatus === "verified" ? "selected" : ""
                }>Verified</option>
                <option value="completed" ${
                    currentStatus === "completed" ? "selected" : ""
                }>Completed</option>
                <option value="archived" ${
                    currentStatus === "archived" ? "selected" : ""
                }>Archived</option>
            `,
                    feedback: `
                <option value="new" ${
                    currentStatus === "new" ? "selected" : ""
                }>New</option>
                <option value="read" ${
                    currentStatus === "read" ? "selected" : ""
                }>Read</option>
                <option value="replied" ${
                    currentStatus === "replied" ? "selected" : ""
                }>Replied</option>
                <option value="archived" ${
                    currentStatus === "archived" ? "selected" : ""
                }>Archived</option>
            `,
                    ideas: `
                <option value="under_review" ${
                    currentStatus === "under_review" ? "selected" : ""
                }>Under Review</option>
                <option value="approved" ${
                    currentStatus === "approved" ? "selected" : ""
                }>Approved</option>
                <option value="implemented" ${
                    currentStatus === "implemented" ? "selected" : ""
                }>Implemented</option>
                <option value="rejected" ${
                    currentStatus === "rejected" ? "selected" : ""
                }>Rejected</option>
                <option value="archived" ${
                    currentStatus === "archived" ? "selected" : ""
                }>Archived</option>
            `,
                    partnerships: `
                <option value="pending" ${
                    currentStatus === "pending" ? "selected" : ""
                }>Pending</option>
                <option value="under_review" ${
                    currentStatus === "under_review" ? "selected" : ""
                }>Under Review</option>
                <option value="approved" ${
                    currentStatus === "approved" ? "selected" : ""
                }>Approved</option>
                <option value="rejected" ${
                    currentStatus === "rejected" ? "selected" : ""
                }>Rejected</option>
                <option value="archived" ${
                    currentStatus === "archived" ? "selected" : ""
                }>Archived</option>
            `,
                    stories: `
                <option value="draft" ${
                    currentStatus === "draft" ? "selected" : ""
                }>Draft</option>
                <option value="published" ${
                    currentStatus === "published" ? "selected" : ""
                }>Published</option>
                <option value="archived" ${
                    currentStatus === "archived" ? "selected" : ""
                }>Archived</option>
            `,
                };

                return baseOptions[type] || baseOptions.feedback;
            }

            function getSubmissionContent(submission, type) {
                switch (type) {
                    case "membership":
                        return `
                    <p><strong>Type:</strong> ${submission.membership_type}</p>
                    <p><strong>Organization:</strong> ${
                        submission.organization || "Not specified"
                    }</p>
                    <p><strong>Position:</strong> ${
                        submission.position || "Not specified"
                    }</p>
                    ${
                        submission.message
                            ? `<p><strong>Message:</strong> ${submission.message}</p>`
                            : ""
                    }
                `;
                    case "donations":
                        return `
                    <p><strong>Amount:</strong> $${submission.amount} ${
                            submission.currency
                        }</p>
                    <p><strong>Payment Method:</strong> ${
                        submission.payment_method
                    }</p>
                    ${
                        submission.bank_name
                            ? `<p><strong>Bank:</strong> ${submission.bank_name}</p>`
                            : ""
                    }
                    ${
                        submission.mtn_mobile_number
                            ? `<p><strong>MTN Number:</strong> ${submission.mtn_mobile_number}</p>`
                            : ""
                    }
                `;
                    case "feedback":
                        return `
                    <p><strong>Category:</strong> ${submission.category}</p>
                    ${
                        submission.subject
                            ? `<p><strong>Subject:</strong> ${submission.subject}</p>`
                            : ""
                    }
                    <p><strong>Message:</strong> ${submission.message}</p>
                    ${
                        submission.rating
                            ? `<p><strong>Rating:</strong> ${"".repeat(
                                  submission.rating
                              )}${"".repeat(5 - submission.rating)}</p>`
                            : ""
                    }
                `;
                    case "ideas":
                        return `
                    <p><strong>Title:</strong> ${submission.idea_title}</p>
                    <p><strong>Category:</strong> ${submission.category}</p>
                    <p><strong>Description:</strong> ${submission.description.substring(
                        0,
                        200
                    )}${submission.description.length > 200 ? "..." : ""}</p>
                    ${
                        submission.target_audience
                            ? `<p><strong>Target Audience:</strong> ${submission.target_audience}</p>`
                            : ""
                    }
                `;
                    case "partnerships":
                        return `
                    <p><strong>Organization:</strong> ${
                        submission.organization
                    }</p>
                    <p><strong>Partnership Type:</strong> ${
                        submission.partnership_type
                    }</p>
                    ${
                        submission.position
                            ? `<p><strong>Position:</strong> ${submission.position}</p>`
                            : ""
                    }
                    <p><strong>Proposal:</strong> ${
                        submission.proposal
                            ? submission.proposal.substring(0, 200) +
                              (submission.proposal.length > 200 ? "..." : "")
                            : "No proposal provided"
                    }</p>
                `;
                    default:
                        return "<p>No content available</p>";
                }
            }

            async function updateGetInvolvedStatus(type, id, status) {
                try {
                    await apiRequest(
                        `/get-involved/admin/${type}/${id}/status`,
                        {
                            method: "PUT",
                            body: JSON.stringify({ status }),
                        }
                    );
                    // Reload the current tab
                    showGetInvolvedTab(currentGetInvolvedTab);
                } catch (error) {
                    console.error("Failed to update status:", error);
                    alert("Failed to update status: " + error.message);
                }
            }

            async function deleteGetInvolvedSubmission(type, id) {
                try {
                    await apiRequest(`/get-involved/admin/${type}/${id}`, {
                        method: "DELETE",
                    });
                    // Reload the current tab
                    showGetInvolvedTab(currentGetInvolvedTab);
                } catch (error) {
                    console.error("Failed to delete submission:", error);
                    alert("Failed to delete submission: " + error.message);
                }
            }

            function editGetInvolvedItem(item, type) {
                alert(`Edit ${type} functionality coming soon!`);
                // TODO: Implement specific edit modals for each type
            }

            // ===== ENHANCED TAB MANAGEMENT =====

            function initializeTabs() {
                // Get Involved Tabs
                document
                    .querySelectorAll(".get-involved-tab[data-tab]")
                    .forEach((tab) => {
                        tab.addEventListener("click", (e) => {
                            e.preventDefault();
                            const tabName = tab.getAttribute("data-tab");
                            if (tabName.startsWith("design-")) {
                                showDesignTab(tabName);
                            } else if (tabName.startsWith("research-")) {
                                showResearchTab(tabName);
                            } else if (tabName.startsWith("colleagues-")) {
                                showColleaguesTab(tabName);
                            } else if (tabName.startsWith("newsevents-")) {
                                showNewsEventsTab(tabName);
                            } else if (
                                [
                                    "photos",
                                    "videos",
                                    "designs",
                                    "testimonials",
                                ].includes(tabName)
                            ) {
                                showMediaTab(tabName);
                            } else if (
                                [
                                    "workshops",
                                    "tutorials",
                                    "exhibitions",
                                ].includes(tabName)
                            ) {
                                showEducationTab(tabName);
                            } else {
                                showGetInvolvedTab(tabName);
                            }
                        });
                    });

                // Photo Category Filter
                document
                    .querySelectorAll(".filter-btn[data-category]")
                    .forEach((btn) => {
                        btn.addEventListener("click", () => {
                            const category = btn.getAttribute("data-category");
                            currentPhotoCategory = category;

                            document
                                .querySelectorAll(".filter-btn")
                                .forEach((b) => {
                                    b.classList.remove("active");
                                });
                            btn.classList.add("active");

                            filterPhotosByCategory(category);
                        });
                    });
            }

            function showGetInvolvedTab(tabName) {
                hideAllTabs();
                showTab(tabName, "get-involved");
                currentGetInvolvedTab = tabName;

                switch (tabName) {
                    case "membership":
                        loadMembershipApplications();
                        break;
                    case "donations":
                        loadDonations();
                        break;
                    case "feedback":
                        loadFeedback();
                        break;
                    case "ideas":
                        loadIdeas();
                        break;
                    case "partnerships":
                        loadPartnerships();
                        break;
                    case "stories":
                        loadStories();
                        break;
                }
            }

            function showMediaTab(tabName) {
                hideAllTabs();
                showTab(tabName, "media");
                currentMediaTab = tabName;

                switch (tabName) {
                    case "photos":
                        loadPhotos();
                        break;
                    case "videos":
                        loadVideos();
                        break;
                    case "designs":
                        loadDesigns();
                        break;
                    case "testimonials":
                        loadTestimonials();
                        break;
                }
            }

            function showEducationTab(tabName) {
                hideAllTabs();
                showTab(tabName, "education");
                currentEducationTab = tabName;

                switch (tabName) {
                    case "workshops":
                        loadWorkshops();
                        break;
                    case "tutorials":
                        loadTutorials();
                        break;
                    case "exhibitions":
                        loadExhibitions();
                        break;
                }
            }

            function showDesignTab(tabName) {
                hideAllTabs();
                showTab(tabName, "design");
                currentDesignTab = tabName;

                switch (tabName) {
                    case "design-all":
                        loadDesignProjects();
                        break;
                    case "design-academic":
                        loadAcademicProjects();
                        break;
                    case "design-professional":
                        loadProfessionalProjects();
                        break;
                    case "design-competition":
                        loadCompetitionProjects();
                        break;
                }
            }

            function showResearchTab(tabName) {
                hideAllTabs();
                showTab(tabName, "research");
                currentResearchTab = tabName;

                switch (tabName) {
                    case "research-all":
                        loadResearchArticles();
                        break;
                    case "research-sustainable":
                        loadSustainableResearch();
                        break;
                    case "research-climate":
                        loadClimateResearch();
                        break;
                    case "research-social":
                        loadSocialResearch();
                        break;
                    case "research-technological":
                        loadTechnologicalResearch();
                        break;
                }
            }

            function showNewsEventsTab(tabName) {
                hideAllTabs();
                showTab(tabName, "newsevents");
                currentNewsEventsTab = tabName;

                switch (tabName) {
                    case "newsevents-all":
                        loadAllNewsEvents();
                        break;
                    case "newsevents-news":
                        loadNewsArticles();
                        break;
                    case "newsevents-events":
                        loadEvents();
                        break;
                }
            }

            function showColleaguesTab(tabName) {
                hideAllTabs();
                showTab(tabName, "colleagues");
                currentColleaguesTab = tabName;

                switch (tabName) {
                    case "colleagues-contacts":
                        loadColleaguesContacts();
                        break;
                    case "colleagues-team":
                        loadTeamMembers();
                        break;
                    case "colleagues-initiatives":
                        loadInitiatives();
                        break;
                }
            }

            function hideAllTabs() {
                document
                    .querySelectorAll(".get-involved-content")
                    .forEach((content) => {
                        content.classList.remove("active");
                    });
                document
                    .querySelectorAll(".get-involved-tab")
                    .forEach((tab) => {
                        tab.classList.remove("active");
                    });
            }

            function showTab(tabName, prefix = "") {
                const contentId = prefix ? `${tabName}Tab` : tabName;
                const tabSelector = `[data-tab="${tabName}"]`;

                const contentElement = document.getElementById(contentId);
                const tabElement = document.querySelector(tabSelector);

                if (contentElement) contentElement.classList.add("active");
                if (tabElement) tabElement.classList.add("active");
            }

            // ===== ENHANCED EVENT LISTENERS =====

            function initializeEventListeners() {
                // Mobile menu
                if (mobileMenuBtn) {
                    mobileMenuBtn.addEventListener("click", () => {
                        sidebar.classList.add("open");
                        if (overlay) overlay.classList.add("active");
                    });
                }

                if (overlay) {
                    overlay.addEventListener("click", () => {
                        sidebar.classList.remove("open");
                        overlay.classList.remove("active");
                    });
                }

                // Login button
                const loginBtn = document.getElementById("loginBtn");
                if (loginBtn) {
                    loginBtn.addEventListener("click", handleLogin);
                }

                // Logout button
                const logoutBtn = document.getElementById("logoutBtn");
                if (logoutBtn) {
                    logoutBtn.addEventListener("click", () => {
                        clearAuthData();
                        showLogin();
                    });
                }

                // Refresh buttons
                const refreshButtons = {
                    refreshSubmissions: loadContactSubmissions,
                    refreshGetInvolved: () =>
                        showGetInvolvedTab(currentGetInvolvedTab),
                    refreshMedia: () => {
                        loadMediaStats();
                        showMediaTab(currentMediaTab);
                    },
                    refreshEducation: () => {
                        loadEducationStats();
                        showEducationTab(currentEducationTab);
                    },
                    refreshDesign: () => {
                        loadDesignStats();
                        showDesignTab(currentDesignTab);
                    },
                    refreshNewsEvents: () => {
                        loadNewsEventsStats();
                        showNewsEventsTab(currentNewsEventsTab);
                    },
                    refreshResearch: () => {
                        loadResearchStats();
                        showResearchTab(currentResearchTab);
                    },
                    refreshColleagues: () => {
                        loadColleaguesStats();
                        showColleaguesTab(currentColleaguesTab);
                    },
                };

                Object.entries(refreshButtons).forEach(([id, handler]) => {
                    const button = document.getElementById(id);
                    if (button) {
                        button.addEventListener("click", handler);
                    }
                });

                // Initialize tabs
                initializeTabs();
                initializeNavigation();
            }

            // ===== DATA LOADING FUNCTIONS FOR OTHER SECTIONS =====

            // Media Library
            async function loadPhotos() {
                try {
                    const data = await apiRequest("/media/photos");
                    const container = document.getElementById("photosList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No photos found.</p>';
                        return;
                    }

                    data.forEach((photo) => {
                        const el = createMediaElement(photo, "photos");
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load photos:", error);
                    const container = document.getElementById("photosList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading photos.</p>';
                    }
                }
            }

            async function loadVideos() {
                try {
                    const data = await apiRequest("/media/videos");
                    const container = document.getElementById("videosList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No videos found.</p>';
                        return;
                    }

                    data.forEach((video) => {
                        const el = createMediaElement(video, "videos");
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load videos:", error);
                    const container = document.getElementById("videosList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading videos.</p>';
                    }
                }
            }

            async function loadDesigns() {
                try {
                    const data = await apiRequest("/media/designs");
                    const container = document.getElementById("designsList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No designs found.</p>';
                        return;
                    }

                    data.forEach((design) => {
                        const el = createMediaElement(design, "designs");
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load designs:", error);
                    const container = document.getElementById("designsList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading designs.</p>';
                    }
                }
            }

            async function loadTestimonials() {
                try {
                    const data = await apiRequest("/media/testimonials");
                    const container =
                        document.getElementById("testimonialsList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No testimonials found.</p>';
                        return;
                    }

                    data.forEach((testimonial) => {
                        const el = createTestimonialElement(testimonial);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load testimonials:", error);
                    const container =
                        document.getElementById("testimonialsList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading testimonials.</p>';
                    }
                }
            }

            // Education load functions
            async function loadWorkshops() {
                try {
                    const data = await apiRequest("/education/admin/workshops");
                    const container = document.getElementById("workshopsList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No workshops found.</p>';
                        return;
                    }

                    data.forEach((workshop) => {
                        const el = createEducationElement(workshop, "workshop");
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load workshops:", error);
                    const container = document.getElementById("workshopsList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading workshops.</p>';
                    }
                }
            }

            async function loadTutorials() {
                try {
                    const data = await apiRequest("/education/tutorials");
                    const container = document.getElementById("tutorialsList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No tutorials found.</p>';
                        return;
                    }

                    data.forEach((tutorial) => {
                        const el = createEducationElement(tutorial, "tutorial");
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load tutorials:", error);
                    const container = document.getElementById("tutorialsList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading tutorials.</p>';
                    }
                }
            }

            async function loadExhibitions() {
                try {
                    const data = await apiRequest("/education/exhibitions");
                    const container =
                        document.getElementById("exhibitionsList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No exhibitions found.</p>';
                        return;
                    }

                    data.forEach((exhibition) => {
                        const el = createEducationElement(
                            exhibition,
                            "exhibition"
                        );
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load exhibitions:", error);
                    const container =
                        document.getElementById("exhibitionsList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading exhibitions.</p>';
                    }
                }
            }

            function createEducationElement(item, type) {
                const el = document.createElement("div");
                el.className = "item";

                const content = document.createElement("div");
                content.className = "item-content";

                const title = document.createElement("h4");
                title.className = "item-title";
                title.textContent = item.title;

                const meta = document.createElement("div");
                meta.className = "item-meta";

                const typeLabel = document.createElement("span");
                typeLabel.className = "item-type";
                typeLabel.textContent =
                    type.charAt(0).toUpperCase() + type.slice(1);

                const dateInfo = document.createElement("span");
                dateInfo.className = "item-date";
                if (type === "workshop") {
                    dateInfo.textContent = item.date || "TBD";
                } else if (type === "exhibition") {
                    dateInfo.textContent = `${item.startDate || "TBD"} - ${
                        item.endDate || "TBD"
                    }`;
                } else {
                    dateInfo.textContent = item.duration || "N/A";
                }

                const status = document.createElement("span");
                status.className = "item-date";
                status.textContent = item.isPublished ? "Published" : "Draft";
                status.style.color = item.isPublished
                    ? "var(--success)"
                    : "var(--warning)";

                meta.appendChild(typeLabel);
                meta.appendChild(dateInfo);
                meta.appendChild(status);

                const preview = document.createElement("div");
                preview.className = "item-preview";
                preview.innerHTML =
                    item.description?.substring(0, 100) + "..." ||
                    "No description available";

                content.appendChild(title);
                content.appendChild(meta);
                content.appendChild(preview);

                const actions = document.createElement("div");
                actions.className = "item-actions";

                const editBtn = document.createElement("button");
                editBtn.className = "btn-secondary";
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                editBtn.onclick = () => {
                    if (type === "workshop") editWorkshop(item);
                    else if (type === "tutorial") editTutorial(item);
                    else if (type === "exhibition") editExhibition(item);
                };

                const deleteBtn = document.createElement("button");
                deleteBtn.className = "btn-danger";
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Delete';
                deleteBtn.onclick = async () => {
                    if (
                        confirm(`Are you sure you want to delete this ${type}?`)
                    ) {
                        try {
                            await apiRequest(`/education/${type}s/${item.id}`, {
                                method: "DELETE",
                            });
                            if (type === "workshop") await loadWorkshops();
                            else if (type === "tutorial") await loadTutorials();
                            else if (type === "exhibition")
                                await loadExhibitions();
                        } catch (error) {
                            console.error(`Failed to delete ${type}:`, error);
                            alert(`Failed to delete ${type}: ` + error.message);
                        }
                    }
                };

                actions.appendChild(editBtn);
                actions.appendChild(deleteBtn);
                content.appendChild(actions);

                el.appendChild(content);
                return el;
            }

            function createMediaElement(item, type) {
                const el = document.createElement("div");
                el.className = "item";

                const content = document.createElement("div");
                content.className = "item-content";

                const title = document.createElement("h4");
                title.className = "item-title";
                title.textContent = item.title;

                const meta = document.createElement("div");
                meta.className = "item-meta";

                const category = document.createElement("span");
                category.className = "item-type";
                category.textContent = item.category || type;

                const date = document.createElement("span");
                date.className = "item-date";
                date.textContent = item.created_at
                    ? new Date(item.created_at).toLocaleDateString()
                    : "Unknown date";

                meta.appendChild(category);
                meta.appendChild(date);

                const preview = document.createElement("div");
                preview.className = "item-preview";
                preview.innerHTML =
                    item.description || "No description available";

                content.appendChild(title);
                content.appendChild(meta);
                content.appendChild(preview);

                const actions = document.createElement("div");
                actions.className = "item-actions";

                const featuredBtn = document.createElement("button");
                featuredBtn.className = item.is_featured
                    ? "btn-primary"
                    : "btn-secondary";
                featuredBtn.innerHTML = `<i class="fas ${
                    item.is_featured ? "fa-star" : "fa-star"
                }"></i> ${item.is_featured ? "Featured" : "Feature"}`;
                featuredBtn.onclick = async () => {
                    await toggleFeatured(
                        "media",
                        type,
                        item.id,
                        !item.is_featured
                    );
                };

                // NEW CODE - FIX
                const editBtn = document.createElement("button");
                editBtn.className = "btn-secondary";
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                editBtn.onclick = () => {
                    switch (type) {
                        case "photos":
                            editPhoto(item);
                            break;
                        case "videos":
                            editVideo(item);
                            break;
                        case "designs":
                            editDesign(item);
                            break;
                        case "testimonials":
                            editTestimonial(item);
                            break;
                        default:
                            alert(`Edit ${type} functionality coming soon!`);
                    }
                };

                const del = document.createElement("button");
                del.className = "btn-danger";
                del.innerHTML = '<i class="fas fa-trash"></i> Delete';
                del.onclick = async () => {
                    if (confirm("Are you sure you want to delete this item?")) {
                        await deleteMediaItem(type, item.id);
                    }
                };

                actions.appendChild(featuredBtn);
                actions.appendChild(editBtn);
                actions.appendChild(del);
                content.appendChild(actions);

                // Check for images using multiple possible field names
                const imageUrl =
                    item.image_url ||
                    item.image ||
                    item.thumbnail_url ||
                    item.thumbnail;

                if (imageUrl) {
                    const imgContainer = document.createElement("div");
                    imgContainer.style.marginLeft = "1rem";
                    imgContainer.style.flexShrink = "0";

                    const img = document.createElement("img");
                    img.src = imageUrl;
                    img.alt = item.title;
                    img.style.width = "100px";
                    img.style.height = "80px";
                    img.style.objectFit = "cover";
                    img.style.borderRadius = "6px";
                    img.style.border = "1px solid var(--border-light)";

                    imgContainer.appendChild(img);
                    el.appendChild(imgContainer);
                }

                el.appendChild(content);
                return el;
            }

            function createTestimonialElement(testimonial) {
                const el = document.createElement("div");
                el.className = "submission-item";

                const stars = testimonial.rating
                    ? "".repeat(testimonial.rating) +
                      "".repeat(5 - testimonial.rating)
                    : "";

                el.innerHTML = `
            <div class="submission-header">
                <div>
                    <h4 style="margin: 0 0 0.5rem 0; color: var(--accent-light);">${
                        testimonial.name
                    }</h4>
                    <p style="margin: 0; color: var(--text-muted);">${
                        testimonial.role
                    }${
                    testimonial.organization
                        ? ` at ${testimonial.organization}`
                        : ""
                }</p>
                </div>
                <div>
                    <span class="status-badge status-${
                        testimonial.status || "published"
                    }">${testimonial.status || "published"}</span>
                    ${
                        testimonial.is_featured
                            ? '<span class="priority-badge priority-high" style="margin-left: 0.5rem;">Featured</span>'
                            : ""
                    }
                    <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                        ${
                            testimonial.created_at
                                ? new Date(
                                      testimonial.created_at
                                  ).toLocaleDateString()
                                : "Unknown date"
                        }
                    </div>
                </div>
            </div>
            ${stars ? `<div class="testimonial-rating">${stars}</div>` : ""}
            <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 8px; margin-top: 1rem;">
                <p style="margin: 0; font-style: italic;">"${
                    testimonial.quote
                }"</p>
                ${
                    testimonial.project
                        ? `<p style="margin: 0.5rem 0 0 0; color: var(--text-muted); font-size: 0.9rem;">Project: ${testimonial.project}</p>`
                        : ""
                }
            </div>
            <div class="submission-meta">
                <select onchange="updateTestimonialStatus(${
                    testimonial.id
                }, this.value)">
                    <option value="published" ${
                        testimonial.status === "published" ? "selected" : ""
                    }>Published</option>
                    <option value="draft" ${
                        testimonial.status === "draft" ? "selected" : ""
                    }>Draft</option>
                    <option value="archived" ${
                        testimonial.status === "archived" ? "selected" : ""
                    }>Archived</option>
                </select>
                // NEW CODE - FIX
<button class="btn-secondary" onclick="editTestimonial(${testimonial})">
                    <i class="fas ${
                        testimonial.is_featured ? "fa-star" : "fa-star"
                    }"></i> ${testimonial.is_featured ? "Unfeature" : "Feature"}
                </button>
                <button class="btn-danger" onclick="deleteMediaItem('testimonials', ${
                    testimonial.id
                })">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </div>
        `;

                return el;
            }

            // Design Projects
            async function loadDesignProjects() {
                try {
                    const data = await apiRequest("/design/admin/projects");
                    const container =
                        document.getElementById("designProjectsList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data.data || data.data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No design projects found.</p>';
                        return;
                    }

                    data.data.forEach((project) => {
                        const el = createDesignProjectElement(project);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load design projects:", error);
                    const container =
                        document.getElementById("designProjectsList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading design projects.</p>';
                    }
                }
            }

            async function loadAcademicProjects() {
                try {
                    const data = await apiRequest(
                        "/design/admin/projects/academic"
                    );
                    const container = document.getElementById(
                        "academicProjectsList"
                    );
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data.data || data.data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No academic projects found.</p>';
                        return;
                    }

                    data.data.forEach((project) => {
                        const el = createDesignProjectElement(project);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load academic projects:", error);
                    const container = document.getElementById(
                        "academicProjectsList"
                    );
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading academic projects.</p>';
                    }
                }
            }

            async function loadProfessionalProjects() {
                try {
                    const data = await apiRequest(
                        "/design/admin/projects/professional"
                    );
                    const container = document.getElementById(
                        "professionalProjectsList"
                    );
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data.data || data.data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No professional projects found.</p>';
                        return;
                    }

                    data.data.forEach((project) => {
                        const el = createDesignProjectElement(project);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error(
                        "Failed to load professional projects:",
                        error
                    );
                    const container = document.getElementById(
                        "professionalProjectsList"
                    );
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading professional projects.</p>';
                    }
                }
            }

            async function loadCompetitionProjects() {
                try {
                    const data = await apiRequest(
                        "/design/admin/projects/competition"
                    );
                    const container = document.getElementById(
                        "competitionProjectsList"
                    );
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data.data || data.data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No competition projects found.</p>';
                        return;
                    }

                    data.data.forEach((project) => {
                        const el = createDesignProjectElement(project);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error(
                        "Failed to load competition projects:",
                        error
                    );
                    const container = document.getElementById(
                        "competitionProjectsList"
                    );
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading competition projects.</p>';
                    }
                }
            }

            function createDesignProjectElement(project) {
                const el = document.createElement("div");
                el.className = "item";
                el.setAttribute("data-sector", project.sector || "");

                const content = document.createElement("div");
                content.className = "item-content";

                const title = document.createElement("h4");
                title.className = "item-title";
                title.textContent = project.title;

                const meta = document.createElement("div");
                meta.className = "item-meta";

                const category = document.createElement("span");
                category.className = "item-type";
                category.textContent = project.category;

                const sector = document.createElement("span");
                sector.className = "sector-badge";
                sector.textContent =
                    sectorLabels[project.sector] ||
                    project.sector ||
                    "No Sector";

                const status = document.createElement("span");
                status.className = "item-date";
                status.textContent = project.is_published
                    ? "Published"
                    : "Draft";
                status.style.color = project.is_published
                    ? "var(--success)"
                    : "var(--warning)";

                meta.appendChild(category);
                meta.appendChild(sector);
                meta.appendChild(status);

                const preview = document.createElement("div");
                preview.className = "item-preview";
                preview.innerHTML = project.summary || "No summary available";

                // Add image preview if available
                if (project.main_image) {
                    const imgContainer = document.createElement("div");
                    imgContainer.style.marginLeft = "1rem";
                    imgContainer.style.flexShrink = "0";

                    const img = document.createElement("img");
                    img.src = project.main_image;
                    img.alt = project.title;
                    img.style.width = "100px";
                    img.style.height = "80px";
                    img.style.objectFit = "cover";
                    img.style.borderRadius = "6px";
                    img.style.border = "1px solid var(--border-light)";

                    imgContainer.appendChild(img);
                    el.appendChild(imgContainer);
                }

                content.appendChild(title);
                content.appendChild(meta);
                content.appendChild(preview);

                const actions = document.createElement("div");
                actions.className = "item-actions";

                const editBtn = document.createElement("button");
                editBtn.className = "btn-secondary";
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                editBtn.onclick = () => editDesignProject(project);

                const toggleBtn = document.createElement("button");
                toggleBtn.className = project.is_published
                    ? "btn-warning"
                    : "btn-primary";
                toggleBtn.innerHTML = `<i class="fas ${
                    project.is_published ? "fa-eye-slash" : "fa-eye"
                }"></i> ${project.is_published ? "Unpublish" : "Publish"}`;
                toggleBtn.onclick = async () => {
                    await toggleDesignProject(
                        project.id,
                        !project.is_published
                    );
                };

                const featuredBtn = document.createElement("button");
                featuredBtn.className = project.is_featured
                    ? "btn-warning"
                    : "btn-secondary";
                featuredBtn.innerHTML = `<i class="fas ${
                    project.is_featured ? "fa-star" : "fa-star"
                }"></i> ${project.is_featured ? "Unfeature" : "Feature"}`;
                featuredBtn.onclick = async () => {
                    await toggleFeaturedDesignProject(
                        project.id,
                        !project.is_featured
                    );
                };

                const del = document.createElement("button");
                del.className = "btn-danger";
                del.innerHTML = '<i class="fas fa-trash"></i> Delete';
                del.onclick = async () => {
                    if (
                        confirm(
                            "Are you sure you want to delete this design project?"
                        )
                    ) {
                        await deleteDesignProject(project.id);
                    }
                };

                actions.appendChild(editBtn);
                actions.appendChild(toggleBtn);
                actions.appendChild(featuredBtn);
                actions.appendChild(del);
                content.appendChild(actions);

                el.appendChild(content);
                return el;
            }

            // Research Insights
            async function loadResearchArticles() {
                try {
                    const data = await apiRequest("/research/admin/articles");
                    const container = document.getElementById(
                        "researchArticlesList"
                    );
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data.data || data.data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No research articles found.</p>';
                        return;
                    }

                    data.data.forEach((article) => {
                        const el = createResearchArticleElement(article);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load research articles:", error);
                    const container = document.getElementById(
                        "researchArticlesList"
                    );
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading research articles.</p>';
                    }
                }
            }

            async function loadSustainableResearch() {
                try {
                    const data = await apiRequest(
                        "/research/articles/sustainable"
                    );
                    const container = document.getElementById(
                        "sustainableResearchList"
                    );
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data.data || data.data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No sustainable design research found.</p>';
                        return;
                    }

                    data.data.forEach((article) => {
                        const el = createResearchArticleElement(article);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error(
                        "Failed to load sustainable research:",
                        error
                    );
                    const container = document.getElementById(
                        "sustainableResearchList"
                    );
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading sustainable research.</p>';
                    }
                }
            }

            async function loadClimateResearch() {
                try {
                    const data = await apiRequest("/research/articles/climate");
                    const container = document.getElementById(
                        "climateResearchList"
                    );
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data.data || data.data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No climate resilience research found.</p>';
                        return;
                    }

                    data.data.forEach((article) => {
                        const el = createResearchArticleElement(article);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load climate research:", error);
                    const container = document.getElementById(
                        "climateResearchList"
                    );
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading climate research.</p>';
                    }
                }
            }

            async function loadSocialResearch() {
                try {
                    const data = await apiRequest("/research/articles/social");
                    const container =
                        document.getElementById("socialResearchList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data.data || data.data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No social impact research found.</p>';
                        return;
                    }

                    data.data.forEach((article) => {
                        const el = createResearchArticleElement(article);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load social research:", error);
                    const container =
                        document.getElementById("socialResearchList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading social research.</p>';
                    }
                }
            }

            async function loadTechnologicalResearch() {
                try {
                    const data = await apiRequest(
                        "/research/articles/technological"
                    );
                    const container = document.getElementById(
                        "technologicalResearchList"
                    );
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data.data || data.data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No technological innovation research found.</p>';
                        return;
                    }

                    data.data.forEach((article) => {
                        const el = createResearchArticleElement(article);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error(
                        "Failed to load technological research:",
                        error
                    );
                    const container = document.getElementById(
                        "technologicalResearchList"
                    );
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading technological research.</p>';
                    }
                }
            }

            function createResearchArticleElement(article) {
                const el = document.createElement("div");
                el.className = "item";

                const content = document.createElement("div");
                content.className = "item-content";

                const title = document.createElement("h4");
                title.className = "item-title";
                title.textContent = article.title;

                const meta = document.createElement("div");
                meta.className = "item-meta";

                const category = document.createElement("span");
                category.className = "item-type";
                category.textContent = getCategoryDisplayName(article.category);

                const authors = document.createElement("span");
                authors.className = "item-date";
                authors.textContent = article.authors || "Unknown authors";

                meta.appendChild(category);
                meta.appendChild(authors);

                const preview = document.createElement("div");
                preview.className = "item-preview";
                preview.innerHTML =
                    article.abstract ||
                    article.content?.substring(0, 150) + "..." ||
                    "No abstract available";

                // Add publication date if available
                if (article.publication_date) {
                    const pubDate = document.createElement("div");
                    pubDate.className = "item-date";
                    pubDate.textContent = `Published: ${new Date(
                        article.publication_date
                    ).toLocaleDateString()}`;
                    meta.appendChild(pubDate);
                }

                // Add image preview if available
                if (article.main_image) {
                    const imgContainer = document.createElement("div");
                    imgContainer.style.marginLeft = "1rem";
                    imgContainer.style.flexShrink = "0";

                    const img = document.createElement("img");
                    img.src = article.main_image;
                    img.alt = article.title;
                    img.style.width = "100px";
                    img.style.height = "80px";
                    img.style.objectFit = "cover";
                    img.style.borderRadius = "6px";
                    img.style.border = "1px solid var(--border-light)";

                    imgContainer.appendChild(img);
                    el.appendChild(imgContainer);
                }

                content.appendChild(title);
                content.appendChild(meta);
                content.appendChild(preview);

                const actions = document.createElement("div");
                actions.className = "item-actions";

                const editBtn = document.createElement("button");
                editBtn.className = "btn-secondary";
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                editBtn.onclick = () => editResearchArticle(article);

                const toggleBtn = document.createElement("button");
                toggleBtn.className = article.is_published
                    ? "btn-warning"
                    : "btn-primary";
                toggleBtn.innerHTML = `<i class="fas ${
                    article.is_published ? "fa-eye-slash" : "fa-eye"
                }"></i> ${article.is_published ? "Unpublish" : "Publish"}`;
                toggleBtn.onclick = async () => {
                    await toggleResearchArticle(
                        article.id,
                        !article.is_published
                    );
                };

                const featuredBtn = document.createElement("button");
                featuredBtn.className = article.is_featured
                    ? "btn-warning"
                    : "btn-secondary";
                featuredBtn.innerHTML = `<i class="fas ${
                    article.is_featured ? "fa-star" : "fa-star"
                }"></i> ${article.is_featured ? "Unfeature" : "Feature"}`;
                featuredBtn.onclick = async () => {
                    await toggleFeaturedResearchArticle(
                        article.id,
                        !article.is_featured
                    );
                };

                const del = document.createElement("button");
                del.className = "btn-danger";
                del.innerHTML = '<i class="fas fa-trash"></i> Delete';
                del.onclick = async () => {
                    if (
                        confirm(
                            "Are you sure you want to delete this research article?"
                        )
                    ) {
                        await deleteResearchArticle(article.id);
                    }
                };

                actions.appendChild(editBtn);
                actions.appendChild(toggleBtn);
                actions.appendChild(featuredBtn);
                actions.appendChild(del);
                content.appendChild(actions);

                el.appendChild(content);
                return el;
            }

            function getCategoryDisplayName(category) {
                const categories = {
                    sustainable: "Sustainable Design",
                    climate: "Climate Resilience",
                    social: "Social Impact",
                    technological: "Technological Innovation",
                };
                return categories[category] || category;
            }

            // News & Events
            async function loadAllNewsEvents() {
                try {
                    const response = await apiRequest("/newsevents/all");
                    // Handle both {data: []} and direct array responses
                    const data = Array.isArray(response) ? response : (response.data || []);
                    
                    const container = document.getElementById("allNewsEventsList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No news or events found.</p>';
                        return;
                    }

                    data.forEach((item) => {
                        const el = createNewsEventElement(item);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load all news & events:", error);
                    const container =
                        document.getElementById("allNewsEventsList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading news and events.</p>';
                    }
                }
            }

            async function loadNewsArticles() {
                try {
                    const response = await apiRequest("/newsevents/news");
                    // Handle both {data: []} and direct array responses
                    const data = Array.isArray(response) ? response : (response.data || []);
                    
                    const container =
                        document.getElementById("newsArticlesList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No news articles found.</p>';
                        return;
                    }

                    data.forEach((article) => {
                        const el = createNewsEventElement(article);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load news articles:", error);
                    const container =
                        document.getElementById("newsArticlesList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading news articles.</p>';
                    }
                }
            }

            async function loadEvents() {
                try {
                    const response = await apiRequest("/newsevents/events");
                    // Handle both {data: []} and direct array responses
                    const data = Array.isArray(response) ? response : (response.data || []);
                    
                    const container = document.getElementById("eventsList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No events found.</p>';
                        return;
                    }

                    data.forEach((event) => {
                        const el = createNewsEventElement(event);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load events:", error);
                    const container = document.getElementById("eventsList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading events.</p>';
                    }
                }
            }

            function createNewsEventElement(item) {
                const el = document.createElement("div");
                el.className = "item";

                const content = document.createElement("div");
                content.className = "item-content";

                const title = document.createElement("h4");
                title.className = "item-title";
                title.textContent = item.title;

                const meta = document.createElement("div");
                meta.className = "item-meta";

                const type = document.createElement("span");
                type.className =
                    item.type === "news" ? "news-badge" : "event-badge";
                type.textContent = item.type === "news" ? "News" : "Event";

                const author = document.createElement("span");
                author.className = "item-type";
                author.textContent = `By ${item.author}`;

                const date = document.createElement("span");
                date.className = "item-date";
                date.textContent = new Date(item.date).toLocaleDateString();

                const status = document.createElement("span");
                status.className = "item-date";
                status.textContent = item.is_published ? "Published" : "Draft";
                status.style.color = item.is_published
                    ? "var(--success)"
                    : "var(--warning)";

                meta.appendChild(type);
                meta.appendChild(author);
                meta.appendChild(date);
                meta.appendChild(status);

                const preview = document.createElement("div");
                preview.className = "item-preview";
                preview.innerHTML =
                    item.excerpt || item.description || "No excerpt available";

                // Add date and location for events
                if (item.type === "event") {
                    const dateDisplay = document.createElement("div");
                    dateDisplay.className = "date-display";
                    dateDisplay.innerHTML = `<strong>Date:</strong> ${new Date(
                        item.eventDate
                    ).toLocaleDateString()}`;

                    const timeDisplay = document.createElement("div");
                    timeDisplay.className = "date-display";
                    timeDisplay.innerHTML = `<strong>Time:</strong> ${item.eventTime}`;

                    const locationDisplay = document.createElement("div");
                    locationDisplay.className = "location-display";
                    locationDisplay.innerHTML = `<strong>Location:</strong> ${item.location}`;

                    content.appendChild(dateDisplay);
                    content.appendChild(timeDisplay);
                    content.appendChild(locationDisplay);
                }

                // Add image preview if available
                if (item.image) {
                    const imgContainer = document.createElement("div");
                    imgContainer.style.marginLeft = "1rem";
                    imgContainer.style.flexShrink = "0";

                    const img = document.createElement("img");
                    img.src = item.image;
                    img.alt = item.title;
                    img.style.width = "100px";
                    img.style.height = "80px";
                    img.style.objectFit = "cover";
                    img.style.borderRadius = "6px";
                    img.style.border = "1px solid var(--border-light)";

                    imgContainer.appendChild(img);
                    el.appendChild(imgContainer);
                }

                content.appendChild(title);
                content.appendChild(meta);
                content.appendChild(preview);

                const actions = document.createElement("div");
                actions.className = "item-actions";

                const editBtn = document.createElement("button");
                editBtn.className = "btn-secondary";
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                editBtn.onclick = () => {
                    if (item.type === "news") {
                        editNewsEvent(item);
                    } else {
                        editEvent(item);
                    }
                };

                const toggleBtn = document.createElement("button");
                toggleBtn.className = item.is_published
                    ? "btn-warning"
                    : "btn-primary";
                toggleBtn.innerHTML = `<i class="fas ${
                    item.is_published ? "fa-eye-slash" : "fa-eye"
                }"></i> ${item.is_published ? "Unpublish" : "Publish"}`;
                toggleBtn.onclick = async () => {
                    await toggleNewsEvent(
                        item.id,
                        !item.is_published,
                        item.type
                    );
                };

                const featuredBtn = document.createElement("button");
                featuredBtn.className = item.is_featured
                    ? "btn-warning"
                    : "btn-secondary";
                featuredBtn.innerHTML = `<i class="fas ${
                    item.is_featured ? "fa-star" : "fa-star"
                }"></i> ${item.is_featured ? "Unfeature" : "Feature"}`;
                featuredBtn.onclick = async () => {
                    await toggleFeaturedNewsEvent(
                        item.id,
                        !item.is_featured,
                        item.type
                    );
                };

                const del = document.createElement("button");
                del.className = "btn-danger";
                del.innerHTML = '<i class="fas fa-trash"></i> Delete';
                del.onclick = async () => {
                    if (
                        confirm(
                            `Are you sure you want to delete this ${item.type}?`
                        )
                    ) {
                        await deleteNewsEvent(item.id, item.type);
                    }
                };

                actions.appendChild(editBtn);
                actions.appendChild(toggleBtn);
                actions.appendChild(featuredBtn);
                actions.appendChild(del);
                content.appendChild(actions);

                el.appendChild(content);
                return el;
            }

            // Architecture Colleagues
            async function loadColleaguesContacts() {
                try {
                    const response = await apiRequest(
                        "/thecolleagueuni/contacts"
                    );
                    const data = response.data || response; // Handle both response formats
                    const container = document.getElementById(
                        "colleaguesContactsList"
                    );
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No contact submissions found.</p>';
                        return;
                    }

                    data.forEach((contact) => {
                        const el = createContactElement(contact);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load colleagues contacts:", error);
                    const container = document.getElementById(
                        "colleaguesContactsList"
                    );
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading contacts.</p>';
                    }
                }
            }

            async function loadTeamMembers() {
                try {
                    const response = await apiRequest("/colleagues/admin/team");
                    const data = response.data || response; // Handle both response formats
                    const container =
                        document.getElementById("colleaguesTeamList");
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No team members found.</p>';
                        return;
                    }

                    data.forEach((member) => {
                        const el = createTeamMemberElement(member);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load team members:", error);
                    const container =
                        document.getElementById("colleaguesTeamList");
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading team members.</p>';
                    }
                }
            }

            async function loadInitiatives() {
                try {
                    const response = await apiRequest(
                        "/colleagues/initiatives"
                    );
                    const data = response.data || response; // Handle both response formats
                    const container = document.getElementById(
                        "colleaguesInitiativesList"
                    );
                    if (!container) return;

                    container.innerHTML = "";

                    if (!data || data.length === 0) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No initiatives found.</p>';
                        return;
                    }

                    data.forEach((initiative) => {
                        const el = createInitiativeElement(initiative);
                        container.appendChild(el);
                    });
                } catch (error) {
                    console.error("Failed to load initiatives:", error);
                    const container = document.getElementById(
                        "colleaguesInitiativesList"
                    );
                    if (container) {
                        container.innerHTML =
                            '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading initiatives.</p>';
                    }
                }
            }

            function createContactElement(contact) {
                const el = document.createElement("div");
                el.className = "submission-item";

                el.innerHTML = `
            <div class="submission-header">
                <div>
                    <h4 style="margin: 0 0 0.5rem 0; color: var(--accent-light);">${
                        contact.name
                    }</h4>
                    <p style="margin: 0; color: var(--text-muted);">${
                        contact.email
                    }</p>
                    ${
                        contact.organization
                            ? `<p style="margin: 0; color: var(--text-muted);">${contact.organization}</p>`
                            : ""
                    }
                </div>
                <div>
                    <span class="status-badge status-${
                        contact.status || "new"
                    }">${contact.status || "new"}</span>
                    <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                        ${
                            contact.created_at
                                ? new Date(
                                      contact.created_at
                                  ).toLocaleDateString()
                                : "Unknown date"
                        }
                    </div>
                </div>
            </div>
            <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 8px; margin-top: 1rem;">
                <p style="margin: 0;">${contact.message}</p>
            </div>
            <div class="submission-meta">
                <select onchange="updateColleaguesContactStatus(${
                    contact.id
                }, this.value)">
                    <option value="new" ${
                        contact.status === "new" ? "selected" : ""
                    }>New</option>
                    <option value="contacted" ${
                        contact.status === "contacted" ? "selected" : ""
                    }>Contacted</option>
                    <option value="responded" ${
                        contact.status === "responded" ? "selected" : ""
                    }>Responded</option>
                    <option value="archived" ${
                        contact.status === "archived" ? "selected" : ""
                    }>Archived</option>
                </select>
                <button class="btn-danger" onclick="deleteColleaguesContact(${
                    contact.id
                })">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </div>
        `;

                return el;
            }

            function createTeamMemberElement(member) {
                const el = document.createElement("div");
                el.className = "item";

                const content = document.createElement("div");
                content.className = "item-content";

                // Add profile image if available
                if (member.image_url) {
                    const imageContainer = document.createElement("div");
                    imageContainer.style.cssText = "margin-bottom: 1rem; text-align: center;";
                    
                    const img = document.createElement("img");
                    img.src = member.image_url;
                    img.alt = member.name;
                    img.style.cssText = "width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 3px solid var(--accent-light);";
                    img.onerror = function() {
                        this.style.display = 'none';
                    };
                    
                    imageContainer.appendChild(img);
                    content.appendChild(imageContainer);
                }

                const title = document.createElement("h4");
                title.className = "item-title";
                title.textContent = member.name;

                const meta = document.createElement("div");
                meta.className = "item-meta";

                const role = document.createElement("span");
                role.className = "item-type";
                role.textContent = member.role;

                const status = document.createElement("span");
                status.className = "item-date";
                status.textContent = member.is_active ? "Active" : "Inactive";
                status.style.color = member.is_active
                    ? "var(--success)"
                    : "var(--warning)";

                meta.appendChild(role);
                meta.appendChild(status);

                const preview = document.createElement("div");
                preview.className = "item-preview";
                preview.innerHTML = member.bio || "No bio available";

                content.appendChild(title);
                content.appendChild(meta);
                content.appendChild(preview);

                const actions = document.createElement("div");
                actions.className = "item-actions";

                const editBtn = document.createElement("button");
                editBtn.className = "btn-secondary";
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                editBtn.onclick = () => editTeamMember(member);

                const toggleBtn = document.createElement("button");
                toggleBtn.className = member.is_active
                    ? "btn-warning"
                    : "btn-primary";
                toggleBtn.innerHTML = `<i class="fas ${
                    member.is_active ? "fa-user-slash" : "fa-user-check"
                }"></i> ${member.is_active ? "Deactivate" : "Activate"}`;
                toggleBtn.onclick = async () => {
                    await toggleTeamMember(member.id, !member.is_active);
                };

                const del = document.createElement("button");
                del.className = "btn-danger";
                del.innerHTML = '<i class="fas fa-trash"></i> Delete';
                del.onclick = async () => {
                    if (
                        confirm(
                            "Are you sure you want to delete this team member?"
                        )
                    ) {
                        await deleteTeamMember(member.id);
                    }
                };

                actions.appendChild(editBtn);
                actions.appendChild(toggleBtn);
                actions.appendChild(del);
                content.appendChild(actions);

                if (member.image_url) {
                    const imgContainer = document.createElement("div");
                    imgContainer.style.marginLeft = "1rem";
                    imgContainer.style.flexShrink = "0";

                    const img = document.createElement("img");
                    img.src = member.image_url;
                    img.alt = member.name;
                    img.style.width = "100px";
                    img.style.height = "80px";
                    img.style.objectFit = "cover";
                    img.style.borderRadius = "6px";
                    img.style.border = "1px solid var(--border-light)";

                    imgContainer.appendChild(img);
                    el.appendChild(imgContainer);
                }

                el.appendChild(content);
                return el;
            }

            function createInitiativeElement(initiative) {
                const el = document.createElement("div");
                el.className = "item";

                const content = document.createElement("div");
                content.className = "item-content";

                const title = document.createElement("h4");
                title.className = "item-title";
                title.textContent = initiative.title;

                const meta = document.createElement("div");
                meta.className = "item-meta";

                const status = document.createElement("span");
                status.className = "item-type";
                status.textContent = initiative.status;
                status.style.color = getStatusColor(initiative.status);

                const date = document.createElement("span");
                date.className = "item-date";
                date.textContent = initiative.target_date
                    ? new Date(initiative.target_date).toLocaleDateString()
                    : "No target date";

                meta.appendChild(status);
                meta.appendChild(date);

                const preview = document.createElement("div");
                preview.className = "item-preview";
                preview.innerHTML =
                    initiative.description || "No description available";

                content.appendChild(title);
                content.appendChild(meta);
                content.appendChild(preview);

                const actions = document.createElement("div");
                actions.className = "item-actions";

                const editBtn = document.createElement("button");
                editBtn.className = "btn-secondary";
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                editBtn.onclick = () => editInitiative(initiative);

                const toggleBtn = document.createElement("button");
                toggleBtn.className = initiative.is_active
                    ? "btn-warning"
                    : "btn-primary";
                toggleBtn.innerHTML = `<i class="fas ${
                    initiative.is_active ? "fa-pause" : "fa-play"
                }"></i> ${initiative.is_active ? "Pause" : "Activate"}`;
                toggleBtn.onclick = async () => {
                    await toggleInitiative(
                        initiative.id,
                        !initiative.is_active
                    );
                };

                const del = document.createElement("button");
                del.className = "btn-danger";
                del.innerHTML = '<i class="fas fa-trash"></i> Delete';
                del.onclick = async () => {
                    if (
                        confirm(
                            "Are you sure you want to delete this initiative?"
                        )
                    ) {
                        await deleteInitiative(initiative.id);
                    }
                };

                actions.appendChild(editBtn);
                actions.appendChild(toggleBtn);
                actions.appendChild(del);
                content.appendChild(actions);

                el.appendChild(content);
                return el;
            }

            function getStatusColor(status) {
                const colors = {
                    planned: "var(--info)",
                    in_progress: "var(--warning)",
                    completed: "var(--success)",
                    on_hold: "var(--danger)",
                };
                return colors[status] || "var(--text-muted)";
            }

            // ===== STATS LOADING FUNCTIONS =====

            async function loadMediaStats() {
                try {
                    const stats = await apiRequest("/media/stats");
                    mediaStats = stats;

                    document.getElementById("photosCount").textContent =
                        stats.photos || 0;
                    document.getElementById("videosCount").textContent =
                        stats.videos || 0;
                    document.getElementById("designsCount").textContent =
                        stats.designs || 0;
                    document.getElementById("testimonialsCount").textContent =
                        stats.testimonials || 0;
                } catch (error) {
                    console.error("Failed to load media stats:", error);
                }
            }

            async function loadEducationStats() {
                try {
                    const stats = await apiRequest("/education/stats");
                    educationStats = stats;

                    document.getElementById("workshopsCount").textContent =
                        stats.workshops || 0;
                    document.getElementById("tutorialsCount").textContent =
                        stats.tutorials || 0;
                    document.getElementById("exhibitionsCount").textContent =
                        stats.exhibitions || 0;
                    document.getElementById("totalEnrolled").textContent =
                        stats.totalEnrolled || 0;

                    // Update dashboard stats
                    document.getElementById("workshopCount").textContent =
                        stats.workshops || 0;
                    document.getElementById("tutorialCount").textContent =
                        stats.tutorials || 0;
                } catch (error) {
                    console.error("Failed to load education stats:", error);
                }
            }

            async function loadDesignStats() {
                try {
                    const data = await apiRequest("/design/admin/stats");
                    designStats.total = data.data.total || 0;
                    designStats.academic = data.data.academic || 0;
                    designStats.professional = data.data.professional || 0;
                    designStats.competition = data.data.competition || 0;
                    designStats.featured = data.data.featured || 0;

                    // Update dashboard stats
                    document.getElementById("designProjectsCount").textContent =
                        designStats.total;
                    document.getElementById("designTotalProjects").textContent =
                        designStats.total;
                    document.getElementById(
                        "designAcademicProjects"
                    ).textContent = designStats.academic;
                    document.getElementById(
                        "designProfessionalProjects"
                    ).textContent = designStats.professional;
                    document.getElementById(
                        "designCompetitionProjects"
                    ).textContent = designStats.competition;
                } catch (error) {
                    console.error("Failed to load design stats:", error);
                }
            }

            async function loadResearchStats() {
                try {
                    const data = await apiRequest("/research/admin/stats");
                    researchStats.articles = data.data.total || 0;
                    researchStats.sustainable = data.data.sustainable || 0;
                    researchStats.climate = data.data.climate || 0;
                    researchStats.social = data.data.social || 0;
                    researchStats.technological = data.data.technological || 0;
                    researchStats.featured = data.data.featured || 0;

                    // Update dashboard stats
                    document.getElementById(
                        "researchArticlesCount"
                    ).textContent = researchStats.articles;
                    document.getElementById(
                        "researchTotalArticles"
                    ).textContent = researchStats.articles;
                    document.getElementById("researchSustainable").textContent =
                        researchStats.sustainable;
                    document.getElementById("researchClimate").textContent =
                        researchStats.climate;
                    document.getElementById("researchSocial").textContent =
                        researchStats.social;
                    document.getElementById("researchFeatured").textContent =
                        researchStats.featured;
                } catch (error) {
                    console.error("Failed to load research stats:", error);
                }
            }

            async function loadNewsEventsStats() {
                try {
                    const data = await apiRequest("/newsevents/health");
                    newsEventsStats.news = data.counts?.news || 0;
                    newsEventsStats.events = data.counts?.events || 0;

                    // For featured counts, we'd need to load actual data and filter
                    // For now, we'll set placeholder values
                    newsEventsStats.featuredNews = 0;
                    newsEventsStats.featuredEvents = 0;

                    // Update dashboard stats
                    document.getElementById("newsCount").textContent =
                        newsEventsStats.news;
                    document.getElementById("eventsCount").textContent =
                        newsEventsStats.events;

                    // Update news & events section stats
                    document.getElementById("newsTotal").textContent =
                        newsEventsStats.news;
                    document.getElementById("eventsTotal").textContent =
                        newsEventsStats.events;
                    document.getElementById("newsFeatured").textContent =
                        newsEventsStats.featuredNews;
                    document.getElementById("eventsFeatured").textContent =
                        newsEventsStats.featuredEvents;
                } catch (error) {
                    console.error("Failed to load news & events stats:", error);
                }
            }

            async function loadColleaguesStats() {
                try {
                    const stats = await apiRequest("/colleagues/stats");
                    colleaguesStats.contacts = stats.contacts || 0;
                    colleaguesStats.team = stats.team || 0;
                    colleaguesStats.initiatives = stats.initiatives || 0;
                    colleaguesStats.newContacts = stats.newContacts || 0;

                    // Update stats display
                    document.getElementById(
                        "colleaguesTotalContacts"
                    ).textContent = colleaguesStats.contacts;
                    document.getElementById(
                        "colleaguesTeamMembers"
                    ).textContent = colleaguesStats.team;
                    document.getElementById(
                        "colleaguesInitiatives"
                    ).textContent = colleaguesStats.initiatives;
                    document.getElementById(
                        "colleaguesNewContacts"
                    ).textContent = colleaguesStats.newContacts;
                    document.getElementById(
                        "colleaguesContactCount"
                    ).textContent = colleaguesStats.contacts;
                } catch (error) {
                    console.error("Failed to load colleagues stats:", error);
                    colleaguesStats = {
                        contacts: 0,
                        team: 0,
                        initiatives: 0,
                        newContacts: 0,
                    };
                }
            }

            // ===== FILTER FUNCTIONS =====

            function filterPhotosByCategory(category) {
                const container = document.getElementById("photosList");
                if (!container) return;

                const items = container.querySelectorAll(".item");
                items.forEach((item) => {
                    const typeElement = item.querySelector(".item-type");
                    if (typeElement) {
                        const itemCategory = typeElement.textContent;
                        if (category === "All" || itemCategory === category) {
                            item.style.display = "flex";
                        } else {
                            item.style.display = "none";
                        }
                    }
                });
            }

            function filterDesignProjectsBySector() {
                const sector = document.getElementById("sectorFilter")?.value;
                filterProjectsBySector("designProjectsList", sector);
            }

            function filterAcademicProjectsBySector() {
                const sector = document.getElementById(
                    "academicSectorFilter"
                )?.value;
                filterProjectsBySector("academicProjectsList", sector);
            }

            function filterProfessionalProjectsBySector() {
                const sector = document.getElementById(
                    "professionalSectorFilter"
                )?.value;
                filterProjectsBySector("professionalProjectsList", sector);
            }

            function filterCompetitionProjectsBySector() {
                const sector = document.getElementById(
                    "competitionSectorFilter"
                )?.value;
                filterProjectsBySector("competitionProjectsList", sector);
            }

            function filterProjectsBySector(containerId, sector) {
                const container = document.getElementById(containerId);
                if (!container) return;

                const projects = container.querySelectorAll(".item");
                projects.forEach((project) => {
                    const projectSector = project.getAttribute("data-sector");
                    if (!sector || projectSector === sector) {
                        project.style.display = "flex";
                    } else {
                        project.style.display = "none";
                    }
                });
            }

            // ===== MODAL FUNCTIONS =====

            // Base Modal Functions
            function showModal(modalId) {
                const modal = document.getElementById(modalId);
                const overlay = document.getElementById("overlay");
                if (modal) {
                    modal.classList.remove("hidden");
                    modal.style.zIndex = 1101;
                }
                if (overlay) overlay.classList.add("active");
            }

            function hideModal(modalId) {
                const modal = document.getElementById(modalId);
                const overlay = document.getElementById("overlay");
                if (modal) modal.classList.add("hidden");
                if (overlay) overlay.classList.remove("active");
            }

            // Modal Show/Hide Functions
            function showAddNewsModal() {
                showModal("addNewsModal");
            }
            function hideAddNewsModal() {
                hideModal("addNewsModal");
            }
            function showAddEventModal() {
                showModal("addEventModal");
            }
            function hideAddEventModal() {
                hideModal("addEventModal");
            }
            function showAddDesignProjectModal(category = null) {
                if (category) {
                    document.getElementById("addDesignProjectCategory").value =
                        category;
                }
                showModal("addDesignProjectModal");
            }
            // ===== CONTENT BUILDER FUNCTIONS =====
            let contentBlockCounter = 0;
            const contentBlocks = [];

            function addContentBlock(type) {
                const container = document.getElementById(
                    "contentBlocksContainer"
                );
                const emptyMessage = document.getElementById(
                    "emptyContentMessage"
                );

                if (emptyMessage) {
                    emptyMessage.style.display = "none";
                }

                const blockId = `content-block-${contentBlockCounter++}`;
                const blockDiv = document.createElement("div");
                blockDiv.id = blockId;
                blockDiv.className = "content-block";
                blockDiv.style.cssText =
                    "border: 1px solid var(--border-light); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; background: var(--bg-card);";

                if (type === "text") {
                    blockDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <h4 style="margin: 0; color: var(--accent-light);"><i class="fas fa-heading"></i> Text Block</h4>
                            <div style="display: flex; gap: 0.5rem;">
                                <button type="button" onclick="moveBlockUp('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem;">
                                    <i class="fas fa-arrow-up"></i>
                                </button>
                                <button type="button" onclick="moveBlockDown('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem;">
                                    <i class="fas fa-arrow-down"></i>
                                </button>
                                <button type="button" onclick="removeContentBlock('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem; background: var(--danger);">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <input type="text" placeholder="Title (optional)" id="${blockId}-title" style="width: 100%; padding: 0.5rem; margin-bottom: 0.5rem; background: var(--bg-dark); border: 1px solid var(--border-light); border-radius: 4px; color: var(--text-light);" />
                        <textarea placeholder="Enter your text content here..." id="${blockId}-content" style="width: 100%; min-height: 100px; padding: 0.5rem; background: var(--bg-dark); border: 1px solid var(--border-light); border-radius: 4px; color: var(--text-light); font-family: inherit;"></textarea>
                    `;
                    contentBlocks.push({ id: blockId, type: "text" });
                } else if (type === "image") {
                    blockDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <h4 style="margin: 0; color: var(--accent-light);"><i class="fas fa-image"></i> Image Block</h4>
                            <div style="display: flex; gap: 0.5rem;">
                                <button type="button" onclick="moveBlockUp('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem;">
                                    <i class="fas fa-arrow-up"></i>
                                </button>
                                <button type="button" onclick="moveBlockDown('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem;">
                                    <i class="fas fa-arrow-down"></i>
                                </button>
                                <button type="button" onclick="removeContentBlock('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem; background: var(--danger);">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <input type="text" placeholder="Image caption (optional)" id="${blockId}-caption" style="width: 100%; padding: 0.5rem; margin-bottom: 0.5rem; background: var(--bg-dark); border: 1px solid var(--border-light); border-radius: 4px; color: var(--text-light);" />
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <button type="button" onclick="document.getElementById('${blockId}-input').click()" class="btn-secondary" style="flex-shrink: 0;">
                                <i class="fas fa-upload"></i> Choose Image
                            </button>
                            <span id="${blockId}-filename" style="color: var(--text-muted); font-size: 0.9rem;">No file chosen</span>
                        </div>
                        <input type="file" id="${blockId}-input" accept="image/*" style="display: none;" onchange="handleContentBlockImage('${blockId}')" />
                        <div id="${blockId}-preview" style="margin-top: 0.5rem;"></div>
                    `;
                    contentBlocks.push({
                        id: blockId,
                        type: "image",
                        file: null,
                    });
                }

                container.appendChild(blockDiv);
            }

            function handleContentBlockImage(blockId) {
                const input = document.getElementById(`${blockId}-input`);
                const preview = document.getElementById(`${blockId}-preview`);
                const filename = document.getElementById(`${blockId}-filename`);

                if (input.files && input.files[0]) {
                    const file = input.files[0];
                    filename.textContent = file.name;

                    const reader = new FileReader();
                    reader.onload = function (e) {
                        preview.innerHTML = `<img src="${e.target.result}" style="max-width: 100%; border-radius: 8px; margin-top: 0.5rem;" />`;
                    };
                    reader.readAsDataURL(file);

                    // Store file reference
                    const block = contentBlocks.find((b) => b.id === blockId);
                    if (block) {
                        block.file = file;
                    }
                }
            }

            function removeContentBlock(blockId) {
                const block = document.getElementById(blockId);
                if (block) {
                    block.remove();
                }
                const index = contentBlocks.findIndex((b) => b.id === blockId);
                if (index > -1) {
                    contentBlocks.splice(index, 1);
                }

                // Show empty message if no blocks
                const container = document.getElementById(
                    "contentBlocksContainer"
                );
                const emptyMessage = document.getElementById(
                    "emptyContentMessage"
                );
                if (container.children.length === 1 && emptyMessage) {
                    emptyMessage.style.display = "block";
                }
            }

            function moveBlockUp(blockId) {
                const block = document.getElementById(blockId);
                const previousBlock = block.previousElementSibling;
                if (
                    previousBlock &&
                    previousBlock.id !== "emptyContentMessage"
                ) {
                    block.parentNode.insertBefore(block, previousBlock);
                }
            }

            function moveBlockDown(blockId) {
                const block = document.getElementById(blockId);
                const nextBlock = block.nextElementSibling;
                if (nextBlock) {
                    block.parentNode.insertBefore(nextBlock, block);
                }
            }

            // Edit content block functions
            let editContentBlocks = [];
            let editContentBlockCounter = 0;

            function addEditContentBlock(type) {
                const container = document.getElementById(
                    "editContentBlocksContainer"
                );
                const emptyMessage = document.getElementById(
                    "editEmptyContentMessage"
                );

                if (emptyMessage) {
                    emptyMessage.style.display = "none";
                }

                const blockId = `edit-content-block-${editContentBlockCounter++}`;
                const blockDiv = document.createElement("div");
                blockDiv.id = blockId;
                blockDiv.className = "content-block";
                blockDiv.style.cssText =
                    "border: 1px solid var(--border-light); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; background: var(--bg-card);";

                if (type === "text") {
                    blockDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <h4 style="margin: 0; color: var(--accent-light);"><i class="fas fa-heading"></i> Text Block</h4>
                            <div style="display: flex; gap: 0.5rem;">
                                <button type="button" onclick="moveEditBlockUp('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem;">
                                    <i class="fas fa-arrow-up"></i>
                                </button>
                                <button type="button" onclick="moveEditBlockDown('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem;">
                                    <i class="fas fa-arrow-down"></i>
                                </button>
                                <button type="button" onclick="removeEditContentBlock('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem; background: var(--danger);">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <input type="text" placeholder="Title (optional)" id="${blockId}-title" style="width: 100%; padding: 0.5rem; margin-bottom: 0.5rem; background: var(--bg-dark); border: 1px solid var(--border-light); border-radius: 4px; color: var(--text-light);" />
                        <textarea placeholder="Enter your text content here..." id="${blockId}-content" style="width: 100%; min-height: 100px; padding: 0.5rem; background: var(--bg-dark); border: 1px solid var(--border-light); border-radius: 4px; color: var(--text-light); font-family: inherit;"></textarea>
                    `;
                    editContentBlocks.push({ id: blockId, type: "text" });
                } else if (type === "image") {
                    blockDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <h4 style="margin: 0; color: var(--accent-light);"><i class="fas fa-image"></i> Image Block</h4>
                            <div style="display: flex; gap: 0.5rem;">
                                <button type="button" onclick="moveEditBlockUp('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem;">
                                    <i class="fas fa-arrow-up"></i>
                                </button>
                                <button type="button" onclick="moveEditBlockDown('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem;">
                                    <i class="fas fa-arrow-down"></i>
                                </button>
                                <button type="button" onclick="removeEditContentBlock('${blockId}')" class="btn-secondary" style="padding: 0.3rem 0.6rem; background: var(--danger);">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <input type="text" placeholder="Image caption (optional)" id="${blockId}-caption" style="width: 100%; padding: 0.5rem; margin-bottom: 0.5rem; background: var(--bg-dark); border: 1px solid var(--border-light); border-radius: 4px; color: var(--text-light);" />
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <button type="button" onclick="document.getElementById('${blockId}-input').click()" class="btn-secondary" style="flex-shrink: 0;">
                                <i class="fas fa-upload"></i> Choose Image
                            </button>
                            <span id="${blockId}-filename" style="color: var(--text-muted); font-size: 0.9rem;">No file chosen</span>
                        </div>
                        <input type="file" id="${blockId}-input" accept="image/*" style="display: none;" onchange="handleEditContentBlockImage('${blockId}')" />
                        <div id="${blockId}-preview" style="margin-top: 0.5rem;"></div>
                    `;
                    editContentBlocks.push({
                        id: blockId,
                        type: "image",
                        file: null,
                    });
                }

                container.appendChild(blockDiv);
            }

            function handleEditContentBlockImage(blockId) {
                const input = document.getElementById(`${blockId}-input`);
                const preview = document.getElementById(`${blockId}-preview`);
                const filename = document.getElementById(`${blockId}-filename`);

                if (input.files && input.files[0]) {
                    const file = input.files[0];
                    filename.textContent = file.name;

                    const reader = new FileReader();
                    reader.onload = function (e) {
                        preview.innerHTML = `<img src="${e.target.result}" style="max-width: 100%; border-radius: 8px; margin-top: 0.5rem;" />`;
                    };
                    reader.readAsDataURL(file);

                    const block = editContentBlocks.find((b) => b.id === blockId);
                    if (block) {
                        block.file = file;
                    }
                }
            }

            function removeEditContentBlock(blockId) {
                const block = document.getElementById(blockId);
                if (block) {
                    block.remove();
                }
                const index = editContentBlocks.findIndex((b) => b.id === blockId);
                if (index > -1) {
                    editContentBlocks.splice(index, 1);
                }

                const container = document.getElementById(
                    "editContentBlocksContainer"
                );
                const emptyMessage = document.getElementById(
                    "editEmptyContentMessage"
                );
                if (container.children.length === 1 && emptyMessage) {
                    emptyMessage.style.display = "block";
                }
            }

            function moveEditBlockUp(blockId) {
                const block = document.getElementById(blockId);
                const previousBlock = block.previousElementSibling;
                if (
                    previousBlock &&
                    previousBlock.id !== "editEmptyContentMessage"
                ) {
                    block.parentNode.insertBefore(block, previousBlock);
                }
            }

            function moveEditBlockDown(blockId) {
                const block = document.getElementById(blockId);
                const nextBlock = block.nextElementSibling;
                if (nextBlock) {
                    block.parentNode.insertBefore(nextBlock, block);
                }
            }

            // ===== MODAL FUNCTIONS =====

            function hideAddDesignProjectModal() {
                hideModal("addDesignProjectModal");
                // Clear content blocks
                contentBlocks.length = 0;
                contentBlockCounter = 0;
                const container = document.getElementById(
                    "contentBlocksContainer"
                );
                if (container) {
                    container.innerHTML =
                        '<p id="emptyContentMessage" style="color: var(--text-muted); text-align: center;">No content blocks yet. Click the buttons above to add text or images.</p>';
                }
            }
            function showAddResearchModal(category = null) {
                if (category) {
                    document.getElementById("addResearchCategory").value =
                        category;
                }
                showModal("addResearchModal");
            }
            function hideAddResearchModal() {
                hideModal("addResearchModal");
            }
            function showAddStoryModal() {
                showModal("addStoryModal");
            }
            function hideAddStoryModal() {
                hideModal("addStoryModal");
            }
            async function showAddPhotoModal() {
                // Load existing galleries
                await loadExistingGalleries();
                // Set default mode to existing gallery
                toggleGalleryMode('existing');
                showModal("addPhotoModal");
            }
            
            async function loadExistingGalleries() {
                try {
                    const response = await fetch('/api/media/galleries', {
                        headers: {
                            'Authorization': `Bearer ${localStorage.getItem('token')}`
                        }
                    });
                    
                    if (!response.ok) throw new Error('Failed to load galleries');
                    
                    const galleries = await response.json();
                    const select = document.getElementById('addPhotoExistingGallery');
                    
                    select.innerHTML = '<option value="">No Gallery</option>';
                    
                    if (galleries && galleries.length > 0) {
                        galleries.forEach(gallery => {
                            const option = document.createElement('option');
                            option.value = gallery;
                            option.textContent = gallery;
                            select.appendChild(option);
                        });
                    }
                } catch (error) {
                    console.error('Error loading galleries:', error);
                    document.getElementById('addPhotoExistingGallery').innerHTML = 
                        '<option value="">No Gallery</option>';
                }
            }
            
            function toggleGalleryMode(mode) {
                const existingSection = document.getElementById('existingGallerySection');
                const newSection = document.getElementById('newGallerySection');
                const existingBtn = document.getElementById('useExistingGalleryBtn');
                const newBtn = document.getElementById('createNewGalleryBtn');
                
                if (mode === 'existing') {
                    existingSection.style.display = 'block';
                    newSection.style.display = 'none';
                    existingBtn.classList.add('btn-primary');
                    existingBtn.classList.remove('btn-secondary');
                    newBtn.classList.remove('btn-primary');
                    newBtn.classList.add('btn-secondary');
                    // Clear new gallery input
                    document.getElementById('addPhotoNewGallery').value = '';
                } else {
                    existingSection.style.display = 'none';
                    newSection.style.display = 'block';
                    newBtn.classList.add('btn-primary');
                    newBtn.classList.remove('btn-secondary');
                    existingBtn.classList.remove('btn-primary');
                    existingBtn.classList.add('btn-secondary');
                    // Reset existing gallery select
                    document.getElementById('addPhotoExistingGallery').value = '';
                }
            }
            
            function toggleEditGalleryMode(mode) {
                const existingSection = document.getElementById('editExistingGallerySection');
                const newSection = document.getElementById('editNewGallerySection');
                const existingBtn = document.getElementById('editUseExistingGalleryBtn');
                const newBtn = document.getElementById('editCreateNewGalleryBtn');
                
                if (mode === 'existing') {
                    existingSection.style.display = 'block';
                    newSection.style.display = 'none';
                    existingBtn.classList.add('btn-primary');
                    existingBtn.classList.remove('btn-secondary');
                    newBtn.classList.remove('btn-primary');
                    newBtn.classList.add('btn-secondary');
                    // Clear new gallery input
                    document.getElementById('editPhotoNewGallery').value = '';
                } else {
                    existingSection.style.display = 'none';
                    newSection.style.display = 'block';
                    newBtn.classList.add('btn-primary');
                    newBtn.classList.remove('btn-secondary');
                    existingBtn.classList.remove('btn-primary');
                    existingBtn.classList.add('btn-secondary');
                    // Reset existing gallery select
                    document.getElementById('editPhotoExistingGallery').value = '';
                }
            }
            
            async function loadExistingGalleriesForEdit() {
                try {
                    const response = await fetch('/api/media/galleries', {
                        headers: {
                            'Authorization': `Bearer ${localStorage.getItem('token')}`
                        }
                    });
                    
                    if (!response.ok) throw new Error('Failed to load galleries');
                    
                    const galleries = await response.json();
                    const select = document.getElementById('editPhotoExistingGallery');
                    
                    select.innerHTML = '<option value="">No Gallery</option>';
                    
                    if (galleries && galleries.length > 0) {
                        galleries.forEach(gallery => {
                            const option = document.createElement('option');
                            option.value = gallery;
                            option.textContent = gallery;
                            select.appendChild(option);
                        });
                    }
                } catch (error) {
                    console.error('Error loading galleries:', error);
                    document.getElementById('editPhotoExistingGallery').innerHTML = 
                        '<option value="">No Gallery</option>';
                }
            }
            
            function hideAddPhotoModal() {
                hideModal("addPhotoModal");
            }
            function showAddVideoModal() {
                showModal("addVideoModal");
            }
            function hideAddVideoModal() {
                hideModal("addVideoModal");
            }
            function showAddWorkshopModal() {
                showModal("addWorkshopModal");
            }
            function hideAddWorkshopModal() {
                hideModal("addWorkshopModal");
            }
            function showAddTutorialModal() {
                showModal("addTutorialModal");
            }
            function hideAddTutorialModal() {
                hideModal("addTutorialModal");
            }
            function showAddTestimonialModal() {
                showModal("addTestimonialModal");
            }
            function hideAddTestimonialModal() {
                hideModal("addTestimonialModal");
            }
            function showAddTeamMemberModal() {
                showModal("addTeamMemberModal");
            }
            function hideAddTeamMemberModal() {
                hideModal("addTeamMemberModal");
            }
            function showAddInitiativeModal() {
                showModal("addInitiativeModal");
            }
            function hideAddInitiativeModal() {
                hideModal("addInitiativeModal");
            }
            function showAddDesignModal() {
                showModal("addDesignModal");
            }
            function hideAddDesignModal() {
                hideModal("addDesignModal");
            }
            function showAddExhibitionModal() {
                showModal("addExhibitionModal");
            }
            function hideAddExhibitionModal() {
                hideModal("addExhibitionModal");
            }

            // Edit modal functions
            function showEditNewsModal() {
                showModal("editNewsModal");
            }
            function hideEditNewsModal() {
                hideModal("editNewsModal");
            }
            function showEditEventModal() {
                showModal("editEventModal");
            }
            function hideEditEventModal() {
                hideModal("editEventModal");
            }
            function showEditContactModal() {
                showModal("editContactModal");
            }
            function hideEditContactModal() {
                hideModal("editContactModal");
            }
            function showEditDesignProjectModal() {
                showModal("editDesignProjectModal");
            }
            function hideEditDesignProjectModal() {
                hideModal("editDesignProjectModal");
                // Clear edit content blocks
                editContentBlocks.length = 0;
                editContentBlockCounter = 0;
                const container = document.getElementById(
                    "editContentBlocksContainer"
                );
                if (container) {
                    container.innerHTML =
                        '<p id="editEmptyContentMessage" style="color: var(--text-muted); text-align: center;">No content blocks yet. Click the buttons above to add text or images.</p>';
                }
            }
            function showEditResearchModal() {
                showModal("editResearchModal");
            }
            function hideEditResearchModal() {
                hideModal("editResearchModal");
            }
            function showEditWorkshopModal() {
                showModal("editWorkshopModal");
            }
            function hideEditWorkshopModal() {
                hideModal("editWorkshopModal");
            }
            function showEditTeamMemberModal() {
                showModal("editTeamMemberModal");
            }
            function hideEditTeamMemberModal() {
                hideModal("editTeamMemberModal");
            }
            // Modal Show/Hide Functions - Add these to your existing modal functions
            function showEditTutorialModal() {
                showModal("editTutorialModal");
            }
            function hideEditTutorialModal() {
                hideModal("editTutorialModal");
            }
            function showEditExhibitionModal() {
                showModal("editExhibitionModal");
            }
            function hideEditExhibitionModal() {
                hideModal("editExhibitionModal");
            }
            function showEditPhotoModal() {
                showModal("editPhotoModal");
            }
            function hideEditPhotoModal() {
                hideModal("editPhotoModal");
            }
            function showEditVideoModal() {
                showModal("editVideoModal");
            }
            function hideEditVideoModal() {
                hideModal("editVideoModal");
            }
            function showEditDesignModal() {
                showModal("editDesignModal");
            }
            function hideEditDesignModal() {
                hideModal("editDesignModal");
            }
            function showEditTestimonialModal() {
                showModal("editTestimonialModal");
            }
            function hideEditTestimonialModal() {
                hideModal("editTestimonialModal");
            }
            function showEditStoryModal() {
                showModal("editStoryModal");
            }
            function hideEditStoryModal() {
                hideModal("editStoryModal");
            }
            function showEditInitiativeModal() {
                showModal("editInitiativeModal");
            }
            function hideEditInitiativeModal() {
                hideModal("editInitiativeModal");
            }

            // ===== FORM HANDLERS =====

            async function handleAddNews(event) {
                event.preventDefault();

                try {
                    // Create a regular JavaScript object instead of FormData
                    const newsData = {
                        title: document.getElementById("addNewsTitle").value,
                        excerpt:
                            document.getElementById("addNewsExcerpt").value,
                        content:
                            document.getElementById("addNewsContent").value,
                        author: document.getElementById("addNewsAuthor").value,
                        category:
                            document.getElementById("addNewsCategory").value,
                        date: document.getElementById("addNewsDate").value,
                        readTime:
                            document.getElementById("addNewsReadTime").value,
                        isFeatured:
                            document.getElementById("addNewsFeatured").checked,
                        isPublished:
                            document.getElementById("addNewsPublished").checked,
                        image: null, // Initialize as null
                    };

                    // UPLOAD FILE SEPARATELY
                    const imageFile =
                        document.getElementById("addNewsImageInput").files[0];
                    if (imageFile) {
                        const uploadedImageUrl = await uploadFile(
                            imageFile,
                            "news-image"
                        );
                        newsData.image = uploadedImageUrl; // Add the URL to the object
                    }

                    // Send as JSON, not FormData
                    await apiRequest("/newsevents/news", {
                        method: "POST",
                        body: JSON.stringify(newsData), // Convert to JSON string
                    });

                    hideAddNewsModal();
                    await loadNewsArticles();
                    await loadAllNewsEvents();
                    alert("News article added successfully!");
                } catch (error) {
                    console.error("Failed to add news:", error);
                    alert("Failed to add news: " + error.message);
                }
            }

            // Add Event Handler
            async function handleAddEvent(event) {
                event.preventDefault();

                try {
                    const eventData = {
                        title: document.getElementById("addEventTitle").value,
                        description: document.getElementById(
                            "addEventDescription"
                        ).value,
                        excerpt:
                            document.getElementById("addEventExcerpt").value,
                        eventDate:
                            document.getElementById("addEventDate").value,
                        eventTime:
                            document.getElementById("addEventTime").value,
                        location:
                            document.getElementById("addEventLocation").value,
                        category:
                            document.getElementById("addEventCategory").value,
                        author: document.getElementById("addEventAuthor").value,
                        readTime:
                            document.getElementById("addEventReadTime").value,
                        isFeatured:
                            document.getElementById("addEventFeatured").checked,
                        isPublished:
                            document.getElementById("addEventPublished")
                                .checked,
                        image: null,
                    };

                    const imageFile =
                        document.getElementById("addEventImageInput").files[0];
                    if (imageFile) {
                        const uploadedImageUrl = await uploadFile(
                            imageFile,
                            "event-image"
                        );
                        eventData.image = uploadedImageUrl;
                    }

                    await apiRequest("/newsevents/events", {
                        method: "POST",
                        body: JSON.stringify(eventData),
                    });

                    hideAddEventModal();
                    await loadEvents();
                    await loadAllNewsEvents();
                    alert("Event added successfully!");
                } catch (error) {
                    console.error("Failed to add event:", error);
                    alert("Failed to add event: " + error.message);
                }
            }

            // Edit News Handler
            async function handleEditNews(event) {
                event.preventDefault();

                try {
                    const newsId = document.getElementById("editNewsId").value;
                    const newsData = {
                        title: document.getElementById("editNewsTitle").value,
                        excerpt:
                            document.getElementById("editNewsExcerpt").value,
                        content:
                            document.getElementById("editNewsContent").value,
                        author: document.getElementById("editNewsAuthor").value,
                        category:
                            document.getElementById("editNewsCategory").value,
                        date: document.getElementById("editNewsDate").value,
                        readTime:
                            document.getElementById("editNewsReadTime").value,
                        isFeatured:
                            document.getElementById("editNewsFeatured").checked,
                        isPublished:
                            document.getElementById("editNewsPublished")
                                .checked,
                        image: null,
                    };

                    const imageFile =
                        document.getElementById("editNewsImageInput").files[0];
                    if (imageFile) {
                        const uploadedImageUrl = await uploadFile(
                            imageFile,
                            "news-image"
                        );
                        newsData.image = uploadedImageUrl;
                    }

                    await apiRequest(`/newsevents/news/${newsId}`, {
                        method: "PUT",
                        body: JSON.stringify(newsData),
                    });

                    hideEditNewsModal();
                    await loadNewsArticles();
                    await loadAllNewsEvents();
                    alert("News article updated successfully!");
                } catch (error) {
                    console.error("Failed to update news:", error);
                    alert("Failed to update news: " + error.message);
                }
            }

            // Edit Event Handler
            async function handleEditEvent(event) {
                event.preventDefault();

                try {
                    const eventId =
                        document.getElementById("editEventId").value;
                    const eventData = {
                        title: document.getElementById("editEventTitle").value,
                        description: document.getElementById(
                            "editEventDescription"
                        ).value,
                        excerpt:
                            document.getElementById("editEventExcerpt").value,
                        eventDate:
                            document.getElementById("editEventDate").value,
                        eventTime:
                            document.getElementById("editEventTime").value,
                        location:
                            document.getElementById("editEventLocation").value,
                        category:
                            document.getElementById("editEventCategory").value,
                        author: document.getElementById("editEventAuthor")
                            .value,
                        readTime:
                            document.getElementById("editEventReadTime").value,
                        isFeatured:
                            document.getElementById("editEventFeatured")
                                .checked,
                        isPublished:
                            document.getElementById("editEventPublished")
                                .checked,
                        image: null,
                    };

                    const imageFile = document.getElementById(
                        "editEventImageInput"
                    ).files[0];
                    if (imageFile) {
                        const uploadedImageUrl = await uploadFile(
                            imageFile,
                            "event-image"
                        );
                        eventData.image = uploadedImageUrl;
                    }

                    await apiRequest(`/newsevents/events/${eventId}`, {
                        method: "PUT",
                        body: JSON.stringify(eventData),
                    });

                    hideEditEventModal();
                    await loadEvents();
                    await loadAllNewsEvents();
                    alert("Event updated successfully!");
                } catch (error) {
                    console.error("Failed to update event:", error);
                    alert("Failed to update event: " + error.message);
                }
            }

            // Edit Research Article Handler
            async function handleEditResearch(event) {
                event.preventDefault();

                try {
                    const researchId =
                        document.getElementById("editResearchId").value;
                    const researchData = {
                        title: document.getElementById("editResearchTitle")
                            .value,
                        abstract: document.getElementById(
                            "editResearchAbstract"
                        ).value,
                        content: document.getElementById("editResearchContent")
                            .value,
                        category: document.getElementById(
                            "editResearchCategory"
                        ).value,
                        authors: document.getElementById("editResearchAuthors")
                            .value,
                        publication_date: document.getElementById(
                            "editResearchPublicationDate"
                        ).value,
                        main_image: document.getElementById(
                            "editResearchMainImage"
                        ).value,
                        display_order: document.getElementById(
                            "editResearchDisplayOrder"
                        ).value,
                        is_featured: document.getElementById(
                            "editResearchFeatured"
                        ).checked,
                        is_published: document.getElementById(
                            "editResearchPublished"
                        ).checked,
                    };

                    await apiRequest(`/research/admin/articles/${researchId}`, {
                        method: "PUT",
                        body: JSON.stringify(researchData),
                    });

                    hideEditResearchModal();
                    await loadResearchArticles();
                    alert("Research article updated successfully!");
                } catch (error) {
                    console.error("Failed to update research article:", error);
                    alert(
                        "Failed to update research article: " + error.message
                    );
                }
            }

            // Edit Design Project Handler
            async function handleEditDesignProject(event) {
                event.preventDefault();

                try {
                    const projectId = document.getElementById(
                        "editDesignProjectId"
                    ).value;
                    const projectData = {
                        title: document.getElementById("editDesignProjectTitle")
                            .value,
                        summary: document.getElementById(
                            "editDesignProjectSummary"
                        ).value,
                        description: document.getElementById(
                            "editDesignProjectDescription"
                        ).value,
                        category: document.getElementById(
                            "editDesignProjectCategory"
                        ).value,
                        sector: document.getElementById(
                            "editDesignProjectSector"
                        ).value,
                        display_order:
                            parseInt(
                                document.getElementById(
                                    "editDesignProjectDisplayOrder"
                                ).value
                            ) || 0,
                        is_featured: document.getElementById(
                            "editDesignProjectFeatured"
                        ).checked,
                        is_published: document.getElementById(
                            "editDesignProjectPublished"
                        ).checked,
                        main_image: null,
                    };

                    const mainImageFile =
                        document.getElementById("editMainImageInput").files[0];
                    if (mainImageFile) {
                        const uploadedImageUrl = await uploadFile(
                            mainImageFile,
                            "design-project"
                        );
                        projectData.main_image = uploadedImageUrl;
                    }

                    await apiRequest(`/design/admin/projects/${projectId}`, {
                        method: "PUT",
                        body: JSON.stringify(projectData),
                    });

                    hideEditDesignProjectModal();
                    await loadDesignProjects();
                    alert("Design project updated successfully!");
                } catch (error) {
                    console.error("Failed to update design project:", error);
                    alert("Failed to update design project: " + error.message);
                }
            }

            // Add Design Project Handler
            async function handleAddDesignProject(event) {
                event.preventDefault();

                try {
                    const projectData = {
                        title: document.getElementById("addDesignProjectTitle")
                            .value,
                        summary: document.getElementById(
                            "addDesignProjectSummary"
                        ).value,
                        category: document.getElementById(
                            "addDesignProjectCategory"
                        ).value,
                        sector: document.getElementById(
                            "addDesignProjectSector"
                        ).value,
                        displayOrder:
                            parseInt(
                                document.getElementById(
                                    "addDesignProjectDisplayOrder"
                                ).value
                            ) || 0,
                        isFeatured: document.getElementById(
                            "addDesignProjectFeatured"
                        ).checked,
                        isPublished: document.getElementById(
                            "addDesignProjectPublished"
                        ).checked,
                        mainImage: null,
                        contentBlocks: [],
                    };

                    // Upload main image
                    const mainImageFile =
                        document.getElementById("addMainImageInput").files[0];
                    if (mainImageFile) {
                        const uploadedImageUrl = await uploadFile(
                            mainImageFile,
                            "design-project"
                        );
                        projectData.mainImage = uploadedImageUrl;
                    }

                    // Process content blocks
                    console.log(
                        ` Processing ${contentBlocks.length} content blocks...`
                    );
                    for (const block of contentBlocks) {
                        if (block.type === "text") {
                            const title =
                                document.getElementById(`${block.id}-title`)
                                    ?.value || "";
                            const content =
                                document.getElementById(`${block.id}-content`)
                                    ?.value || "";
                            if (content) {
                                projectData.contentBlocks.push({
                                    type: "text",
                                    title: title,
                                    content: content,
                                });
                            }
                        } else if (block.type === "image" && block.file) {
                            const caption =
                                document.getElementById(`${block.id}-caption`)
                                    ?.value || "";
                            console.log(
                                ` Uploading image block: ${block.file.name}`
                            );
                            const uploadedImageUrl = await uploadFile(
                                block.file,
                                "design-content"
                            );
                            projectData.contentBlocks.push({
                                type: "image",
                                caption: caption,
                                imageUrl: uploadedImageUrl,
                            });
                        }
                    }
                    console.log(
                        ` Processed ${projectData.contentBlocks.length} content blocks`
                    );

                    // Send as JSON
                    await apiRequest("/design/admin/projects", {
                        method: "POST",
                        body: JSON.stringify(projectData),
                    });

                    hideAddDesignProjectModal();
                    await loadDesignProjects();
                    alert("Design project added successfully!");
                } catch (error) {
                    console.error("Failed to add design project:", error);
                    alert("Failed to add design project: " + error.message);
                }
            }
            // Add Research Article Handler
            async function handleAddResearch(event) {
                event.preventDefault();

                try {
                    const researchData = {
                        title: document.getElementById("addResearchTitle")
                            .value,
                        abstract: document.getElementById("addResearchAbstract")
                            .value,
                        content:
                            document.getElementById("addResearchContent").value,
                        category: document.getElementById("addResearchCategory")
                            .value,
                        authors:
                            document.getElementById("addResearchAuthors").value,
                        publicationDate: document.getElementById(
                            "addResearchPublicationDate"
                        ).value,
                        mainImage: null,
                        displayOrder: document.getElementById(
                            "addResearchDisplayOrder"
                        ).value,
                        isFeatured: document.getElementById(
                            "addResearchFeatured"
                        ).checked,
                        isPublished: document.getElementById(
                            "addResearchPublished"
                        ).checked,
                    };

                    // Handle image upload
                    const imageFile = document.getElementById(
                        "addResearchMainImageFile"
                    ).files[0];
                    if (imageFile) {
                        const uploadedImageUrl = await uploadFile(
                            imageFile,
                            "research-image"
                        );
                        researchData.mainImage = uploadedImageUrl;
                    } else if (
                        document.getElementById("addResearchMainImage").value
                    ) {
                        researchData.mainImage = document.getElementById(
                            "addResearchMainImage"
                        ).value;
                    }

                    await apiRequest("/research/articles", {
                        method: "POST",
                        body: JSON.stringify(researchData),
                    });

                    hideAddResearchModal();
                    await loadResearchArticles();
                    alert("Research article added successfully!");
                } catch (error) {
                    console.error("Failed to add research article:", error);
                    alert("Failed to add research article: " + error.message);
                }
            }

            // Add Workshop Handler
            async function handleAddWorkshop(event) {
                event.preventDefault();

                try {
                    const workshopData = {
                        title: document.getElementById("addWorkshopTitle")
                            .value,
                        description: document.getElementById(
                            "addWorkshopDescription"
                        ).value,
                        instructor: document.getElementById(
                            "addWorkshopInstructor"
                        ).value,
                        date: document.getElementById("addWorkshopDate").value,
                        time: document.getElementById("addWorkshopTime").value,
                        location: document.getElementById("addWorkshopLocation")
                            .value,
                        capacity: document.getElementById("addWorkshopCapacity")
                            .value,
                        isPublished: document.getElementById(
                            "addWorkshopPublished"
                        ).checked,
                    };

                    await apiRequest("/education/workshops", {
                        method: "POST",
                        body: JSON.stringify(workshopData),
                    });

                    hideAddWorkshopModal();
                    await loadWorkshops();
                    alert("Workshop added successfully!");
                } catch (error) {
                    console.error("Failed to add workshop:", error);
                    alert("Failed to add workshop: " + error.message);
                }
            }

            // Add Photo Handler
            async function handleAddPhoto(event) {
                event.preventDefault();

                try {
                    // Get gallery name from either existing or new gallery input
                    const existingGallery = document.getElementById('addPhotoExistingGallery').value;
                    const newGallery = document.getElementById('addPhotoNewGallery').value.trim();
                    const galleryName = newGallery || existingGallery || null;
                    
                    const photoData = {
                        title: document.getElementById("addPhotoTitle").value,
                        description: document.getElementById(
                            "addPhotoDescription"
                        ).value,
                        category:
                            document.getElementById("addPhotoCategory").value,
                        albumName: galleryName,
                        isFeatured:
                            document.getElementById("addPhotoFeatured").checked,
                        isPublished:
                            document.getElementById("addPhotoPublished")
                                .checked,
                        image: null,
                    };

                    const photoFile =
                        document.getElementById("addPhotoFileInput").files[0];
                    if (photoFile) {
                        const uploadedPhotoUrl = await uploadFile(
                            photoFile,
                            "photo"
                        );
                        photoData.image = uploadedPhotoUrl;
                    }

                    // Send as JSON
                    await apiRequest("/media/photos", {
                        method: "POST",
                        body: JSON.stringify(photoData),
                    });

                    hideAddPhotoModal();
                    await loadPhotos();
                    alert("Photo added successfully!");
                } catch (error) {
                    console.error("Failed to add photo:", error);
                    alert("Failed to add photo: " + error.message);
                }
            }
            // Add Video Handler
            async function handleAddVideo(event) {
                event.preventDefault();

                try {
                    const videoData = {
                        title: document.getElementById("addVideoTitle").value,
                        description: document.getElementById(
                            "addVideoDescription"
                        ).value,
                        url: null,
                        thumbnail: null,
                        category:
                            document.getElementById("addVideoCategory").value,
                        isFeatured:
                            document.getElementById("addVideoFeatured").checked,
                        isPublished:
                            document.getElementById("addVideoPublished")
                                .checked,
                    };

                    // Handle video file upload
                    const videoFile =
                        document.getElementById("addVideoFileInput").files[0];
                    if (videoFile) {
                        const uploadedVideoUrl = await uploadFile(
                            videoFile,
                            "video"
                        );
                        videoData.url = uploadedVideoUrl;
                    } else if (document.getElementById("addVideoURL").value) {
                        videoData.url =
                            document.getElementById("addVideoURL").value;
                    }

                    if (!videoData.url) {
                        alert(
                            "Please upload a video file or provide a video URL"
                        );
                        return;
                    }

                    // Handle thumbnail upload
                    const thumbnailFile = document.getElementById(
                        "addVideoThumbnailInput"
                    ).files[0];
                    if (thumbnailFile) {
                        const uploadedThumbnailUrl = await uploadFile(
                            thumbnailFile,
                            "video-thumbnail"
                        );
                        videoData.thumbnail = uploadedThumbnailUrl;
                    }

                    if (!videoData.thumbnail) {
                        alert("Please upload a thumbnail image for the video");
                        return;
                    }

                    await apiRequest("/media/videos", {
                        method: "POST",
                        body: JSON.stringify(videoData),
                    });

                    hideAddVideoModal();
                    await loadVideos();
                    alert("Video added successfully!");
                } catch (error) {
                    console.error("Failed to add video:", error);
                    alert("Failed to add video: " + error.message);
                }
            }

            // Add Tutorial Handler
            async function handleAddTutorial(event) {
                event.preventDefault();

                try {
                    const tutorialData = {
                        title: document.getElementById("addTutorialTitle")
                            .value,
                        description: document.getElementById(
                            "addTutorialDescription"
                        ).value,
                        instructor: document.getElementById(
                            "addTutorialInstructor"
                        ).value,
                        duration: document.getElementById("addTutorialDuration")
                            .value,
                        level: document.getElementById("addTutorialLevel")
                            .value,
                        isPublished: document.getElementById(
                            "addTutorialPublished"
                        ).checked,
                    };

                    await apiRequest("/education/tutorials", {
                        method: "POST",
                        body: JSON.stringify(tutorialData),
                    });

                    hideAddTutorialModal();
                    await loadTutorials();
                    alert("Tutorial added successfully!");
                } catch (error) {
                    console.error("Failed to add tutorial:", error);
                    alert("Failed to add tutorial: " + error.message);
                }
            }

            // Add Exhibition Handler
            async function handleAddExhibition(event) {
                event.preventDefault();

                try {
                    const exhibitionData = {
                        title: document.getElementById("addExhibitionTitle")
                            .value,
                        description: document.getElementById(
                            "addExhibitionDescription"
                        ).value,
                        startDate: document.getElementById(
                            "addExhibitionStartDate"
                        ).value,
                        endDate: document.getElementById("addExhibitionEndDate")
                            .value,
                        location: document.getElementById(
                            "addExhibitionLocation"
                        ).value,
                        isPublished: document.getElementById(
                            "addExhibitionPublished"
                        ).checked,
                    };

                    await apiRequest("/education/exhibitions", {
                        method: "POST",
                        body: JSON.stringify(exhibitionData),
                    });

                    hideAddExhibitionModal();
                    await loadExhibitions();
                    alert("Exhibition added successfully!");
                } catch (error) {
                    console.error("Failed to add exhibition:", error);
                    alert("Failed to add exhibition: " + error.message);
                }
            }

            // Add Design Handler
            async function handleAddDesign(event) {
                event.preventDefault();

                try {
                    const formData = new FormData();
                    formData.append(
                        "title",
                        document.getElementById("addDesignTitle").value
                    );
                    formData.append(
                        "description",
                        document.getElementById("addDesignDescription").value
                    );
                    formData.append(
                        "category",
                        document.getElementById("addDesignCategory").value
                    );
                    formData.append(
                        "isFeatured",
                        document.getElementById("addDesignFeatured").checked
                    );
                    formData.append(
                        "isPublished",
                        document.getElementById("addDesignPublished").checked
                    );

                    const designFile =
                        document.getElementById("addDesignFileInput").files[0];
                    if (designFile) {
                        formData.append("design", designFile);
                    }

                    await apiRequest("/media/designs", {
                        method: "POST",
                        body: formData,
                    });

                    hideAddDesignModal();
                    await loadDesigns();
                    alert("Design added successfully!");
                } catch (error) {
                    console.error("Failed to add design:", error);
                    alert("Failed to add design: " + error.message);
                }
            }

            // Add Story Handler
            async function handleAddStory(event) {
                event.preventDefault();

                try {
                    const storyData = {
                        storyTitle:
                            document.getElementById("addStoryTitle").value,
                        storyContent:
                            document.getElementById("addStoryContent").value,
                        authorName:
                            document.getElementById("addStoryAuthorName").value,
                        authorTitle: document.getElementById(
                            "addStoryAuthorTitle"
                        ).value,
                        category:
                            document.getElementById("addStoryCategory").value,
                        isFeatured:
                            document.getElementById("addStoryFeatured").checked,
                        isPublished:
                            document.getElementById("addStoryPublished")
                                .checked,
                    };

                    await apiRequest("/get-involved/admin/stories", {
                        method: "POST",
                        body: JSON.stringify(storyData),
                    });

                    hideAddStoryModal();
                    await loadStories();
                    alert("Community story added successfully!");
                } catch (error) {
                    console.error("Failed to add story:", error);
                    alert("Failed to add story: " + error.message);
                }
            }

            // Add Testimonial Handler
            async function handleAddTestimonial(event) {
                event.preventDefault();

                try {
                    const testimonialData = {
                        name: document.getElementById("addTestimonialName")
                            .value,
                        role: document.getElementById("addTestimonialRole")
                            .value,
                        organization: document.getElementById(
                            "addTestimonialOrganization"
                        ).value,
                        quote: document.getElementById("addTestimonialQuote")
                            .value,
                        project: document.getElementById(
                            "addTestimonialProject"
                        ).value,
                        rating: document.getElementById("addTestimonialRating")
                            .value,
                        isFeatured: document.getElementById(
                            "addTestimonialFeatured"
                        ).checked,
                        isPublished: document.getElementById(
                            "addTestimonialPublished"
                        ).checked,
                    };

                    await apiRequest("/media/testimonials", {
                        method: "POST",
                        body: JSON.stringify(testimonialData),
                    });

                    hideAddTestimonialModal();
                    await loadTestimonials();
                    alert("Testimonial added successfully!");
                } catch (error) {
                    console.error("Failed to add testimonial:", error);
                    alert("Failed to add testimonial: " + error.message);
                }
            }

            // Add Team Member Handler
            async function handleAddTeamMember(event) {
                event.preventDefault();

                try {
                    const memberData = {
                        name: document.getElementById("addTeamMemberName")
                            .value,
                        role: document.getElementById("addTeamMemberRole")
                            .value,
                        bio: document.getElementById("addTeamMemberBio").value,
                        displayOrder:
                            parseInt(
                                document.getElementById("addTeamMemberOrder")
                                    .value
                            ) || 0,
                        isActive: document.getElementById("addTeamMemberActive")
                            .checked,
                        imageUrl: null,
                    };

                    const imageFile = document.getElementById(
                        "addTeamMemberImageFile"
                    ).files[0];
                    if (imageFile) {
                        const uploadedImageUrl = await uploadFile(
                            imageFile,
                            "team-member"
                        );
                        memberData.imageUrl = uploadedImageUrl;
                    } else if (
                        document.getElementById("addTeamMemberImageUrl").value
                    ) {
                        memberData.imageUrl = document.getElementById(
                            "addTeamMemberImageUrl"
                        ).value;
                    }

                    // Send as JSON
                    await apiRequest("/colleagues/team", {
                        method: "POST",
                        body: JSON.stringify(memberData),
                    });

                    hideAddTeamMemberModal();
                    await loadTeamMembers();
                    alert("Team member added successfully!");
                } catch (error) {
                    console.error("Failed to add team member:", error);
                    alert("Failed to add team member: " + error.message);
                }
            }
            // Add Initiative Handler
            async function handleAddInitiative(event) {
                event.preventDefault();

                try {
                    const initiativeData = {
                        title: document.getElementById("addInitiativeTitle")
                            .value,
                        description: document.getElementById(
                            "addInitiativeDescription"
                        ).value,
                        status: document.getElementById("addInitiativeStatus")
                            .value,
                        targetDate: document.getElementById(
                            "addInitiativeTargetDate"
                        ).value,
                        isActive: document.getElementById("addInitiativeActive")
                            .checked,
                    };

                    await apiRequest("/colleagues/initiatives", {
                        method: "POST",
                        body: JSON.stringify(initiativeData),
                    });

                    hideAddInitiativeModal();
                    await loadInitiatives();
                    alert("Initiative added successfully!");
                } catch (error) {
                    console.error("Failed to add initiative:", error);
                    alert("Failed to add initiative: " + error.message);
                }
            }
            // Edit Workshop Handler
            async function handleEditWorkshop(event) {
                event.preventDefault();

                try {
                    const workshopData = {
                        title: document.getElementById("editWorkshopTitle")
                            .value,
                        description: document.getElementById(
                            "editWorkshopDescription"
                        ).value,
                        instructor: document.getElementById(
                            "editWorkshopInstructor"
                        ).value,
                        date: document.getElementById("editWorkshopDate").value,
                        time: document.getElementById("editWorkshopTime").value,
                        location: document.getElementById(
                            "editWorkshopLocation"
                        ).value,
                        capacity: document.getElementById(
                            "editWorkshopCapacity"
                        ).value,
                        isPublished: document.getElementById(
                            "editWorkshopPublished"
                        ).checked,
                    };

                    const workshopId =
                        document.getElementById("editWorkshopId").value;

                    await apiRequest(`/education/workshops/${workshopId}`, {
                        method: "PUT",
                        body: JSON.stringify(workshopData),
                    });

                    hideEditWorkshopModal();
                    await loadWorkshops();
                    alert("Workshop updated successfully!");
                } catch (error) {
                    console.error("Failed to update workshop:", error);
                    alert("Failed to update workshop: " + error.message);
                }
            }

            // Edit Tutorial Handler
            async function handleEditTutorial(event) {
                event.preventDefault();

                try {
                    const tutorialData = {
                        title: document.getElementById("editTutorialTitle")
                            .value,
                        description: document.getElementById(
                            "editTutorialDescription"
                        ).value,
                        category: document.getElementById(
                            "editTutorialCategory"
                        ).value,
                        format: document.getElementById("editTutorialFormat")
                            .value,
                        duration: document.getElementById(
                            "editTutorialDuration"
                        ).value,
                        level: document.getElementById("editTutorialLevel")
                            .value,
                        isPublished: document.getElementById(
                            "editTutorialPublished"
                        ).checked,
                    };

                    const tutorialId =
                        document.getElementById("editTutorialId").value;

                    await apiRequest(`/education/tutorials/${tutorialId}`, {
                        method: "PUT",
                        body: JSON.stringify(tutorialData),
                    });

                    hideEditTutorialModal();
                    await loadTutorials();
                    alert("Tutorial updated successfully!");
                } catch (error) {
                    console.error("Failed to update tutorial:", error);
                    alert("Failed to update tutorial: " + error.message);
                }
            }

            // Edit Exhibition Handler
            async function handleEditExhibition(event) {
                event.preventDefault();

                try {
                    const exhibitionData = {
                        title: document.getElementById("editExhibitionTitle")
                            .value,
                        description: document.getElementById(
                            "editExhibitionDescription"
                        ).value,
                        startDate: document.getElementById(
                            "editExhibitionStartDate"
                        ).value,
                        endDate: document.getElementById(
                            "editExhibitionEndDate"
                        ).value,
                        location: document.getElementById(
                            "editExhibitionLocation"
                        ).value,
                        curator: document.getElementById(
                            "editExhibitionCurator"
                        ).value,
                        curatorBio: document.getElementById(
                            "editExhibitionCuratorBio"
                        ).value,
                        virtualTourUrl: document.getElementById(
                            "editExhibitionVirtualTour"
                        ).value,
                        isPublished: document.getElementById(
                            "editExhibitionPublished"
                        ).checked,
                    };

                    const exhibitionId =
                        document.getElementById("editExhibitionId").value;

                    await apiRequest(`/education/exhibitions/${exhibitionId}`, {
                        method: "PUT",
                        body: JSON.stringify(exhibitionData),
                    });

                    hideEditExhibitionModal();
                    await loadExhibitions();
                    alert("Exhibition updated successfully!");
                } catch (error) {
                    console.error("Failed to update exhibition:", error);
                    alert("Failed to update exhibition: " + error.message);
                }
            }

            // Edit Photo Handler
            async function handleEditPhoto(event) {
                event.preventDefault();

                try {
                    // Get gallery name from either existing or new gallery input
                    const existingGallery = document.getElementById('editPhotoExistingGallery').value;
                    const newGallery = document.getElementById('editPhotoNewGallery').value.trim();
                    const galleryName = newGallery || existingGallery || null;
                    
                    const photoData = {
                        title: document.getElementById("editPhotoTitle").value,
                        description: document.getElementById(
                            "editPhotoDescription"
                        ).value,
                        category:
                            document.getElementById("editPhotoCategory").value,
                        albumName: galleryName,
                        isFeatured:
                            document.getElementById("editPhotoFeatured")
                                .checked,
                        isPublished:
                            document.getElementById("editPhotoPublished")
                                .checked,
                        image: null,
                    };

                    const photoId =
                        document.getElementById("editPhotoId").value;
                    const photoFile =
                        document.getElementById("editPhotoFileInput").files[0];

                    if (photoFile) {
                        const uploadedPhotoUrl = await uploadFile(
                            photoFile,
                            "photo"
                        );
                        photoData.image = uploadedPhotoUrl;
                    }

                    await apiRequest(`/media/photos/${photoId}`, {
                        method: "PUT",
                        body: JSON.stringify(photoData),
                    });

                    hideEditPhotoModal();
                    await loadPhotos();
                    alert("Photo updated successfully!");
                } catch (error) {
                    console.error("Failed to update photo:", error);
                    alert("Failed to update photo: " + error.message);
                }
            }

            // Edit Video Handler
            async function handleEditVideo(event) {
                event.preventDefault();

                try {
                    const videoData = {
                        title: document.getElementById("editVideoTitle").value,
                        description: document.getElementById(
                            "editVideoDescription"
                        ).value,
                        url: null,
                        thumbnail: null,
                        category:
                            document.getElementById("editVideoCategory").value,
                        isFeatured:
                            document.getElementById("editVideoFeatured")
                                .checked,
                        isPublished:
                            document.getElementById("editVideoPublished")
                                .checked,
                    };

                    // Handle video file upload
                    const videoFile =
                        document.getElementById("editVideoFileInput").files[0];
                    if (videoFile) {
                        const uploadedVideoUrl = await uploadFile(
                            videoFile,
                            "video"
                        );
                        videoData.url = uploadedVideoUrl;
                    } else if (document.getElementById("editVideoURL").value) {
                        videoData.url =
                            document.getElementById("editVideoURL").value;
                    }

                    // Handle thumbnail upload
                    const thumbnailFile = document.getElementById(
                        "editVideoThumbnailInput"
                    ).files[0];
                    if (thumbnailFile) {
                        const uploadedThumbnailUrl = await uploadFile(
                            thumbnailFile,
                            "video-thumbnail"
                        );
                        videoData.thumbnail = uploadedThumbnailUrl;
                    }

                    const videoId =
                        document.getElementById("editVideoId").value;

                    await apiRequest(`/media/videos/${videoId}`, {
                        method: "PUT",
                        body: JSON.stringify(videoData),
                    });

                    hideEditVideoModal();
                    await loadVideos();
                    alert("Video updated successfully!");
                } catch (error) {
                    console.error("Failed to update video:", error);
                    alert("Failed to update video: " + error.message);
                }
            }

            // Edit Design Handler (Media Library)
            async function handleEditDesign(event) {
                event.preventDefault();

                try {
                    const designData = {
                        title: document.getElementById("editDesignTitle").value,
                        description: document.getElementById(
                            "editDesignDescription"
                        ).value,
                        category:
                            document.getElementById("editDesignCategory").value,
                        isFeatured:
                            document.getElementById("editDesignFeatured")
                                .checked,
                        isPublished: document.getElementById(
                            "editDesignPublished"
                        ).checked,
                        design: null,
                    };

                    const designId =
                        document.getElementById("editDesignId").value;
                    const designFile = document.getElementById(
                        "editDesignFileInput"
                    ).files[0];

                    if (designFile) {
                        const uploadedDesignUrl = await uploadFile(
                            designFile,
                            "design"
                        );
                        designData.design = uploadedDesignUrl;
                    }

                    await apiRequest(`/media/designs/${designId}`, {
                        method: "PUT",
                        body: JSON.stringify(designData),
                    });

                    hideEditDesignModal();
                    await loadDesigns();
                    alert("Design updated successfully!");
                } catch (error) {
                    console.error("Failed to update design:", error);
                    alert("Failed to update design: " + error.message);
                }
            }

            // Edit Testimonial Handler
            async function handleEditTestimonial(event) {
                event.preventDefault();

                try {
                    const testimonialData = {
                        name: document.getElementById("editTestimonialName")
                            .value,
                        role: document.getElementById("editTestimonialRole")
                            .value,
                        organization: document.getElementById(
                            "editTestimonialOrganization"
                        ).value,
                        quote: document.getElementById("editTestimonialQuote")
                            .value,
                        project: document.getElementById(
                            "editTestimonialProject"
                        ).value,
                        rating: document.getElementById("editTestimonialRating")
                            .value,
                        isFeatured: document.getElementById(
                            "editTestimonialFeatured"
                        ).checked,
                        isPublished: document.getElementById(
                            "editTestimonialPublished"
                        ).checked,
                    };

                    const testimonialId =
                        document.getElementById("editTestimonialId").value;

                    await apiRequest(`/media/testimonials/${testimonialId}`, {
                        method: "PUT",
                        body: JSON.stringify(testimonialData),
                    });

                    hideEditTestimonialModal();
                    await loadTestimonials();
                    alert("Testimonial updated successfully!");
                } catch (error) {
                    console.error("Failed to update testimonial:", error);
                    alert("Failed to update testimonial: " + error.message);
                }
            }

            // Edit Story Handler
            async function handleEditStory(event) {
                event.preventDefault();

                try {
                    const storyData = {
                        storyTitle:
                            document.getElementById("editStoryTitle").value,
                        storyContent:
                            document.getElementById("editStoryContent").value,
                        authorName: document.getElementById(
                            "editStoryAuthorName"
                        ).value,
                        authorTitle: document.getElementById(
                            "editStoryAuthorTitle"
                        ).value,
                        category:
                            document.getElementById("editStoryCategory").value,
                        isFeatured:
                            document.getElementById("editStoryFeatured")
                                .checked,
                        isPublished:
                            document.getElementById("editStoryPublished")
                                .checked,
                    };

                    const storyId =
                        document.getElementById("editStoryId").value;

                    await apiRequest(`/get-involved/admin/stories/${storyId}`, {
                        method: "PUT",
                        body: JSON.stringify(storyData),
                    });

                    hideEditStoryModal();
                    await loadStories();
                    alert("Community story updated successfully!");
                } catch (error) {
                    console.error("Failed to update story:", error);
                    alert("Failed to update story: " + error.message);
                }
            }

            // Handle Edit Team Member Form Submission
            async function handleEditTeamMember(event) {
                event.preventDefault();

                try {
                    const teamMemberId =
                        document.getElementById("editTeamMemberId").value;

                    const memberData = {
                        name: document.getElementById("editTeamMemberName")
                            .value,
                        role: document.getElementById("editTeamMemberRole")
                            .value,
                        bio: document.getElementById("editTeamMemberBio").value,
                        displayOrder:
                            parseInt(
                                document.getElementById("editTeamMemberOrder")
                                    .value
                            ) || 0,
                        isActive: document.getElementById(
                            "editTeamMemberActive"
                        ).checked,
                        imageUrl: null,
                    };

                    // Handle image upload
                    const imageFile = document.getElementById(
                        "editTeamMemberImageFile"
                    ).files[0];
                    if (imageFile) {
                        const uploadedImageUrl = await uploadFile(
                            imageFile,
                            "team-member"
                        );
                        memberData.imageUrl = uploadedImageUrl;
                    } else if (
                        document.getElementById("editTeamMemberImageUrl").value
                    ) {
                        memberData.imageUrl = document.getElementById(
                            "editTeamMemberImageUrl"
                        ).value;
                    }

                    await apiRequest(`/colleagues/team/${teamMemberId}`, {
                        method: "PUT",
                        body: JSON.stringify(memberData),
                    });

                    hideEditTeamMemberModal();
                    await loadTeamMembers();
                    alert("Team member updated successfully!");
                } catch (error) {
                    console.error("Failed to update team member:", error);
                    alert("Failed to update team member: " + error.message);
                }
            }

            // Edit Initiative Handler
            async function handleEditInitiative(event) {
                event.preventDefault();

                try {
                    const initiativeData = {
                        title: document.getElementById("editInitiativeTitle")
                            .value,
                        description: document.getElementById(
                            "editInitiativeDescription"
                        ).value,
                        status: document.getElementById("editInitiativeStatus")
                            .value,
                        targetDate: document.getElementById(
                            "editInitiativeTargetDate"
                        ).value,
                        isActive: document.getElementById(
                            "editInitiativeActive"
                        ).checked,
                    };

                    const initiativeId =
                        document.getElementById("editInitiativeId").value;

                    await apiRequest(
                        `/colleagues/initiatives/${initiativeId}`,
                        {
                            method: "PUT",
                            body: JSON.stringify(initiativeData),
                        }
                    );

                    hideEditInitiativeModal();
                    await loadInitiatives();
                    alert("Initiative updated successfully!");
                } catch (error) {
                    console.error("Failed to update initiative:", error);
                    alert("Failed to update initiative: " + error.message);
                }
            }
            // ===== FILE UPLOAD PREVIEW FUNCTIONALITY =====

            function setupFileUploadPreview(inputId, previewId) {
                const input = document.getElementById(inputId);
                const preview = document.getElementById(previewId);

                if (input && preview) {
                    input.addEventListener("change", function (e) {
                        const file = e.target.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = function (e) {
                                preview.innerHTML = `<img src="${e.target.result}" alt="Preview" style="max-width: 200px; border-radius: 8px;">`;
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                }
            }

            function setupMultipleFileUploadPreview(inputId, previewId) {
                const input = document.getElementById(inputId);
                const preview = document.getElementById(previewId);

                if (input && preview) {
                    input.addEventListener("change", function (e) {
                        const files = e.target.files;
                        if (files && files.length > 0) {
                            preview.innerHTML = ""; // Clear previous previews
                            console.log(` Selected ${files.length} files`);

                            Array.from(files).forEach((file, index) => {
                                const reader = new FileReader();
                                reader.onload = function (e) {
                                    const imgDiv =
                                        document.createElement("div");
                                    imgDiv.style.display = "inline-block";
                                    imgDiv.style.margin = "5px";
                                    imgDiv.innerHTML = `<img src="${
                                        e.target.result
                                    }" alt="Preview ${
                                        index + 1
                                    }" style="max-width: 150px; max-height: 150px; border-radius: 8px; object-fit: cover;">`;
                                    preview.appendChild(imgDiv);
                                };
                                reader.readAsDataURL(file);
                            });
                        }
                    });
                }
            }

            // ===== INITIALIZATION =====

            document.addEventListener("DOMContentLoaded", function () {
                console.log(" Initializing Admin Dashboard...");

                // Initialize file upload previews
                setupFileUploadPreview(
                    "addNewsImageInput",
                    "addNewsImagePreview"
                );
                setupFileUploadPreview(
                    "addEventImageInput",
                    "addEventImagePreview"
                );
                setupFileUploadPreview(
                    "addMainImageInput",
                    "addMainImagePreview"
                );
                setupMultipleFileUploadPreview(
                    "addGalleryImagesInput",
                    "addGalleryImagesPreview"
                );
                setupFileUploadPreview("addPhotoFileInput", "addPhotoPreview");
                setupFileUploadPreview(
                    "addDesignFileInput",
                    "addDesignPreview"
                );
                setupFileUploadPreview(
                    "addVideoFileInput",
                    "addVideoFilePreview"
                );
                setupFileUploadPreview(
                    "addVideoThumbnailInput",
                    "addVideoThumbnailPreview"
                );
                setupFileUploadPreview(
                    "addTeamMemberImageFile",
                    "addTeamMemberImagePreview"
                );

                // Edit modal file uploads
                setupFileUploadPreview(
                    "editNewsImageInput",
                    "editNewsImagePreview"
                );
                setupFileUploadPreview(
                    "editEventImageInput",
                    "editEventImagePreview"
                );
                setupFileUploadPreview(
                    "editMainImageInput",
                    "editMainImagePreview"
                );
                setupMultipleFileUploadPreview(
                    "editGalleryImagesInput",
                    "editGalleryImagesPreview"
                );
                setupFileUploadPreview(
                    "editVideoFileInput",
                    "editVideoFilePreview"
                );
                setupFileUploadPreview(
                    "editVideoThumbnailInput",
                    "editVideoThumbnailPreview"
                );
                setupFileUploadPreview(
                    "editTeamMemberImageFile",
                    "editTeamMemberImagePreview"
                );
                // Add these to your existing file upload preview setup
                setupFileUploadPreview(
                    "editPhotoFileInput",
                    "editPhotoPreview"
                );
                setupFileUploadPreview(
                    "editDesignFileInput",
                    "editDesignPreview"
                );
                // Attach form handlers
                const addNewsForm = document.getElementById("addNewsForm");
                if (addNewsForm) {
                    addNewsForm.addEventListener("submit", handleAddNews);
                }

                const addEventForm = document.getElementById("addEventForm");
                if (addEventForm) {
                    addEventForm.addEventListener("submit", handleAddEvent);
                }

                const addDesignProjectForm = document.getElementById(
                    "addDesignProjectForm"
                );
                if (addDesignProjectForm) {
                    addDesignProjectForm.addEventListener(
                        "submit",
                        handleAddDesignProject
                    );
                }

                const addResearchForm =
                    document.getElementById("addResearchForm");
                if (addResearchForm) {
                    addResearchForm.addEventListener(
                        "submit",
                        handleAddResearch
                    );
                }

                const addWorkshopForm =
                    document.getElementById("addWorkshopForm");
                if (addWorkshopForm) {
                    addWorkshopForm.addEventListener(
                        "submit",
                        handleAddWorkshop
                    );
                }

                const addPhotoForm = document.getElementById("addPhotoForm");
                if (addPhotoForm) {
                    addPhotoForm.addEventListener("submit", handleAddPhoto);
                }

                const addVideoForm = document.getElementById("addVideoForm");
                if (addVideoForm) {
                    addVideoForm.addEventListener("submit", handleAddVideo);
                }

                const addTutorialForm =
                    document.getElementById("addTutorialForm");
                if (addTutorialForm) {
                    addTutorialForm.addEventListener(
                        "submit",
                        handleAddTutorial
                    );
                }

                const addExhibitionForm =
                    document.getElementById("addExhibitionForm");
                if (addExhibitionForm) {
                    addExhibitionForm.addEventListener(
                        "submit",
                        handleAddExhibition
                    );
                }

                const addDesignForm = document.getElementById("addDesignForm");
                if (addDesignForm) {
                    addDesignForm.addEventListener(
                        "submit",
                        handleAddDesignProject
                    );
                }

                const addStoryForm = document.getElementById("addStoryForm");
                if (addStoryForm) {
                    addStoryForm.addEventListener("submit", handleAddStory);
                }

                const addTestimonialForm =
                    document.getElementById("addTestimonialForm");
                if (addTestimonialForm) {
                    addTestimonialForm.addEventListener(
                        "submit",
                        handleAddTestimonial
                    );
                }

                const addTeamMemberForm =
                    document.getElementById("addTeamMemberForm");
                if (addTeamMemberForm) {
                    addTeamMemberForm.addEventListener(
                        "submit",
                        handleAddTeamMember
                    );
                }

                const addInitiativeForm =
                    document.getElementById("addInitiativeForm");
                if (addInitiativeForm) {
                    addInitiativeForm.addEventListener(
                        "submit",
                        handleAddInitiative
                    );
                }
                const editNewsForm = document.getElementById("editNewsForm");
                if (editNewsForm) {
                    editNewsForm.addEventListener("submit", handleEditNews);
                }

                const editEventForm = document.getElementById("editEventForm");
                if (editEventForm) {
                    editEventForm.addEventListener("submit", handleEditEvent);
                }

                const editResearchForm =
                    document.getElementById("editResearchForm");
                if (editResearchForm) {
                    editResearchForm.addEventListener(
                        "submit",
                        handleEditResearch
                    );
                }

                const editDesignProjectForm = document.getElementById(
                    "editDesignProjectForm"
                );
                if (editDesignProjectForm) {
                    editDesignProjectForm.addEventListener(
                        "submit",
                        handleEditDesignProject
                    );
                }

                // Attach login handler
                const loginBtn = document.getElementById("loginBtn");
                if (loginBtn) {
                    loginBtn.addEventListener("click", handleLogin);
                    console.log(" Login button handler attached");
                }

                // Also allow login on form submit
                const loginForm = document.querySelector("#loginCard form");
                if (loginForm) {
                    loginForm.addEventListener("submit", function (e) {
                        e.preventDefault();
                        handleLogin();
                    });
                }

                // Check for existing authentication
                console.log(" Checking for existing authentication...");
                const token = getValidToken();
                if (token) {
                    console.log(" Valid token found, showing dashboard");
                    showDashboard();
                } else {
                    console.log(
                        " No valid token found, showing login screen"
                    );
                    showLogin();
                }

                // Add debug info to console
                console.log(" Admin Dashboard initialization complete");
                console.log(" Default credentials: admin / changeme");

                // Load saved settings
                loadSettings();
            });

            // Close modals when clicking overlay
            document
                .getElementById("overlay")
                .addEventListener("click", function () {
                    document.querySelectorAll(".modal").forEach((modal) => {
                        modal.classList.add("hidden");
                    });
                    this.classList.remove("active");
                });

            // Close modal when pressing Escape key
            document.addEventListener("keydown", function (e) {
                if (e.key === "Escape") {
                    document.querySelectorAll(".modal").forEach((modal) => {
                        modal.classList.add("hidden");
                    });
                    const overlay = document.getElementById("overlay");
                    if (overlay) overlay.classList.remove("active");
                }
            });
            // Add these to your existing event listeners in the initialization section
            const editWorkshopForm =
                document.getElementById("editWorkshopForm");
            if (editWorkshopForm) {
                editWorkshopForm.addEventListener("submit", handleEditWorkshop);
            }

            const editTutorialForm =
                document.getElementById("editTutorialForm");
            if (editTutorialForm) {
                editTutorialForm.addEventListener("submit", handleEditTutorial);
            }

            const editExhibitionForm =
                document.getElementById("editExhibitionForm");
            if (editExhibitionForm) {
                editExhibitionForm.addEventListener(
                    "submit",
                    handleEditExhibition
                );
            }

            const editPhotoForm = document.getElementById("editPhotoForm");
            if (editPhotoForm) {
                editPhotoForm.addEventListener("submit", handleEditPhoto);
            }

            const editVideoForm = document.getElementById("editVideoForm");
            if (editVideoForm) {
                editVideoForm.addEventListener("submit", handleEditVideo);
            }

            const editDesignForm = document.getElementById("editDesignForm");
            if (editDesignForm) {
                editDesignForm.addEventListener("submit", handleEditDesign);
            }

            const editTestimonialForm = document.getElementById(
                "editTestimonialForm"
            );
            if (editTestimonialForm) {
                editTestimonialForm.addEventListener(
                    "submit",
                    handleEditTestimonial
                );
            }

            const editStoryForm = document.getElementById("editStoryForm");
            if (editStoryForm) {
                editStoryForm.addEventListener("submit", handleEditStory);
            }

            const editTeamMemberForm =
                document.getElementById("editTeamMemberForm");
            if (editTeamMemberForm) {
                editTeamMemberForm.addEventListener(
                    "submit",
                    handleEditTeamMember
                );
            }

            const editInitiativeForm =
                document.getElementById("editInitiativeForm");
            if (editInitiativeForm) {
                editInitiativeForm.addEventListener(
                    "submit",
                    handleEditInitiative
                );
            }

            // ===== PLACEHOLDER FUNCTIONS FOR CRUD OPERATIONS =====

            async function toggleFeatured(section, type, id, featured) {
                try {
                    await apiRequest(`/${section}/${type}/${id}/feature`, {
                        method: "PUT",
                        body: JSON.stringify({ featured }),
                    });
                    // Reload the current tab based on section and type
                    switch (section) {
                        case "media":
                            showMediaTab(currentMediaTab);
                            break;
                        case "design":
                            showDesignTab(currentDesignTab);
                            break;
                        case "research":
                            showResearchTab(currentResearchTab);
                            break;
                        case "newsevents":
                            showNewsEventsTab(currentNewsEventsTab);
                            break;
                    }
                } catch (error) {
                    console.error("Failed to toggle featured:", error);
                    alert("Failed to update featured status: " + error.message);
                }
            }

            // Add these to your existing form handlers
            const editDesignProjectForm = document.getElementById(
                "editDesignProjectForm"
            );
            if (editDesignProjectForm) {
                editDesignProjectForm.addEventListener(
                    "submit",
                    handleEditDesignProject
                );
            }

            const editResearchForm =
                document.getElementById("editResearchForm");
            if (editResearchForm) {
                editResearchForm.addEventListener("submit", handleEditResearch);
            }

            // And implement the handler functions:
            async function handleEditDesignProject(event) {
                event.preventDefault();

                try {
                    const projectData = {
                        title: document.getElementById("editDesignProjectTitle")
                            .value,
                        summary: document.getElementById(
                            "editDesignProjectSummary"
                        ).value,
                        description: document.getElementById(
                            "editDesignProjectDescription"
                        ).value,
                        category: document.getElementById(
                            "editDesignProjectCategory"
                        ).value,
                        sector: document.getElementById(
                            "editDesignProjectSector"
                        ).value,
                        displayOrder:
                            parseInt(
                                document.getElementById(
                                    "editDesignProjectDisplayOrder"
                                ).value
                            ) || 0,
                        isFeatured: document.getElementById(
                            "editDesignProjectFeatured"
                        ).checked,
                        isPublished: document.getElementById(
                            "editDesignProjectPublished"
                        ).checked,
                        mainImage: null,
                        contentBlocks: [],
                    };

                    const projectId = document.getElementById(
                        "editDesignProjectId"
                    ).value;

                    // Upload main image
                    const mainImageFile =
                        document.getElementById("editMainImageInput").files[0];
                    if (mainImageFile) {
                        const uploadedImageUrl = await uploadFile(
                            mainImageFile,
                            "design-project"
                        );
                        projectData.mainImage = uploadedImageUrl;
                    }

                    // Process content blocks
                    console.log(` Processing ${editContentBlocks.length} content blocks...`);
                    for (const block of editContentBlocks) {
                        if (block.type === "text") {
                            const title = document.getElementById(`${block.id}-title`)?.value || "";
                            const content = document.getElementById(`${block.id}-content`)?.value || "";
                            projectData.contentBlocks.push({
                                type: "text",
                                title: title,
                                content: content,
                            });
                        } else if (block.type === "image") {
                            const caption = document.getElementById(`${block.id}-caption`)?.value || "";
                            let imageUrl = block.existingUrl || null;
                            
                            // Upload new image if file exists
                            if (block.file) {
                                imageUrl = await uploadFile(block.file, "design-content");
                            }
                            
                            if (imageUrl) {
                                projectData.contentBlocks.push({
                                    type: "image",
                                    caption: caption,
                                    url: imageUrl,
                                });
                            }
                        }
                    }
                    console.log(` Processed ${projectData.contentBlocks.length} content blocks`);

                    await apiRequest(`/design/admin/projects/${projectId}`, {
                        method: "PUT",
                        body: JSON.stringify(projectData),
                    });

                    hideEditDesignProjectModal();
                    await loadDesignProjects();
                    alert("Design project updated successfully!");
                } catch (error) {
                    console.error("Failed to update design project:", error);
                    alert("Failed to update design project: " + error.message);
                }
            }

            async function handleEditResearch(event) {
                event.preventDefault();

                try {
                    const researchData = {
                        title: document.getElementById("editResearchTitle")
                            .value,
                        abstract: document.getElementById(
                            "editResearchAbstract"
                        ).value,
                        content: document.getElementById("editResearchContent")
                            .value,
                        category: document.getElementById(
                            "editResearchCategory"
                        ).value,
                        authors: document.getElementById("editResearchAuthors")
                            .value,
                        publicationDate: document.getElementById(
                            "editResearchPublicationDate"
                        ).value,
                        mainImage: document.getElementById(
                            "editResearchMainImage"
                        ).value,
                        displayOrder: document.getElementById(
                            "editResearchDisplayOrder"
                        ).value,
                        isFeatured: document.getElementById(
                            "editResearchFeatured"
                        ).checked,
                        isPublished: document.getElementById(
                            "editResearchPublished"
                        ).checked,
                    };

                    const researchId =
                        document.getElementById("editResearchId").value;

                    await apiRequest(`/research/admin/articles/${researchId}`, {
                        method: "PUT",
                        body: JSON.stringify(researchData),
                    });

                    hideEditResearchModal();
                    await loadResearchArticles();
                    alert("Research article updated successfully!");
                } catch (error) {
                    console.error("Failed to update research article:", error);
                    alert(
                        "Failed to update research article: " + error.message
                    );
                }
            }

            async function deleteMediaItem(type, id) {
                try {
                    console.log(" Deleting media item:", { type, id });

                    await apiRequest(`/media/${type}/${id}`, {
                        method: "DELETE",
                    });

                    // Reload the current media tab
                    showMediaTab(currentMediaTab);
                    alert("Media item deleted successfully!");
                } catch (error) {
                    console.error("Failed to delete media item:", error);
                    alert("Failed to delete item: " + error.message);
                }
            }
            // Enhanced Edit Functions
            // Enhanced Edit Functions
            async function editWorkshop(workshop) {
                try {
                    // Load workshop data
                    const workshopData = await apiRequest(
                        `/education/workshops/${workshop.id}`
                    );

                    // Populate form
                    document.getElementById("editWorkshopId").value =
                        workshopData.id;
                    document.getElementById("editWorkshopTitle").value =
                        workshopData.title || "";
                    document.getElementById("editWorkshopDescription").value =
                        workshopData.description || "";
                    document.getElementById("editWorkshopInstructor").value =
                        workshopData.instructor || "";
                    document.getElementById("editWorkshopDate").value =
                        workshopData.date || "";
                    document.getElementById("editWorkshopTime").value =
                        workshopData.time || "";
                    document.getElementById("editWorkshopLocation").value =
                        workshopData.location || "";
                    document.getElementById("editWorkshopCapacity").value =
                        workshopData.capacity || "";
                    document.getElementById("editWorkshopPublished").checked =
                        workshopData.is_published || false;

                    showEditWorkshopModal();
                } catch (error) {
                    console.error("Failed to load workshop data:", error);
                    alert("Failed to load workshop data: " + error.message);
                }
            }

            async function editTutorial(tutorial) {
                try {
                    const tutorialData = await apiRequest(
                        `/education/tutorials/${tutorial.id}`
                    );

                    document.getElementById("editTutorialId").value =
                        tutorialData.id;
                    document.getElementById("editTutorialTitle").value =
                        tutorialData.title || "";
                    document.getElementById("editTutorialDescription").value =
                        tutorialData.description || "";
                    document.getElementById("editTutorialCategory").value =
                        tutorialData.category || "";
                    document.getElementById("editTutorialFormat").value =
                        tutorialData.format || "";
                    document.getElementById("editTutorialDuration").value =
                        tutorialData.duration || "";
                    document.getElementById("editTutorialLevel").value =
                        tutorialData.level || "beginner";
                    document.getElementById("editTutorialPublished").checked =
                        tutorialData.isPublished || false;

                    showEditTutorialModal();
                } catch (error) {
                    console.error("Failed to load tutorial data:", error);
                    alert("Failed to load tutorial data: " + error.message);
                }
            }

            async function editExhibition(exhibition) {
                try {
                    const exhibitionData = await apiRequest(
                        `/education/exhibitions/${exhibition.id}`
                    );

                    document.getElementById("editExhibitionId").value =
                        exhibitionData.id;
                    document.getElementById("editExhibitionTitle").value =
                        exhibitionData.title || "";
                    document.getElementById("editExhibitionDescription").value =
                        exhibitionData.description || "";
                    document.getElementById("editExhibitionStartDate").value =
                        exhibitionData.startDate || "";
                    document.getElementById("editExhibitionEndDate").value =
                        exhibitionData.endDate || "";
                    document.getElementById("editExhibitionLocation").value =
                        exhibitionData.location || "";
                    document.getElementById("editExhibitionCurator").value =
                        exhibitionData.curator || "";
                    document.getElementById("editExhibitionCuratorBio").value =
                        exhibitionData.curatorBio || "";
                    document.getElementById("editExhibitionVirtualTour").value =
                        exhibitionData.virtualTour || "";
                    document.getElementById("editExhibitionPublished").checked =
                        exhibitionData.isPublished || false;

                    showEditExhibitionModal();
                } catch (error) {
                    console.error("Failed to load exhibition data:", error);
                    alert("Failed to load exhibition data: " + error.message);
                }
            }

            async function editPhoto(photo) {
                try {
                    const photoData = await apiRequest(
                        `/media/photos/${photo.id}`
                    );

                    document.getElementById("editPhotoId").value = photoData.id;
                    document.getElementById("editPhotoTitle").value =
                        photoData.title || "";
                    document.getElementById("editPhotoDescription").value =
                        photoData.description || "";
                    document.getElementById("editPhotoCategory").value =
                        photoData.category || "Architecture";
                    document.getElementById("editPhotoFeatured").checked =
                        photoData.is_featured || false;
                    document.getElementById("editPhotoPublished").checked =
                        photoData.is_published || false;

                    // Set image preview if exists
                    if (photoData.image_url) {
                        document.getElementById(
                            "editPhotoPreview"
                        ).innerHTML = `<img src="${photoData.image_url}" alt="Preview" style="max-width: 200px; border-radius: 8px;">`;
                    }

                    // Load galleries and set current gallery
                    await loadExistingGalleriesForEdit();
                    const currentGallery = photoData.album || photoData.albumName || '';
                    
                    if (currentGallery) {
                        // Set to existing gallery mode
                        toggleEditGalleryMode('existing');
                        document.getElementById('editPhotoExistingGallery').value = currentGallery;
                    } else {
                        // Set to existing gallery mode by default
                        toggleEditGalleryMode('existing');
                    }

                    showEditPhotoModal();
                } catch (error) {
                    console.error("Failed to load photo data:", error);
                    alert("Failed to load photo data: " + error.message);
                }
            }

            async function editVideo(video) {
                try {
                    const videoData = await apiRequest(
                        `/media/videos/${video.id}`
                    );

                    document.getElementById("editVideoId").value = videoData.id;
                    document.getElementById("editVideoTitle").value =
                        videoData.title || "";
                    document.getElementById("editVideoDescription").value =
                        videoData.description || "";
                    document.getElementById("editVideoURL").value =
                        videoData.url || "";
                    document.getElementById("editVideoCategory").value =
                        videoData.category || "";
                    document.getElementById("editVideoFeatured").checked =
                        videoData.is_featured || false;
                    document.getElementById("editVideoPublished").checked =
                        videoData.is_published || false;

                    showEditVideoModal();
                } catch (error) {
                    console.error("Failed to load video data:", error);
                    alert("Failed to load video data: " + error.message);
                }
            }

            async function editDesign(design) {
                try {
                    const designData = await apiRequest(
                        `/media/designs/${design.id}`
                    );

                    document.getElementById("editDesignId").value =
                        designData.id;
                    document.getElementById("editDesignTitle").value =
                        designData.title || "";
                    document.getElementById("editDesignDescription").value =
                        designData.description || "";
                    document.getElementById("editDesignCategory").value =
                        designData.category || "Architecture";
                    document.getElementById("editDesignFeatured").checked =
                        designData.is_featured || false;
                    document.getElementById("editDesignPublished").checked =
                        designData.is_published || false;

                    // Set design preview if exists
                    if (designData.image_url || designData.design_url) {
                        const designUrl =
                            designData.image_url || designData.design_url;
                        document.getElementById(
                            "editDesignPreview"
                        ).innerHTML = `<img src="${designUrl}" alt="Preview" style="max-width: 200px; border-radius: 8px;">`;
                    }

                    showEditDesignModal();
                } catch (error) {
                    console.error("Failed to load design data:", error);
                    alert("Failed to load design data: " + error.message);
                }
            }

            async function editTestimonial(testimonial) {
                try {
                    const testimonialData = await apiRequest(
                        `/media/testimonials/${testimonial.id}`
                    );

                    document.getElementById("editTestimonialId").value =
                        testimonialData.id;
                    document.getElementById("editTestimonialName").value =
                        testimonialData.name || "";
                    document.getElementById("editTestimonialRole").value =
                        testimonialData.role || "";
                    document.getElementById(
                        "editTestimonialOrganization"
                    ).value = testimonialData.organization || "";
                    document.getElementById("editTestimonialQuote").value =
                        testimonialData.quote || "";
                    document.getElementById("editTestimonialProject").value =
                        testimonialData.project || "";
                    document.getElementById("editTestimonialRating").value =
                        testimonialData.rating || "5";
                    document.getElementById("editTestimonialFeatured").checked =
                        testimonialData.is_featured || false;
                    document.getElementById(
                        "editTestimonialPublished"
                    ).checked = testimonialData.is_published || false;

                    showEditTestimonialModal();
                } catch (error) {
                    console.error("Failed to load testimonial data:", error);
                    alert("Failed to load testimonial data: " + error.message);
                }
            }

            async function editStory(story) {
                try {
                    const storyData = await apiRequest(
                        `/get-involved/admin/stories/${story.id}`
                    );

                    document.getElementById("editStoryId").value = storyData.id;
                    document.getElementById("editStoryTitle").value =
                        storyData.story_title || "";
                    document.getElementById("editStoryContent").value =
                        storyData.story_content || "";
                    document.getElementById("editStoryAuthorName").value =
                        storyData.author_name || "";
                    document.getElementById("editStoryAuthorTitle").value =
                        storyData.author_title || "";
                    document.getElementById("editStoryCategory").value =
                        storyData.category || "";
                    document.getElementById("editStoryFeatured").checked =
                        storyData.is_featured || false;
                    document.getElementById("editStoryPublished").checked =
                        storyData.is_published || false;

                    showEditStoryModal();
                } catch (error) {
                    console.error("Failed to load story data:", error);
                    alert("Failed to load story data: " + error.message);
                }
            }

            async function editInitiative(initiative) {
                try {
                    const initiativeData = await apiRequest(
                        `/colleagues/initiatives/${initiative.id}`
                    );

                    document.getElementById("editInitiativeId").value =
                        initiativeData.id;
                    document.getElementById("editInitiativeTitle").value =
                        initiativeData.title || "";
                    document.getElementById("editInitiativeDescription").value =
                        initiativeData.description || "";
                    document.getElementById("editInitiativeStatus").value =
                        initiativeData.status || "planned";
                    document.getElementById("editInitiativeTargetDate").value =
                        initiativeData.target_date || "";
                    document.getElementById("editInitiativeActive").checked =
                        initiativeData.is_active || false;

                    showEditInitiativeModal();
                } catch (error) {
                    console.error("Failed to load initiative data:", error);
                    alert("Failed to load initiative data: " + error.message);
                }
            }

            // ===== MISSING EDIT FUNCTIONS - ADD THESE =====

            async function editDesignProject(project) {
                try {
                    const projectData = await apiRequest(
                        `/design/admin/projects/${project.id}`
                    );

                    // Populate the edit form
                    document.getElementById("editDesignProjectId").value =
                        projectData.id;
                    document.getElementById("editDesignProjectTitle").value =
                        projectData.title || "";
                    document.getElementById("editDesignProjectSummary").value =
                        projectData.summary || "";
                    document.getElementById(
                        "editDesignProjectDescription"
                    ).value = projectData.description || "";
                    document.getElementById("editDesignProjectCategory").value =
                        projectData.category || "academic";
                    document.getElementById("editDesignProjectSector").value =
                        projectData.sector || "";
                    document.getElementById(
                        "editDesignProjectDisplayOrder"
                    ).value = projectData.display_order || 0;
                    document.getElementById(
                        "editDesignProjectFeatured"
                    ).checked = projectData.is_featured || false;
                    document.getElementById(
                        "editDesignProjectPublished"
                    ).checked = projectData.is_published || false;

                    // Set image preview if exists
                    if (projectData.main_image) {
                        document.getElementById(
                            "editMainImagePreview"
                        ).innerHTML = `<img src="${projectData.main_image}" alt="Preview" style="max-width: 200px; border-radius: 8px;">`;
                    }

                    showEditDesignProjectModal();
                } catch (error) {
                    console.error("Failed to load design project data:", error);
                    alert("Failed to load project data: " + error.message);
                }
            }

            async function editResearchArticle(article) {
                try {
                    const articleData = await apiRequest(
                        `/research/admin/articles/${article.id}`
                    );

                    document.getElementById("editResearchId").value =
                        articleData.id;
                    document.getElementById("editResearchTitle").value =
                        articleData.title || "";
                    document.getElementById("editResearchAbstract").value =
                        articleData.abstract || "";
                    document.getElementById("editResearchContent").value =
                        articleData.content || "";
                    document.getElementById("editResearchCategory").value =
                        articleData.category || "sustainable";
                    document.getElementById("editResearchAuthors").value =
                        articleData.authors || "";
                    document.getElementById(
                        "editResearchPublicationDate"
                    ).value = articleData.publication_date || "";
                    document.getElementById("editResearchMainImage").value =
                        articleData.main_image || "";
                    document.getElementById("editResearchDisplayOrder").value =
                        articleData.display_order || 0;
                    document.getElementById("editResearchFeatured").checked =
                        articleData.is_featured || false;
                    document.getElementById("editResearchPublished").checked =
                        articleData.is_published || false;

                    showEditResearchModal();
                } catch (error) {
                    console.error(
                        "Failed to load research article data:",
                        error
                    );
                    alert(
                        "Failed to load research article data: " + error.message
                    );
                }
            }

            async function editNewsEvent(item) {
                try {
                    if (item.type === "news") {
                        const newsData = await apiRequest(
                            `/newsevents/news/${item.id}`
                        );

                        document.getElementById("editNewsId").value =
                            newsData.id;
                        document.getElementById("editNewsTitle").value =
                            newsData.title || "";
                        document.getElementById("editNewsExcerpt").value =
                            newsData.excerpt || "";
                        document.getElementById("editNewsContent").value =
                            newsData.content || "";
                        document.getElementById("editNewsCategory").value =
                            newsData.category || "";
                        document.getElementById("editNewsAuthor").value =
                            newsData.author || "";
                        document.getElementById("editNewsDate").value =
                            newsData.date || "";
                        document.getElementById("editNewsReadTime").value =
                            newsData.readTime || "";
                        document.getElementById("editNewsFeatured").checked =
                            newsData.is_featured || false;
                        document.getElementById("editNewsPublished").checked =
                            newsData.is_published || false;

                        // Set image preview if exists
                        if (newsData.image) {
                            document.getElementById(
                                "editNewsImagePreview"
                            ).innerHTML = `<img src="${newsData.image}" alt="Preview" style="max-width: 200px; border-radius: 8px;">`;
                        }

                        showEditNewsModal();
                    } else if (item.type === "event") {
                        const eventData = await apiRequest(
                            `/newsevents/events/${item.id}`
                        );

                        document.getElementById("editEventId").value =
                            eventData.id;
                        document.getElementById("editEventTitle").value =
                            eventData.title || "";
                        document.getElementById("editEventDescription").value =
                            eventData.description || "";
                        document.getElementById("editEventExcerpt").value =
                            eventData.excerpt || "";
                        document.getElementById("editEventDate").value =
                            eventData.eventDate || "";
                        document.getElementById("editEventTime").value =
                            eventData.eventTime || "";
                        document.getElementById("editEventLocation").value =
                            eventData.location || "";
                        document.getElementById("editEventCategory").value =
                            eventData.category || "";
                        document.getElementById("editEventAuthor").value =
                            eventData.author || "";
                        document.getElementById("editEventReadTime").value =
                            eventData.readTime || "";
                        document.getElementById("editEventFeatured").checked =
                            eventData.is_featured || false;
                        document.getElementById("editEventPublished").checked =
                            eventData.is_published || false;

                        // Set image preview if exists
                        if (eventData.image) {
                            document.getElementById(
                                "editEventImagePreview"
                            ).innerHTML = `<img src="${eventData.image}" alt="Preview" style="max-width: 200px; border-radius: 8px;">`;
                        }

                        showEditEventModal();
                    }
                } catch (error) {
                    console.error("Failed to load news/event data:", error);
                    alert("Failed to load data: " + error.message);
                }
            }

            async function updateTestimonialStatus(id, status) {
                try {
                    await apiRequest(`/media/testimonials/${id}/status`, {
                        method: "PUT",
                        body: JSON.stringify({ status }),
                    });
                    showMediaTab("testimonials");
                } catch (error) {
                    console.error(
                        "Failed to update testimonial status:",
                        error
                    );
                    alert("Failed to update status: " + error.message);
                }
            }

            async function toggleDesignProject(id, published) {
                try {
                    await apiRequest(`/design/admin/projects/${id}/publish`, {
                        method: "PUT",
                        body: JSON.stringify({ published }),
                    });
                    showDesignTab(currentDesignTab);
                } catch (error) {
                    console.error("Failed to toggle design project:", error);
                    alert("Failed to update publish status: " + error.message);
                }
            }

            async function toggleFeaturedDesignProject(id, featured) {
                try {
                    await apiRequest(`/design/admin/projects/${id}/feature`, {
                        method: "PUT",
                        body: JSON.stringify({ featured }),
                    });
                    showDesignTab(currentDesignTab);
                } catch (error) {
                    console.error(
                        "Failed to toggle featured design project:",
                        error
                    );
                    alert("Failed to update featured status: " + error.message);
                }
            }

            async function deleteDesignProject(id) {
                try {
                    await apiRequest(`/design/projects/${id}`, {
                        method: "DELETE",
                    });
                    showDesignTab(currentDesignTab);
                } catch (error) {
                    console.error("Failed to delete design project:", error);
                    alert("Failed to delete project: " + error.message);
                }
            }

            async function toggleResearchArticle(id, published) {
                try {
                    await apiRequest(`/research/admin/articles/${id}/publish`, {
                        method: "PUT",
                        body: JSON.stringify({ published }),
                    });
                    showResearchTab(currentResearchTab);
                } catch (error) {
                    console.error("Failed to toggle research article:", error);
                    alert("Failed to update publish status: " + error.message);
                }
            }

            async function toggleFeaturedResearchArticle(id, featured) {
                try {
                    await apiRequest(`/research/admin/articles/${id}/feature`, {
                        method: "PUT",
                        body: JSON.stringify({ featured }),
                    });
                    showResearchTab(currentResearchTab);
                } catch (error) {
                    console.error(
                        "Failed to toggle featured research article:",
                        error
                    );
                    alert("Failed to update featured status: " + error.message);
                }
            }

            async function deleteResearchArticle(id) {
                try {
                    await apiRequest(`/research/articles/${id}`, {
                        method: "DELETE",
                    });
                    showResearchTab(currentResearchTab);
                } catch (error) {
                    console.error("Failed to delete research article:", error);
                    alert("Failed to delete article: " + error.message);
                }
            }

            async function toggleNewsEvent(id, published, type) {
                try {
                    await apiRequest(`/newsevents/${type}/${id}/publish`, {
                        method: "PUT",
                        body: JSON.stringify({ published }),
                    });
                    showNewsEventsTab(currentNewsEventsTab);
                } catch (error) {
                    console.error("Failed to toggle news/event:", error);
                    alert("Failed to update publish status: " + error.message);
                }
            }

            async function toggleFeaturedNewsEvent(id, featured, type) {
                try {
                    await apiRequest(`/newsevents/${type}/${id}/feature`, {
                        method: "PUT",
                        body: JSON.stringify({ featured }),
                    });
                    showNewsEventsTab(currentNewsEventsTab);
                } catch (error) {
                    console.error(
                        "Failed to toggle featured news/event:",
                        error
                    );
                    alert("Failed to update featured status: " + error.message);
                }
            }

            async function deleteNewsEvent(id, type) {
                try {
                    // Convert singular to plural for API endpoint
                    const apiType = type === "event" ? "events" : type;
                    await apiRequest(`/newsevents/${apiType}/${id}`, {
                        method: "DELETE",
                    });
                    showNewsEventsTab(currentNewsEventsTab);
                } catch (error) {
                    console.error("Failed to delete news/event:", error);
                    alert("Failed to delete item: " + error.message);
                }
            }

            // Education edit functions
            function editWorkshop(workshop) {
                // Populate the form fields
                document.getElementById("editWorkshopId").value = workshop.id;
                document.getElementById("editWorkshopTitle").value =
                    workshop.title || "";
                document.getElementById("editWorkshopDescription").value =
                    workshop.description || "";
                document.getElementById("editWorkshopInstructor").value =
                    workshop.instructor || "";
                document.getElementById("editWorkshopDate").value =
                    workshop.date || "";
                document.getElementById("editWorkshopTime").value =
                    workshop.duration || "";
                document.getElementById("editWorkshopLocation").value =
                    workshop.location || "";
                document.getElementById("editWorkshopCapacity").value =
                    workshop.capacity || "";
                document.getElementById("editWorkshopPublished").checked =
                    workshop.isPublished || false;

                // Show the modal
                showEditWorkshopModal();
            }

            async function updateColleaguesContactStatus(id, status) {
                try {
                    await apiRequest(`/colleagues/contacts/${id}/status`, {
                        method: "PUT",
                        body: JSON.stringify({ status }),
                    });
                    showColleaguesTab("colleagues-contacts");
                } catch (error) {
                    console.error("Failed to update contact status:", error);
                    alert("Failed to update status: " + error.message);
                }
            }

            async function deleteColleaguesContact(id) {
                try {
                    await apiRequest(`/thecolleagueuni/contacts/${id}`, {
                        method: "DELETE",
                    });
                    showColleaguesTab("colleagues-contacts");
                } catch (error) {
                    console.error("Failed to delete contact:", error);
                    alert("Failed to delete contact: " + error.message);
                }
            }

            // Edit Team Member Function
            async function editTeamMember(member) {
                try {
                    const memberData = await apiRequest(
                        `/colleagues/team/${member.id}`
                    );
                    const data = memberData.data || memberData;

                    document.getElementById("editTeamMemberId").value = data.id;
                    document.getElementById("editTeamMemberName").value =
                        data.name || "";
                    document.getElementById("editTeamMemberRole").value =
                        data.role || "";
                    document.getElementById("editTeamMemberBio").value =
                        data.bio || "";
                    document.getElementById("editTeamMemberImageUrl").value =
                        data.image_url || "";
                    document.getElementById("editTeamMemberOrder").value =
                        data.display_order || 0;
                    document.getElementById("editTeamMemberActive").checked =
                        data.is_active !== false;

                    showEditTeamMemberModal();
                } catch (error) {
                    console.error("Failed to load team member data:", error);
                    alert("Failed to load team member data: " + error.message);
                }
            }

            async function toggleTeamMember(id, active) {
                try {
                    await apiRequest(`/colleagues/team/${id}/active`, {
                        method: "PUT",
                        body: JSON.stringify({ active }),
                    });
                    showColleaguesTab("colleagues-team");
                } catch (error) {
                    console.error("Failed to toggle team member:", error);
                    alert("Failed to update active status: " + error.message);
                }
            }

            async function deleteTeamMember(id) {
                try {
                    await apiRequest(`/colleagues/team/${id}`, {
                        method: "DELETE",
                    });
                    showColleaguesTab("colleagues-team");
                } catch (error) {
                    console.error("Failed to delete team member:", error);
                    alert("Failed to delete team member: " + error.message);
                }
            }

            async function toggleInitiative(id, active) {
                try {
                    await apiRequest(`/colleagues/initiatives/${id}/active`, {
                        method: "PUT",
                        body: JSON.stringify({ active }),
                    });
                    showColleaguesTab("colleagues-initiatives");
                } catch (error) {
                    console.error("Failed to toggle initiative:", error);
                    alert("Failed to update active status: " + error.message);
                }
            }

            async function deleteInitiative(id) {
                try {
                    await apiRequest(`/colleagues/initiatives/${id}`, {
                        method: "DELETE",
                    });
                    showColleaguesTab("colleagues-initiatives");
                } catch (error) {
                    console.error("Failed to delete initiative:", error);
                    alert("Failed to delete initiative: " + error.message);
                }
            }

            // Settings Functions
            function saveSettings() {
                try {
                    const settings = {
                        autoRefresh: document.getElementById(
                            "settingsAutoRefresh"
                        ).checked,
                        showDrafts:
                            document.getElementById("settingsShowDrafts")
                                .checked,
                        compactView: document.getElementById(
                            "settingsCompactView"
                        ).checked,
                        notifyNewSubmissions: document.getElementById(
                            "settingsNotifyNewSubmissions"
                        ).checked,
                        notifyNewComments: document.getElementById(
                            "settingsNotifyNewComments"
                        ).checked,
                        notifySystemAlerts: document.getElementById(
                            "settingsNotifySystemAlerts"
                        ).checked,
                    };

                    // Save to localStorage
                    localStorage.setItem(
                        "adminSettings",
                        JSON.stringify(settings)
                    );

                    alert("Settings saved successfully!");
                } catch (error) {
                    console.error("Failed to save settings:", error);
                    alert("Failed to save settings: " + error.message);
                }
            }

            function resetSettings() {
                if (
                    confirm(
                        "Are you sure you want to reset all settings to defaults?"
                    )
                ) {
                    try {
                        // Reset all toggles to default state
                        document.getElementById(
                            "settingsAutoRefresh"
                        ).checked = true;
                        document.getElementById(
                            "settingsShowDrafts"
                        ).checked = true;
                        document.getElementById(
                            "settingsCompactView"
                        ).checked = false;
                        document.getElementById(
                            "settingsNotifyNewSubmissions"
                        ).checked = true;
                        document.getElementById(
                            "settingsNotifyNewComments"
                        ).checked = true;
                        document.getElementById(
                            "settingsNotifySystemAlerts"
                        ).checked = true;

                        // Clear from localStorage
                        localStorage.removeItem("adminSettings");

                        alert("Settings reset to defaults!");
                    } catch (error) {
                        console.error("Failed to reset settings:", error);
                        alert("Failed to reset settings: " + error.message);
                    }
                }
            }

            function clearCache() {
                if (
                    confirm(
                        "Are you sure you want to clear the cache? This will refresh all data."
                    )
                ) {
                    try {
                        // Clear relevant cached data
                        sessionStorage.clear();

                        // Reload the current section to fetch fresh data
                        const currentSection = document.querySelector(
                            ".section:not(.hidden)"
                        );
                        if (currentSection) {
                            const sectionId = currentSection.id.replace(
                                "Section",
                                ""
                            );
                            // Trigger a reload of the current section
                            location.reload();
                        }

                        alert("Cache cleared successfully!");
                    } catch (error) {
                        console.error("Failed to clear cache:", error);
                        alert("Failed to clear cache: " + error.message);
                    }
                }
            }

            function loadSettings() {
                try {
                    const saved = localStorage.getItem("adminSettings");
                    if (saved) {
                        const settings = JSON.parse(saved);
                        document.getElementById("settingsAutoRefresh").checked =
                            settings.autoRefresh ?? true;
                        document.getElementById("settingsShowDrafts").checked =
                            settings.showDrafts ?? true;
                        document.getElementById("settingsCompactView").checked =
                            settings.compactView ?? false;
                        document.getElementById(
                            "settingsNotifyNewSubmissions"
                        ).checked = settings.notifyNewSubmissions ?? true;
                        document.getElementById(
                            "settingsNotifyNewComments"
                        ).checked = settings.notifyNewComments ?? true;
                        document.getElementById(
                            "settingsNotifySystemAlerts"
                        ).checked = settings.notifySystemAlerts ?? true;
                    }
                } catch (error) {
                    console.error("Failed to load settings:", error);
                }
            }

            // Edit News Function
            async function editNewsEvent(item) {
                try {
                    // Fetch the full news data
                    const newsData = await apiRequest(
                        `/newsevents/news/${item.id}`
                    );

                    // Populate the edit form
                    document.getElementById("editNewsId").value = newsData.id;
                    document.getElementById("editNewsTitle").value =
                        newsData.title || "";
                    document.getElementById("editNewsExcerpt").value =
                        newsData.excerpt || "";
                    document.getElementById("editNewsContent").value =
                        newsData.content || "";
                    document.getElementById("editNewsCategory").value =
                        newsData.category || "";
                    document.getElementById("editNewsAuthor").value =
                        newsData.author || "";
                    document.getElementById("editNewsDate").value =
                        newsData.date || "";
                    document.getElementById("editNewsReadTime").value =
                        newsData.readTime || "";
                    document.getElementById("editNewsFeatured").checked =
                        newsData.is_featured || false;
                    document.getElementById("editNewsPublished").checked =
                        newsData.is_published || false;

                    // Set image preview if exists
                    if (newsData.image) {
                        document.getElementById(
                            "editNewsImagePreview"
                        ).innerHTML = `<img src="${newsData.image}" alt="Preview" style="max-width: 200px; border-radius: 8px;">`;
                    }

                    showEditNewsModal();
                } catch (error) {
                    console.error("Failed to load news data:", error);
                    alert("Failed to load news data: " + error.message);
                }
            }

            // Edit Event Function
            async function editEvent(eventItem) {
                try {
                    const eventData = await apiRequest(
                        `/newsevents/events/${eventItem.id}`
                    );

                    document.getElementById("editEventId").value = eventData.id;
                    document.getElementById("editEventTitle").value =
                        eventData.title || "";
                    document.getElementById("editEventDescription").value =
                        eventData.description || "";
                    document.getElementById("editEventExcerpt").value =
                        eventData.excerpt || "";
                    document.getElementById("editEventDate").value =
                        eventData.eventDate || "";
                    document.getElementById("editEventTime").value =
                        eventData.eventTime || "";
                    document.getElementById("editEventLocation").value =
                        eventData.location || "";
                    document.getElementById("editEventCategory").value =
                        eventData.category || "";
                    document.getElementById("editEventAuthor").value =
                        eventData.author || "";
                    document.getElementById("editEventReadTime").value =
                        eventData.readTime || "";
                    document.getElementById("editEventFeatured").checked =
                        eventData.is_featured || false;
                    document.getElementById("editEventPublished").checked =
                        eventData.is_published || false;

                    // Set image preview if exists
                    if (eventData.image) {
                        document.getElementById(
                            "editEventImagePreview"
                        ).innerHTML = `<img src="${eventData.image}" alt="Preview" style="max-width: 200px; border-radius: 8px;">`;
                    }

                    showEditEventModal();
                } catch (error) {
                    console.error("Failed to load event data:", error);
                    alert("Failed to load event data: " + error.message);
                }
            }

            // Edit Research Article Function
            async function editResearchArticle(article) {
                try {
                    const researchData = await apiRequest(
                        `/research/admin/articles/${article.id}`
                    );

                    document.getElementById("editResearchId").value =
                        researchData.id;
                    document.getElementById("editResearchTitle").value =
                        researchData.title || "";
                    document.getElementById("editResearchAbstract").value =
                        researchData.abstract || "";
                    document.getElementById("editResearchContent").value =
                        researchData.content || "";
                    document.getElementById("editResearchCategory").value =
                        researchData.category || "";
                    document.getElementById("editResearchAuthors").value =
                        researchData.authors || "";
                    document.getElementById(
                        "editResearchPublicationDate"
                    ).value = researchData.publication_date || "";
                    document.getElementById("editResearchMainImage").value =
                        researchData.main_image || "";
                    document.getElementById("editResearchDisplayOrder").value =
                        researchData.display_order || 0;
                    document.getElementById("editResearchFeatured").checked =
                        researchData.is_featured || false;
                    document.getElementById("editResearchPublished").checked =
                        researchData.is_published || false;

                    showEditResearchModal();
                } catch (error) {
                    console.error("Failed to load research data:", error);
                    alert("Failed to load research data: " + error.message);
                }
            }

            // Edit Design Project Function
            async function editDesignProject(project) {
                try {
                    const projectData = await apiRequest(
                        `/design/admin/projects/${project.id}`
                    );

                    document.getElementById("editDesignProjectId").value =
                        projectData.id;
                    document.getElementById("editDesignProjectTitle").value =
                        projectData.title || "";
                    document.getElementById("editDesignProjectSummary").value =
                        projectData.summary || "";
                    document.getElementById(
                        "editDesignProjectDescription"
                    ).value = projectData.description || "";
                    document.getElementById("editDesignProjectCategory").value =
                        projectData.category || "";
                    document.getElementById("editDesignProjectSector").value =
                        projectData.sector || "";
                    document.getElementById(
                        "editDesignProjectDisplayOrder"
                    ).value = projectData.display_order || 0;
                    document.getElementById(
                        "editDesignProjectFeatured"
                    ).checked = projectData.is_featured || false;
                    document.getElementById(
                        "editDesignProjectPublished"
                    ).checked = projectData.is_published || false;

                    // Set image preview if exists
                    if (projectData.main_image) {
                        document.getElementById(
                            "editMainImagePreview"
                        ).innerHTML = `<img src="${projectData.main_image}" alt="Preview" style="max-width: 200px; border-radius: 8px;">`;
                    }

                    // Build and display current content preview
                    let previewHTML = '';
                    if (projectData.main_image) {
                        previewHTML += `<div style="margin-bottom: 1rem;">
                            <strong>Main Image:</strong><br/>
                            <img src="${projectData.main_image}" style="max-width: 100%; max-height: 200px; border-radius: 8px; margin-top: 0.5rem;" />
                        </div>`;
                    }
                    
                    if (projectData.description) {
                        previewHTML += `<div style="margin-bottom: 1rem;">
                            <strong>Description:</strong><br/>
                            <div style="margin-top: 0.5rem; line-height: 1.6;">${projectData.description}</div>
                        </div>`;
                    }

                    if (projectData.content_blocks && projectData.content_blocks.length > 0) {
                        previewHTML += `<div style="margin-bottom: 1rem;">
                            <strong>Content Blocks (${projectData.content_blocks.length}):</strong><br/>`;
                        
                        projectData.content_blocks.forEach((block, index) => {
                            if (block.type === 'text') {
                                previewHTML += `<div style="margin: 1rem 0; padding: 1rem; background: rgba(0,0,0,0.3); border-radius: 6px;">
                                    <div style="color: var(--accent-light); margin-bottom: 0.5rem;"><i class="fas fa-heading"></i> Text Block ${index + 1}</div>
                                    ${block.title ? `<strong>${block.title}</strong><br/>` : ''}
                                    <div style="margin-top: 0.5rem;">${block.content || 'No content'}</div>
                                </div>`;
                            } else if (block.type === 'image') {
                                previewHTML += `<div style="margin: 1rem 0; padding: 1rem; background: rgba(0,0,0,0.3); border-radius: 6px;">
                                    <div style="color: var(--accent-light); margin-bottom: 0.5rem;"><i class="fas fa-image"></i> Image Block ${index + 1}</div>
                                    ${block.caption ? `<div style="margin-bottom: 0.5rem;">${block.caption}</div>` : ''}
                                    <img src="${block.url}" style="max-width: 100%; border-radius: 6px;" />
                                </div>`;
                            }
                        });
                        previewHTML += `</div>`;
                    }

                    if (!previewHTML) {
                        previewHTML = '<p style="color: var(--text-muted);">No content available</p>';
                    }

                    document.getElementById('editProjectPreviewContent').innerHTML = previewHTML;

                    // Clear and populate content blocks
                    editContentBlocks.length = 0;
                    editContentBlockCounter = 0;
                    const container = document.getElementById(
                        "editContentBlocksContainer"
                    );
                    container.innerHTML = '<p id="editEmptyContentMessage" style="color: var(--text-muted); text-align: center;">No content blocks yet. Click the buttons above to add text or images.</p>';

                    // Load existing content blocks if available
                    if (projectData.content_blocks && Array.isArray(projectData.content_blocks)) {
                        projectData.content_blocks.forEach((block) => {
                            if (block.type === 'text') {
                                addEditContentBlock('text');
                                const lastBlock = editContentBlocks[editContentBlocks.length - 1];
                                document.getElementById(`${lastBlock.id}-title`).value = block.title || '';
                                document.getElementById(`${lastBlock.id}-content`).value = block.content || '';
                            } else if (block.type === 'image') {
                                addEditContentBlock('image');
                                const lastBlock = editContentBlocks[editContentBlocks.length - 1];
                                document.getElementById(`${lastBlock.id}-caption`).value = block.caption || '';
                                if (block.url) {
                                    const preview = document.getElementById(`${lastBlock.id}-preview`);
                                    preview.innerHTML = `<img src="${block.url}" style="max-width: 100%; border-radius: 8px; margin-top: 0.5rem;" />`;
                                    document.getElementById(`${lastBlock.id}-filename`).textContent = 'Existing image';
                                    lastBlock.existingUrl = block.url;
                                }
                            }
                        });
                    }

                    showEditDesignProjectModal();
                } catch (error) {
                    console.error("Failed to load design project data:", error);
                    alert(
                        "Failed to load design project data: " + error.message
                    );
                }
            }

            console.log(" Admin Dashboard JavaScript loaded successfully");
        </script>
    </body>
</html>
