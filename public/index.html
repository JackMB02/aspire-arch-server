<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aspire Design Lab - Admin Dashboard</title>
    
    <!-- External Resources -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Helvetica+Neue:wght@200;300;400&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #2c3e50;
            --primary-dark: #1a252f;
            --primary-light: #34495e;
            --accent: #3498db;
            --accent-light: #5dade2;
            --accent-dark: #2980b9;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --text-light: #ecf0f1;
            --text-muted: #bdc3c7;
            --bg-dark: #1e272e;
            --bg-card: #2d3436;
            --border-light: rgba(255,255,255,0.1);
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-dark);
            color: var(--text-light);
            line-height: 1.6;
        }

        .hidden {
            display: none !important;
        }

        /* Login Screen */
        #loginScreen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
        }

        .card {
            background: var(--bg-card);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 2rem;
            width: 100%;
            max-width: 500px;
            border: 1px solid var(--border-light);
        }

        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .login-header h1 {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 0.5rem;
            color: var(--accent-light);
        }

        .login-header p {
            color: var(--text-muted);
            font-size: 1rem;
        }

        .login-title {
            text-align: center;
            margin-bottom: 1.5rem;
            font-weight: 400;
            color: var(--text-light);
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .input-group input, 
        .input-group textarea, 
        .input-group select {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            color: var(--text-light);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .input-group input:focus, 
        .input-group textarea:focus, 
        .input-group select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .input-group.full-width {
            grid-column: 1 / -1;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .btn-primary, .btn-secondary, .btn-danger, .btn-warning {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: var(--text-light);
            border: 1px solid var(--border-light);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.15);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background: #e67e22;
        }

        .login-message {
            margin-top: 1rem;
            padding: 0.8rem;
            border-radius: 8px;
            text-align: center;
        }

        .text-danger {
            color: var(--danger);
        }

        .text-warning {
            color: var(--warning);
        }

        .text-success {
            color: var(--success);
        }

        /* Dashboard */
        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--primary-dark);
            border-right: 1px solid var(--border-light);
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            padding: 2rem 1.5rem 1.5rem;
            border-bottom: 1px solid var(--border-light);
        }

        .sidebar-header h1 {
            font-size: 1.5rem;
            font-weight: 300;
            margin-bottom: 0.5rem;
            color: var(--accent-light);
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .nav-menu {
            padding: 1rem 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.05);
            color: var(--text-light);
        }

        .nav-item.active {
            background: rgba(52, 152, 219, 0.1);
            color: var(--accent-light);
            border-left-color: var(--accent);
        }

        .nav-item i {
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            background: var(--primary);
            border-bottom: 1px solid var(--border-light);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1.2rem;
            cursor: pointer;
        }

        .header h2 {
            font-weight: 400;
            font-size: 1.5rem;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-details .user-name {
            font-weight: 500;
        }

        .user-details .user-role {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Content Sections */
        .content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .section {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border: 1px solid var(--border-light);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            background: rgba(52, 152, 219, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            font-size: 1.5rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 300;
            color: var(--text-light);
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-mini-card {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            border: 1px solid var(--border-light);
        }

        .stat-mini-value {
            font-size: 1.8rem;
            font-weight: 300;
            color: var(--text-light);
            margin-bottom: 0.5rem;
        }

        .stat-mini-label {
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        /* Items Grid */
        .items-grid {
            display: grid;
            gap: 1.5rem;
        }

        .item {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-light);
            display: flex;
            transition: all 0.3s ease;
        }

        .item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .item-content {
            flex: 1;
        }

        .item-title {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--text-light);
        }

        .item-meta {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .item-preview {
            color: var(--text-muted);
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .item-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .item-actions button {
            font-size: 0.8rem;
            padding: 0.5rem 1rem;
        }

        /* Submission Items */
        .submission-item {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-light);
            margin-bottom: 1rem;
        }

        .submission-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .submission-meta {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            margin-top: 1rem;
        }

        .status-badge {
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 500;
            text-transform: uppercase;
        }

        .status-new {
            background: rgba(52, 152, 219, 0.2);
            color: var(--accent);
        }

        .status-published {
            background: rgba(39, 174, 96, 0.2);
            color: var(--success);
        }

        .status-draft {
            background: rgba(243, 156, 18, 0.2);
            color: var(--warning);
        }

        .status-archived {
            background: rgba(149, 165, 166, 0.2);
            color: #95a5a6;
        }

        /* Tabs */
        .get-involved-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .get-involved-tab {
            padding: 0.8rem 1.5rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .get-involved-tab:hover {
            background: rgba(255,255,255,0.08);
        }

        .get-involved-tab.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .get-involved-content {
            display: none;
        }

        .get-involved-content.active {
            display: block;
        }

        /* Form Grid */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        /* Toggle Switch */
        .toggle-switch {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            cursor: pointer;
        }

        .toggle-switch input {
            display: none;
        }

        .toggle-slider {
            width: 50px;
            height: 24px;
            background: rgba(255,255,255,0.1);
            border-radius: 24px;
            position: relative;
            transition: all 0.3s ease;
        }

        .toggle-slider:before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--text-muted);
            top: 2px;
            left: 2px;
            transition: all 0.3s ease;
        }

        .toggle-switch input:checked + .toggle-slider {
            background: var(--accent);
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(26px);
            background: white;
        }

        /* File Upload */
        .file-upload-container {
            border: 2px dashed var(--border-light);
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload-container:hover {
            border-color: var(--accent);
            background: rgba(52, 152, 219, 0.05);
        }

        .upload-icon {
            font-size: 2rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .file-upload-container h4 {
            margin-bottom: 0.5rem;
            color: var(--text-light);
        }

        .file-upload-container p {
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }

        .upload-hint {
            font-size: 0.8rem;
        }

        .file-input {
            display: none;
        }

        .image-preview {
            margin-top: 1rem;
        }

        .image-preview img {
            max-width: 200px;
            border-radius: 8px;
            border: 1px solid var(--border-light);
        }

        .gallery-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .gallery-preview img {
            width: 100%;
            height: 80px;
            object-fit: cover;
            border-radius: 6px;
            border: 1px solid var(--border-light);
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal .card {
            max-height: 90vh;
            overflow-y: auto;
            max-width: 800px;
            width: 100%;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-light);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 400;
            color: var(--text-light);
        }

        /* Filter Buttons */
        .media-filter-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-light);
            border-radius: 20px;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .filter-btn:hover {
            background: rgba(255,255,255,0.08);
        }

        .filter-btn.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        /* Filter Section */
        .filter-section {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            border: 1px solid var(--border-light);
        }

        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }

        .overlay.active {
            display: block;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100%;
                z-index: 1000;
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .mobile-menu-btn {
                display: block;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .header {
                padding: 1rem;
            }

            .content {
                padding: 1rem;
            }

            .get-involved-tabs {
                flex-direction: column;
            }

            .get-involved-tab {
                justify-content: center;
            }

            .button-group {
                flex-direction: column;
            }

            .button-group button {
                width: 100%;
                justify-content: center;
            }

            .submission-header {
                flex-direction: column;
                gap: 1rem;
            }

            .submission-meta {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen">
        <div class="card" id="loginCard">
            <div class="login-header">
                <h1>Aspire Design Lab</h1>
                <p>Admin Dashboard</p>
            </div>
            
            <h3 class="login-title">Login to Dashboard</h3>
            
            <div class="input-group">
                <label for="username">Username</label>
                <input id="username" placeholder="Enter username" value="admin">
            </div>
            
            <div class="input-group">
                <label for="password">Password</label>
                <input id="password" placeholder="Enter password" type="password" value="changeme">
            </div>
            
            <div class="button-group login-buttons">
                <button id="loginBtn" class="btn-primary" type="button">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
            </div>
            
            <div id="loginMsg" class="login-message"></div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="hidden">
        <div class="dashboard-container">
            <!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h1>Aspire Design Lab</h1>
                    <div class="subtitle">Admin Dashboard</div>
                </div>
                
                <div class="nav-menu">
                    <div class="nav-item active" data-section="dashboard">
                        <i class="fas fa-chart-line"></i>
                        <span>Dashboard</span>
                    </div>
                    
                    <div class="nav-item" data-section="contact">
                        <i class="fas fa-envelope"></i>
                        <span>Contact Management</span>
                    </div>
                    
                    <div class="nav-item" data-section="getinvolved">
                        <i class="fas fa-handshake"></i>
                        <span>Get Involved</span>
                    </div>
                    
                    <div class="nav-item" data-section="media">
                        <i class="fas fa-images"></i>
                        <span>Media Library</span>
                    </div>
                    
                    <div class="nav-item" data-section="education">
                        <i class="fas fa-graduation-cap"></i>
                        <span>Education</span>
                    </div>
                    
                    <div class="nav-item" data-section="design">
                        <i class="fas fa-pencil-ruler"></i>
                        <span>Design Projects</span>
                    </div>
                    
                    <div class="nav-item" data-section="newsevents">
                        <i class="fas fa-newspaper"></i>
                        <span>News & Events</span>
                    </div>
                    
                    <div class="nav-item" data-section="research">
                        <i class="fas fa-lightbulb"></i>
                        <span>Research Insights</span>
                    </div>
                    
                    <div class="nav-item" data-section="colleagues">
                        <i class="fas fa-university"></i>
                        <span>Architecture Colleagues</span>
                    </div>
                    
                    <div class="nav-item" data-section="settings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <!-- Header -->
                <div class="header">
                    <div class="header-left">
                        <button class="mobile-menu-btn" id="mobileMenuBtn" type="button">
                            <i class="fas fa-bars"></i>
                        </button>
                        <h2 id="pageTitle">Dashboard</h2>
                    </div>
                    
                    <div class="header-right">
                        <div class="user-info">
                            <div class="user-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="user-details">
                                <div class="user-name">Admin User</div>
                                <div class="user-role">Administrator</div>
                            </div>
                        </div>
                        
                        <button id="logoutBtn" class="btn-secondary" type="button">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>

                <!-- Content Sections -->
                <div class="content">
                    <!-- Dashboard Section -->
                    <div id="dashboardSection" class="section">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-newspaper"></i>
                                </div>
                                <div class="stat-value" id="newsCount">12</div>
                                <div class="stat-label">News Items</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <div class="stat-value" id="eventsCount">8</div>
                                <div class="stat-label">Events</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-project-diagram"></i>
                                </div>
                                <div class="stat-value" id="projectCount">24</div>
                                <div class="stat-label">Projects</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-lightbulb"></i>
                                </div>
                                <div class="stat-value" id="insightCount">15</div>
                                <div class="stat-label">Research Insights</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <div class="stat-value" id="contactCount">32</div>
                                <div class="stat-label">Contact Submissions</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="stat-value" id="workshopCount">6</div>
                                <div class="stat-label">Workshops</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="stat-value" id="tutorialCount">18</div>
                                <div class="stat-label">Tutorials</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-university"></i>
                                </div>
                                <div class="stat-value" id="colleaguesContactCount">9</div>
                                <div class="stat-label">Colleagues Contacts</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-pencil-ruler"></i>
                                </div>
                                <div class="stat-value" id="designProjectsCount">27</div>
                                <div class="stat-label">Design Projects</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-chart-bar"></i>
                                </div>
                                <div class="stat-value" id="researchArticlesCount">14</div>
                                <div class="stat-label">Research Articles</div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Recent Activity</h3>
                            </div>
                            <div id="recentItems" class="items-grid">
                                <!-- Recent items will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Contact Management Section -->
                    <div id="contactSection" class="section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Contact Form Submissions</h3>
                                <div class="button-group">
                                    <button id="refreshSubmissions" class="btn-secondary" type="button">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                            </div>
                            
                            <div class="stats-row">
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="totalSubmissions">12</div>
                                    <div class="stat-mini-label">Total Submissions</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="newSubmissions">3</div>
                                    <div class="stat-mini-label">New</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="repliedSubmissions">7</div>
                                    <div class="stat-mini-label">Replied</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="recentSubmissions">5</div>
                                    <div class="stat-mini-label">Last 7 Days</div>
                                </div>
                            </div>
                            
                            <div id="submissionsList">
                                <!-- Submissions will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Get Involved Management Section -->
                    <div id="getinvolvedSection" class="section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Get Involved Management</h3>
                                <div class="button-group">
                                    <button id="refreshGetInvolved" class="btn-secondary" type="button">
                                        <i class="fas fa-sync-alt"></i> Refresh All
                                    </button>
                                </div>
                            </div>

                            <div class="get-involved-tabs">
                                <button class="get-involved-tab active" data-tab="membership" type="button">
                                    <i class="fas fa-users"></i> Membership Applications
                                </button>
                                <button class="get-involved-tab" data-tab="donations" type="button">
                                    <i class="fas fa-donate"></i> Donations
                                </button>
                                <button class="get-involved-tab" data-tab="feedback" type="button">
                                    <i class="fas fa-comment"></i> Feedback
                                </button>
                                <button class="get-involved-tab" data-tab="ideas" type="button">
                                    <i class="fas fa-lightbulb"></i> Ideas
                                </button>
                                <button class="get-involved-tab" data-tab="partnerships" type="button">
                                    <i class="fas fa-handshake"></i> Partnerships
                                </button>
                                <button class="get-involved-tab" data-tab="stories" type="button">
                                    <i class="fas fa-book"></i> Community Stories
                                </button>
                            </div>

                            <!-- Membership Applications -->
                            <div id="membershipTab" class="get-involved-content active">
                                <div class="card-header">
                                    <h4 class="card-title">Membership Applications</h4>
                                    <button class="btn-secondary" type="button" onclick="loadMembershipApplications()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                                <div id="membershipList" class="items-grid">
                                    <!-- Membership applications will be loaded here -->
                                </div>
                            </div>

                            <!-- Donations -->
                            <div id="donationsTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Donations</h4>
                                    <button class="btn-secondary" type="button" onclick="loadDonations()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                                <div id="donationsList" class="items-grid">
                                    <!-- Donations will be loaded here -->
                                </div>
                            </div>

                            <!-- Feedback -->
                            <div id="feedbackTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Feedback Submissions</h4>
                                    <button class="btn-secondary" type="button" onclick="loadFeedback()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                                <div id="feedbackList" class="items-grid">
                                    <!-- Feedback will be loaded here -->
                                </div>
                            </div>

                            <!-- Ideas -->
                            <div id="ideasTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Idea Submissions</h4>
                                    <button class="btn-secondary" type="button" onclick="loadIdeas()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                                <div id="ideasList" class="items-grid">
                                    <!-- Ideas will be loaded here -->
                                </div>
                            </div>

                            <!-- Partnerships -->
                            <div id="partnershipsTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Partnership Inquiries</h4>
                                    <button class="btn-secondary" type="button" onclick="loadPartnerships()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                                <div id="partnershipsList" class="items-grid">
                                    <!-- Partnerships will be loaded here -->
                                </div>
                            </div>

                            <!-- Community Stories -->
                            <div id="storiesTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Community Stories</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadStories()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddStoryModal()">
                                            <i class="fas fa-plus"></i> Add Story
                                        </button>
                                    </div>
                                </div>
                                <div id="storiesList" class="items-grid">
                                    <!-- Stories will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Media Library Section -->
                    <div id="mediaSection" class="section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Media Library Management</h3>
                                <div class="button-group">
                                    <button id="refreshMedia" class="btn-secondary" type="button">
                                        <i class="fas fa-sync-alt"></i> Refresh All
                                    </button>
                                </div>
                            </div>

                            <!-- Media Stats -->
                            <div class="stats-row">
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="photosCount">0</div>
                                    <div class="stat-mini-label">Photos</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="videosCount">0</div>
                                    <div class="stat-mini-label">Videos</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="designsCount">0</div>
                                    <div class="stat-mini-label">Designs</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="testimonialsCount">0</div>
                                    <div class="stat-mini-label">Testimonials</div>
                                </div>
                            </div>

                            <!-- Media Tabs -->
                            <div class="get-involved-tabs">
                                <button class="get-involved-tab active" data-tab="photos" type="button">
                                    <i class="fas fa-camera"></i> Photos
                                </button>
                                <button class="get-involved-tab" data-tab="videos" type="button">
                                    <i class="fas fa-video"></i> Videos
                                </button>
                                <button class="get-involved-tab" data-tab="designs" type="button">
                                    <i class="fas fa-paint-brush"></i> Designs
                                </button>
                                <button class="get-involved-tab" data-tab="testimonials" type="button">
                                    <i class="fas fa-quote-left"></i> Testimonials
                                </button>
                            </div>

                            <!-- Photos Tab -->
                            <div id="photosTab" class="get-involved-content active">
                                <div class="card-header">
                                    <h4 class="card-title">Photo Albums Management</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadPhotos()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddPhotoModal()">
                                            <i class="fas fa-plus"></i> Add Photo
                                        </button>
                                    </div>
                                </div>

                                <!-- Photo Categories - Inline Filter Buttons -->
                                <div class="media-filter-buttons">
                                    <button class="filter-btn active" data-category="All" type="button">All</button>
                                    <button class="filter-btn" data-category="Architecture" type="button">Architecture</button>
                                    <button class="filter-btn" data-category="Nature" type="button">Nature</button>
                                    <button class="filter-btn" data-category="Residential" type="button">Residential</button>
                                    <button class="filter-btn" data-category="Public" type="button">Public</button>
                                    <button class="filter-btn" data-category="Commercial" type="button">Commercial</button>
                                    <button class="filter-btn" data-category="Cultural" type="button">Cultural</button>
                                </div>

                                <div id="photosList" class="items-grid">
                                    <!-- Photos will be loaded here -->
                                </div>
                            </div>

                            <!-- Videos Tab -->
                            <div id="videosTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Video Stories Management</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadVideos()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddVideoModal()">
                                            <i class="fas fa-plus"></i> Add Video
                                        </button>
                                    </div>
                                </div>

                                <div id="videosList" class="items-grid">
                                    <!-- Videos will be loaded here -->
                                </div>
                            </div>

                            <!-- Designs Tab -->
                            <div id="designsTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Design Visualizations Management</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadDesigns()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddDesignModal()">
                                            <i class="fas fa-plus"></i> Add Design
                                        </button>
                                    </div>
                                </div>

                                <div id="designsList" class="items-grid">
                                    <!-- Designs will be loaded here -->
                                </div>
                            </div>

                            <!-- Testimonials Tab -->
                            <div id="testimonialsTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Community Testimonials Management</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadTestimonials()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddTestimonialModal()">
                                            <i class="fas fa-plus"></i> Add Testimonial
                                        </button>
                                    </div>
                                </div>

                                <div id="testimonialsList" class="items-grid">
                                    <!-- Testimonials will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Education Management Section -->
                    <div id="educationSection" class="section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Education Management</h3>
                                <div class="button-group">
                                    <button id="refreshEducation" class="btn-secondary" type="button">
                                        <i class="fas fa-sync-alt"></i> Refresh All
                                    </button>
                                </div>
                            </div>

                            <!-- Education Stats -->
                            <div class="stats-row">
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="workshopsCount">0</div>
                                    <div class="stat-mini-label">Workshops</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="tutorialsCount">0</div>
                                    <div class="stat-mini-label">Tutorials</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="exhibitionsCount">0</div>
                                    <div class="stat-mini-label">Exhibitions</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="totalEnrolled">0</div>
                                    <div class="stat-mini-label">Total Enrolled</div>
                                </div>
                            </div>

                            <!-- Education Tabs -->
                            <div class="get-involved-tabs">
                                <button class="get-involved-tab active" data-tab="workshops" type="button">
                                    <i class="fas fa-chalkboard-teacher"></i> Workshops
                                </button>
                                <button class="get-involved-tab" data-tab="tutorials" type="button">
                                    <i class="fas fa-book"></i> Tutorials
                                </button>
                                <button class="get-involved-tab" data-tab="exhibitions" type="button">
                                    <i class="fas fa-palette"></i> Exhibitions
                                </button>
                            </div>

                            <!-- Workshops Tab -->
                            <div id="workshopsTab" class="get-involved-content active">
                                <div class="card-header">
                                    <h4 class="card-title">Workshops Management</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadWorkshops()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddWorkshopModal()">
                                            <i class="fas fa-plus"></i> Add Workshop
                                        </button>
                                    </div>
                                </div>

                                <div id="workshopsList" class="items-grid">
                                    <!-- Workshops will be loaded here -->
                                </div>
                            </div>

                            <!-- Tutorials Tab -->
                            <div id="tutorialsTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Tutorials Management</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadTutorials()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddTutorialModal()">
                                            <i class="fas fa-plus"></i> Add Tutorial
                                        </button>
                                    </div>
                                </div>

                                <div id="tutorialsList" class="items-grid">
                                    <!-- Tutorials will be loaded here -->
                                </div>
                            </div>

                            <!-- Exhibitions Tab -->
                            <div id="exhibitionsTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Exhibitions Management</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadExhibitions()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddExhibitionModal()">
                                            <i class="fas fa-plus"></i> Add Exhibition
                                        </button>
                                    </div>
                                </div>

                                <div id="exhibitionsList" class="items-grid">
                                    <!-- Exhibitions will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Design Projects Management Section -->
                    <div id="designSection" class="section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Design Projects Management</h3>
                                <div class="button-group">
                                    <button id="refreshDesign" class="btn-secondary" type="button">
                                        <i class="fas fa-sync-alt"></i> Refresh All
                                    </button>
                                </div>
                            </div>

                            <!-- Design Projects Stats -->
                            <div class="stats-row">
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="designTotalProjects">0</div>
                                    <div class="stat-mini-label">Total Projects</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="designAcademicProjects">0</div>
                                    <div class="stat-mini-label">Academic Projects</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="designProfessionalProjects">0</div>
                                    <div class="stat-mini-label">Professional Projects</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="designCompetitionProjects">0</div>
                                    <div class="stat-mini-label">Competition Projects</div>
                                </div>
                            </div>

                            <!-- Design Projects Tabs -->
                            <div class="get-involved-tabs">
                                <button class="get-involved-tab active" data-tab="design-all" type="button">
                                    <i class="fas fa-th"></i> All Projects
                                </button>
                                <button class="get-involved-tab" data-tab="design-academic" type="button">
                                    <i class="fas fa-graduation-cap"></i> Academic
                                </button>
                                <button class="get-involved-tab" data-tab="design-professional" type="button">
                                    <i class="fas fa-briefcase"></i> Professional
                                </button>
                                <button class="get-involved-tab" data-tab="design-competition" type="button">
                                    <i class="fas fa-trophy"></i> Competition
                                </button>
                            </div>

                            <!-- All Projects Tab -->
                            <div id="design-allTab" class="get-involved-content active">
                                <div class="card-header">
                                    <h4 class="card-title">All Design Projects</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadDesignProjects()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddDesignProjectModal()">
                                            <i class="fas fa-plus"></i> Add Project
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="filter-section">
                                    <div class="input-group">
                                        <label for="sectorFilter">Filter by Sector:</label>
                                        <select id="sectorFilter" onchange="filterDesignProjectsBySector()">
                                            <option value="">All Sectors</option>
                                            <option value="residential">Residential Architecture</option>
                                            <option value="interior">Interior Design</option>
                                            <option value="refurbishment">Refurbishment</option>
                                            <option value="cultural">Cultural Architecture</option>
                                            <option value="commercial">Commercial & Offices</option>
                                            <option value="hospitality">Hospitality Architecture</option>
                                            <option value="public">Public Architecture</option>
                                            <option value="healthcare">Healthcare Architecture</option>
                                            <option value="educational">Educational Architecture</option>
                                            <option value="sports">Sports Architecture</option>
                                            <option value="religious">Religious Architecture</option>
                                            <option value="industrial">Industrial & Infrastructure</option>
                                            <option value="landscape">Landscape & Urbanism</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div id="designProjectsList" class="items-grid">
                                    <!-- Design projects will be loaded here -->
                                </div>
                            </div>

                            <!-- Academic Projects Tab -->
                            <div id="design-academicTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Academic Design Projects</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadAcademicProjects()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddDesignProjectModal('academic')">
                                            <i class="fas fa-plus"></i> Add Academic Project
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="filter-section">
                                    <div class="input-group">
                                        <label for="academicSectorFilter">Filter by Sector:</label>
                                        <select id="academicSectorFilter" onchange="filterAcademicProjectsBySector()">
                                            <option value="">All Sectors</option>
                                            <option value="residential">Residential Architecture</option>
                                            <option value="interior">Interior Design</option>
                                            <option value="refurbishment">Refurbishment</option>
                                            <option value="cultural">Cultural Architecture</option>
                                            <option value="commercial">Commercial & Offices</option>
                                            <option value="hospitality">Hospitality Architecture</option>
                                            <option value="public">Public Architecture</option>
                                            <option value="healthcare">Healthcare Architecture</option>
                                            <option value="educational">Educational Architecture</option>
                                            <option value="sports">Sports Architecture</option>
                                            <option value="religious">Religious Architecture</option>
                                            <option value="industrial">Industrial & Infrastructure</option>
                                            <option value="landscape">Landscape & Urbanism</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div id="academicProjectsList" class="items-grid">
                                    <!-- Academic projects will be loaded here -->
                                </div>
                            </div>

                            <!-- Professional Projects Tab -->
                            <div id="design-professionalTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Professional Design Projects</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadProfessionalProjects()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddDesignProjectModal('professional')">
                                            <i class="fas fa-plus"></i> Add Professional Project
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="filter-section">
                                    <div class="input-group">
                                        <label for="professionalSectorFilter">Filter by Sector:</label>
                                        <select id="professionalSectorFilter" onchange="filterProfessionalProjectsBySector()">
                                            <option value="">All Sectors</option>
                                            <option value="residential">Residential Architecture</option>
                                            <option value="interior">Interior Design</option>
                                            <option value="refurbishment">Refurbishment</option>
                                            <option value="cultural">Cultural Architecture</option>
                                            <option value="commercial">Commercial & Offices</option>
                                            <option value="hospitality">Hospitality Architecture</option>
                                            <option value="public">Public Architecture</option>
                                            <option value="healthcare">Healthcare Architecture</option>
                                            <option value="educational">Educational Architecture</option>
                                            <option value="sports">Sports Architecture</option>
                                            <option value="religious">Religious Architecture</option>
                                            <option value="industrial">Industrial & Infrastructure</option>
                                            <option value="landscape">Landscape & Urbanism</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div id="professionalProjectsList" class="items-grid">
                                    <!-- Professional projects will be loaded here -->
                                </div>
                            </div>

                            <!-- Competition Projects Tab -->
                            <div id="design-competitionTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Competition Design Projects</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadCompetitionProjects()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddDesignProjectModal('competition')">
                                            <i class="fas fa-plus"></i> Add Competition Project
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="filter-section">
                                    <div class="input-group">
                                        <label for="competitionSectorFilter">Filter by Sector:</label>
                                        <select id="competitionSectorFilter" onchange="filterCompetitionProjectsBySector()">
                                            <option value="">All Sectors</option>
                                            <option value="residential">Residential Architecture</option>
                                            <option value="interior">Interior Design</option>
                                            <option value="refurbishment">Refurbishment</option>
                                            <option value="cultural">Cultural Architecture</option>
                                            <option value="commercial">Commercial & Offices</option>
                                            <option value="hospitality">Hospitality Architecture</option>
                                            <option value="public">Public Architecture</option>
                                            <option value="healthcare">Healthcare Architecture</option>
                                            <option value="educational">Educational Architecture</option>
                                            <option value="sports">Sports Architecture</option>
                                            <option value="religious">Religious Architecture</option>
                                            <option value="industrial">Industrial & Infrastructure</option>
                                            <option value="landscape">Landscape & Urbanism</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div id="competitionProjectsList" class="items-grid">
                                    <!-- Competition projects will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- News & Events Management Section -->
                    <div id="newseventsSection" class="section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">News & Events Management</h3>
                                <div class="button-group">
                                    <button id="refreshNewsEvents" class="btn-secondary" type="button">
                                        <i class="fas fa-sync-alt"></i> Refresh All
                                    </button>
                                </div>
                            </div>

                            <!-- News & Events Stats -->
                            <div class="stats-row">
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="newsTotal">0</div>
                                    <div class="stat-mini-label">Total News</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="eventsTotal">0</div>
                                    <div class="stat-mini-label">Total Events</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="newsFeatured">0</div>
                                    <div class="stat-mini-label">Featured News</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="eventsFeatured">0</div>
                                    <div class="stat-mini-label">Featured Events</div>
                                </div>
                            </div>

                            <!-- News & Events Tabs -->
                            <div class="get-involved-tabs">
                                <button class="get-involved-tab active" data-tab="newsevents-all" type="button">
                                    <i class="fas fa-th"></i> All
                                </button>
                                <button class="get-involved-tab" data-tab="newsevents-news" type="button">
                                    <i class="fas fa-newspaper"></i> News
                                </button>
                                <button class="get-involved-tab" data-tab="newsevents-events" type="button">
                                    <i class="fas fa-calendar-alt"></i> Events
                                </button>
                            </div>

                            <!-- All News & Events Tab -->
                            <div id="newsevents-allTab" class="get-involved-content active">
                                <div class="card-header">
                                    <h4 class="card-title">All News & Events</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadAllNewsEvents()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddNewsModal()">
                                            <i class="fas fa-plus"></i> Add News
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddEventModal()">
                                            <i class="fas fa-plus"></i> Add Event
                                        </button>
                                    </div>
                                </div>
                                <div id="allNewsEventsList" class="items-grid">
                                    <!-- All news and events will be loaded here -->
                                </div>
                            </div>

                            <!-- News Tab -->
                            <div id="newsevents-newsTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">News Articles</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadNewsArticles()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddNewsModal()">
                                            <i class="fas fa-plus"></i> Add News
                                        </button>
                                    </div>
                                </div>
                                <div id="newsArticlesList" class="items-grid">
                                    <!-- News articles will be loaded here -->
                                </div>
                            </div>

                            <!-- Events Tab -->
                            <div id="newsevents-eventsTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Events</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadEvents()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddEventModal()">
                                            <i class="fas fa-plus"></i> Add Event
                                        </button>
                                    </div>
                                </div>
                                <div id="eventsList" class="items-grid">
                                    <!-- Events will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Research Insights Management Section -->
                    <div id="researchSection" class="section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Research Insights Management</h3>
                                <div class="button-group">
                                    <button id="refreshResearch" class="btn-secondary" type="button">
                                        <i class="fas fa-sync-alt"></i> Refresh All
                                    </button>
                                </div>
                            </div>

                            <!-- Research Insights Stats -->
                            <div class="stats-row">
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="researchTotalArticles">0</div>
                                    <div class="stat-mini-label">Total Articles</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="researchSustainable">0</div>
                                    <div class="stat-mini-label">Sustainable Design</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="researchClimate">0</div>
                                    <div class="stat-mini-label">Climate Resilience</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="researchSocial">0</div>
                                    <div class="stat-mini-label">Social Impact</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="researchFeatured">0</div>
                                    <div class="stat-mini-label">Featured</div>
                                </div>
                            </div>

                            <!-- Research Tabs -->
                            <div class="get-involved-tabs">
                                <button class="get-involved-tab active" data-tab="research-all" type="button">
                                    <i class="fas fa-th"></i> All Articles
                                </button>
                                <button class="get-involved-tab" data-tab="research-sustainable" type="button">
                                    <i class="fas fa-leaf"></i> Sustainable Design
                                </button>
                                <button class="get-involved-tab" data-tab="research-climate" type="button">
                                    <i class="fas fa-cloud-sun"></i> Climate Resilience
                                </button>
                                <button class="get-involved-tab" data-tab="research-social" type="button">
                                    <i class="fas fa-users"></i> Social Impact
                                </button>
                                <button class="get-involved-tab" data-tab="research-technological" type="button">
                                    <i class="fas fa-microchip"></i> Technological Innovation
                                </button>
                            </div>

                            <!-- All Articles Tab -->
                            <div id="research-allTab" class="get-involved-content active">
                                <div class="card-header">
                                    <h4 class="card-title">All Research Articles</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadResearchArticles()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddResearchModal()">
                                            <i class="fas fa-plus"></i> Add Article
                                        </button>
                                    </div>
                                </div>
                                <div id="researchArticlesList" class="items-grid">
                                    <!-- Research articles will be loaded here -->
                                </div>
                            </div>

                            <!-- Sustainable Design Tab -->
                            <div id="research-sustainableTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Sustainable Design Research</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadSustainableResearch()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddResearchModal('sustainable')">
                                            <i class="fas fa-plus"></i> Add Sustainable Article
                                        </button>
                                    </div>
                                </div>
                                <div id="sustainableResearchList" class="items-grid">
                                    <!-- Sustainable research articles will be loaded here -->
                                </div>
                            </div>

                            <!-- Climate Resilience Tab -->
                            <div id="research-climateTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Climate Resilience Research</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadClimateResearch()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddResearchModal('climate')">
                                            <i class="fas fa-plus"></i> Add Climate Article
                                        </button>
                                    </div>
                                </div>
                                <div id="climateResearchList" class="items-grid">
                                    <!-- Climate research articles will be loaded here -->
                                </div>
                            </div>

                            <!-- Social Impact Tab -->
                            <div id="research-socialTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Social Impact Research</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadSocialResearch()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddResearchModal('social')">
                                            <i class="fas fa-plus"></i> Add Social Article
                                        </button>
                                    </div>
                                </div>
                                <div id="socialResearchList" class="items-grid">
                                    <!-- Social research articles will be loaded here -->
                                </div>
                            </div>

                            <!-- Technological Innovation Tab -->
                            <div id="research-technologicalTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Technological Innovation Research</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadTechnologicalResearch()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddResearchModal('technological')">
                                            <i class="fas fa-plus"></i> Add Tech Article
                                        </button>
                                    </div>
                                </div>
                                <div id="technologicalResearchList" class="items-grid">
                                    <!-- Technological research articles will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Architecture Colleagues Lab Management Section -->
                    <div id="colleaguesSection" class="section hidden">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Architecture Colleagues Lab Management</h3>
                                <div class="button-group">
                                    <button id="refreshColleagues" class="btn-secondary" type="button">
                                        <i class="fas fa-sync-alt"></i> Refresh All
                                    </button>
                                </div>
                            </div>

                            <!-- Colleagues Stats -->
                            <div class="stats-row">
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="colleaguesTotalContacts">0</div>
                                    <div class="stat-mini-label">Total Contacts</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="colleaguesTeamMembers">0</div>
                                    <div class="stat-mini-label">Team Members</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="colleaguesInitiatives">0</div>
                                    <div class="stat-mini-label">Initiatives</div>
                                </div>
                                
                                <div class="stat-mini-card">
                                    <div class="stat-mini-value" id="colleaguesNewContacts">0</div>
                                    <div class="stat-mini-label">New Contacts</div>
                                </div>
                            </div>

                            <!-- Colleagues Tabs -->
                            <div class="get-involved-tabs">
                                <button class="get-involved-tab active" data-tab="colleagues-contacts" type="button">
                                    <i class="fas fa-envelope"></i> Contact Submissions
                                </button>
                                <button class="get-involved-tab" data-tab="colleagues-team" type="button">
                                    <i class="fas fa-users"></i> Team Members
                                </button>
                                <button class="get-involved-tab" data-tab="colleagues-initiatives" type="button">
                                    <i class="fas fa-rocket"></i> Initiatives
                                </button>
                                <button class="get-involved-tab" data-tab="colleagues-mission" type="button">
                                    <i class="fas fa-bullseye"></i> Mission & Values
                                </button>
                            </div>

                            <!-- Contacts Tab -->
                            <div id="colleagues-contactsTab" class="get-involved-content active">
                                <div class="card-header">
                                    <h4 class="card-title">Contact Form Submissions</h4>
                                    <button class="btn-secondary" type="button" onclick="loadColleaguesContacts()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                                <div id="colleaguesContactsList" class="items-grid">
                                    <!-- Contact submissions will be loaded here -->
                                </div>
                            </div>

                            <!-- Team Tab -->
                            <div id="colleagues-teamTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Team Members Management</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadColleaguesTeam()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddTeamMemberModal()">
                                            <i class="fas fa-plus"></i> Add Team Member
                                        </button>
                                    </div>
                                </div>
                                <div id="colleaguesTeamList" class="items-grid">
                                    <!-- Team members will be loaded here -->
                                </div>
                            </div>

                            <!-- Initiatives Tab -->
                            <div id="colleagues-initiativesTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Initiatives Management</h4>
                                    <div class="button-group">
                                        <button class="btn-secondary" type="button" onclick="loadColleaguesInitiatives()">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button class="btn-primary" type="button" onclick="showAddInitiativeModal()">
                                            <i class="fas fa-plus"></i> Add Initiative
                                        </button>
                                    </div>
                                </div>
                                <div id="colleaguesInitiativesList" class="items-grid">
                                    <!-- Initiatives will be loaded here -->
                                </div>
                            </div>

                            <!-- Mission & Values Tab -->
                            <div id="colleagues-missionTab" class="get-involved-content">
                                <div class="card-header">
                                    <h4 class="card-title">Mission & Values Management</h4>
                                    <button class="btn-secondary" type="button" onclick="loadColleaguesMission()">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                </div>
                                <div id="colleaguesMissionContent">
                                    <!-- Mission and values will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Section -->
                    <div id="settingsSection" class="section hidden">
                        <div class="card">
                            <h3 class="card-title">Settings</h3>
                            <p class="settings-placeholder">Settings panel coming soon...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- ===== ADD MODALS SECTION ===== -->
    
    <!-- Add News Modal -->
    <div id="addNewsModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add News Article</h3>
                <button class="btn-secondary" type="button" onclick="hideAddNewsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addNewsForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addNewsTitle">Title *</label>
                        <input id="addNewsTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addNewsExcerpt">Excerpt *</label>
                        <textarea id="addNewsExcerpt" required></textarea>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addNewsContent">Content *</label>
                        <textarea id="addNewsContent" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addNewsCategory">Category</label>
                        <input id="addNewsCategory" type="text" placeholder="e.g., Announcement, Award">
                    </div>
                    
                    <div class="input-group">
                        <label for="addNewsAuthor">Author *</label>
                        <input id="addNewsAuthor" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addNewsDate">Date *</label>
                        <input id="addNewsDate" type="date" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addNewsReadTime">Read Time</label>
                        <input id="addNewsReadTime" type="text" placeholder="e.g., 3 min read">
                    </div>
                    
                    <!-- News Image Upload -->
                    <div class="input-group full-width">
                        <label for="addNewsImage">News Image</label>
                        <div class="file-upload-container" onclick="document.getElementById('addNewsImageInput').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h4>Upload News Image</h4>
                            <p>Click to browse or drag and drop</p>
                            <p class="upload-hint">Recommended: 1200x800px, max 5MB</p>
                            <input type="file" id="addNewsImageInput" class="file-input" accept="image/*">
                        </div>
                        <div id="addNewsImagePreview" class="image-preview"></div>
                    </div>

                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addNewsFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addNewsPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add News
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddNewsModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Event Modal -->
    <div id="addEventModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Event</h3>
                <button class="btn-secondary" type="button" onclick="hideAddEventModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addEventForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addEventTitle">Title *</label>
                        <input id="addEventTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addEventDescription">Description *</label>
                        <textarea id="addEventDescription" required></textarea>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addEventExcerpt">Excerpt *</label>
                        <textarea id="addEventExcerpt" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addEventDate">Event Date *</label>
                        <input id="addEventDate" type="date" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addEventTime">Event Time *</label>
                        <input id="addEventTime" type="text" placeholder="e.g., 2:00 PM - 5:00 PM" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addEventLocation">Location *</label>
                        <input id="addEventLocation" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addEventCategory">Category</label>
                        <input id="addEventCategory" type="text" placeholder="e.g., Workshop, Conference">
                    </div>
                    
                    <div class="input-group">
                        <label for="addEventAuthor">Author *</label>
                        <input id="addEventAuthor" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addEventReadTime">Read Time</label>
                        <input id="addEventReadTime" type="text" placeholder="e.g., 2 min read">
                    </div>
                    
                    <!-- Event Image Upload -->
                    <div class="input-group full-width">
                        <label for="addEventImage">Event Image</label>
                        <div class="file-upload-container" onclick="document.getElementById('addEventImageInput').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h4>Upload Event Image</h4>
                            <p>Click to browse or drag and drop</p>
                            <p class="upload-hint">Recommended: 1200x800px, max 5MB</p>
                            <input type="file" id="addEventImageInput" class="file-input" accept="image/*">
                        </div>
                        <div id="addEventImagePreview" class="image-preview"></div>
                    </div>

                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addEventFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addEventPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Event
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddEventModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Design Project Modal -->
    <div id="addDesignProjectModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Design Project</h3>
                <button class="btn-secondary" type="button" onclick="hideAddDesignProjectModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addDesignProjectForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addDesignProjectTitle">Title *</label>
                        <input id="addDesignProjectTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addDesignProjectSummary">Summary *</label>
                        <textarea id="addDesignProjectSummary" required></textarea>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addDesignProjectDescription">Description *</label>
                        <textarea id="addDesignProjectDescription" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addDesignProjectCategory">Category *</label>
                        <select id="addDesignProjectCategory" required>
                            <option value="academic">Academic</option>
                            <option value="professional">Professional</option>
                            <option value="competition">Competition</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="addDesignProjectSector">Sector *</label>
                        <select id="addDesignProjectSector" required>
                            <option value="">Select Sector</option>
                            <option value="residential">Residential Architecture</option>
                            <option value="interior">Interior Design</option>
                            <option value="refurbishment">Refurbishment</option>
                            <option value="cultural">Cultural Architecture</option>
                            <option value="commercial">Commercial & Offices</option>
                            <option value="hospitality">Hospitality Architecture</option>
                            <option value="public">Public Architecture</option>
                            <option value="healthcare">Healthcare Architecture</option>
                            <option value="educational">Educational Architecture</option>
                            <option value="sports">Sports Architecture</option>
                            <option value="religious">Religious Architecture</option>
                            <option value="industrial">Industrial & Infrastructure</option>
                            <option value="landscape">Landscape & Urbanism</option>
                        </select>
                    </div>
                    
                    <!-- Main Image Upload -->
                    <div class="input-group full-width">
                        <label for="addDesignProjectMainImage">Main Image *</label>
                        <div class="file-upload-container" onclick="document.getElementById('addMainImageInput').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h4>Upload Main Image</h4>
                            <p>Click to browse or drag and drop</p>
                            <p class="upload-hint">Recommended: 1200x800px, max 5MB</p>
                            <input type="file" id="addMainImageInput" class="file-input" accept="image/*" required>
                        </div>
                        <div id="addMainImagePreview" class="image-preview"></div>
                    </div>

                    <div class="input-group">
                        <label for="addDesignProjectDisplayOrder">Display Order</label>
                        <input id="addDesignProjectDisplayOrder" type="number" min="0" value="0">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addDesignProjectFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addDesignProjectPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Project
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddDesignProjectModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Research Article Modal -->
    <div id="addResearchModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Research Article</h3>
                <button class="btn-secondary" type="button" onclick="hideAddResearchModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addResearchForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addResearchTitle">Title *</label>
                        <input id="addResearchTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addResearchAbstract">Abstract *</label>
                        <textarea id="addResearchAbstract" required placeholder="Brief summary of the research"></textarea>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addResearchContent">Full Content *</label>
                        <textarea id="addResearchContent" required placeholder="Detailed research content"></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addResearchCategory">Category *</label>
                        <select id="addResearchCategory" required>
                            <option value="sustainable">Sustainable Design</option>
                            <option value="climate">Climate Resilience</option>
                            <option value="social">Social Impact</option>
                            <option value="technological">Technological Innovation</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="addResearchAuthors">Authors *</label>
                        <input id="addResearchAuthors" type="text" required placeholder="John Doe, Jane Smith">
                    </div>
                    
                    <div class="input-group">
                        <label for="addResearchPublicationDate">Publication Date</label>
                        <input id="addResearchPublicationDate" type="date">
                    </div>
                    
                    <div class="input-group">
                        <label for="addResearchMainImage">Main Image URL</label>
                        <input id="addResearchMainImage" type="text" placeholder="/images/research/image.jpg">
                    </div>
                    
                    <div class="input-group">
                        <label for="addResearchDisplayOrder">Display Order</label>
                        <input id="addResearchDisplayOrder" type="number" min="0" value="0">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addResearchFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addResearchPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Article
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddResearchModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Workshop Modal -->
    <div id="addWorkshopModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Workshop</h3>
                <button class="btn-secondary" type="button" onclick="hideAddWorkshopModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addWorkshopForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addWorkshopTitle">Title *</label>
                        <input id="addWorkshopTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addWorkshopDescription">Description *</label>
                        <textarea id="addWorkshopDescription" required placeholder="Workshop description..."></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addWorkshopInstructor">Instructor *</label>
                        <input id="addWorkshopInstructor" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addWorkshopDate">Date *</label>
                        <input id="addWorkshopDate" type="date" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addWorkshopTime">Time *</label>
                        <input id="addWorkshopTime" type="text" placeholder="e.g., 2:00 PM - 4:00 PM" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addWorkshopLocation">Location</label>
                        <input id="addWorkshopLocation" type="text" placeholder="Online or physical location">
                    </div>
                    
                    <div class="input-group">
                        <label for="addWorkshopCapacity">Capacity</label>
                        <input id="addWorkshopCapacity" type="number" placeholder="Maximum participants">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addWorkshopPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Workshop
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddWorkshopModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Team Member Modal -->
    <div id="addTeamMemberModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Team Member</h3>
                <button class="btn-secondary" type="button" onclick="hideAddTeamMemberModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addTeamMemberForm">
                <div class="form-grid">
                    <div class="input-group">
                        <label for="addTeamMemberName">Name *</label>
                        <input id="addTeamMemberName" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addTeamMemberRole">Role *</label>
                        <input id="addTeamMemberRole" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addTeamMemberBio">Bio *</label>
                        <textarea id="addTeamMemberBio" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addTeamMemberImageFile">Profile Image</label>
                        <input type="file" id="addTeamMemberImageFile" accept="image/*">
                        <small>Optional: Team member photo</small>
                    </div>
                    
                    <div class="input-group">
                        <label for="addTeamMemberImageUrl">Or Image URL</label>
                        <input id="addTeamMemberImageUrl" type="url">
                    </div>
                    
                    <div class="input-group">
                        <label for="addTeamMemberOrder">Display Order</label>
                        <input id="addTeamMemberOrder" type="number" min="0" value="0">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addTeamMemberActive" checked>
                            <span class="toggle-slider"></span>
                            <span>Active</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Team Member
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddTeamMemberModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Photo Modal -->
    <div id="addPhotoModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Photo</h3>
                <button class="btn-secondary" type="button" onclick="hideAddPhotoModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addPhotoForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addPhotoTitle">Title *</label>
                        <input id="addPhotoTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addPhotoDescription">Description</label>
                        <textarea id="addPhotoDescription"></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addPhotoCategory">Category *</label>
                        <select id="addPhotoCategory" required>
                            <option value="Architecture">Architecture</option>
                            <option value="Nature">Nature</option>
                            <option value="Residential">Residential</option>
                            <option value="Public">Public</option>
                            <option value="Commercial">Commercial</option>
                            <option value="Cultural">Cultural</option>
                        </select>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addPhotoFileInput">Photo Upload *</label>
                        <div class="file-upload-container" onclick="document.getElementById('addPhotoFileInput').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h4>Upload Photo</h4>
                            <p>Click to browse or drag and drop</p>
                            <p class="upload-hint">Recommended: 1200x800px, max 5MB</p>
                            <input type="file" id="addPhotoFileInput" class="file-input" accept="image/*" required>
                        </div>
                        <div id="addPhotoPreview" class="image-preview"></div>
                    </div>

                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addPhotoFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addPhotoPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Photo
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddPhotoModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Story Modal -->
    <div id="addStoryModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Community Story</h3>
                <button class="btn-secondary" type="button" onclick="hideAddStoryModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addStoryForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addStoryTitle">Story Title *</label>
                        <input id="addStoryTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addStoryContent">Story Content *</label>
                        <textarea id="addStoryContent" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addStoryAuthorName">Author Name *</label>
                        <input id="addStoryAuthorName" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addStoryAuthorTitle">Author Title</label>
                        <input id="addStoryAuthorTitle" type="text" placeholder="e.g., Community Member, Volunteer">
                    </div>
                    
                    <div class="input-group">
                        <label for="addStoryCategory">Category</label>
                        <input id="addStoryCategory" type="text" placeholder="e.g., Volunteer Experience, Success Story">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addStoryFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addStoryPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Story
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddStoryModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Testimonial Modal -->
    <div id="addTestimonialModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Testimonial</h3>
                <button class="btn-secondary" type="button" onclick="hideAddTestimonialModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addTestimonialForm">
                <div class="form-grid">
                    <div class="input-group">
                        <label for="addTestimonialName">Name *</label>
                        <input id="addTestimonialName" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addTestimonialRole">Role/Position *</label>
                        <input id="addTestimonialRole" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addTestimonialOrganization">Organization</label>
                        <input id="addTestimonialOrganization" type="text">
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addTestimonialQuote">Testimonial Quote *</label>
                        <textarea id="addTestimonialQuote" required placeholder="What they said about us..."></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addTestimonialProject">Related Project</label>
                        <input id="addTestimonialProject" type="text">
                    </div>
                    
                    <div class="input-group">
                        <label for="addTestimonialRating">Rating (1-5)</label>
                        <select id="addTestimonialRating">
                            <option value="5">5 Stars</option>
                            <option value="4">4 Stars</option>
                            <option value="3">3 Stars</option>
                            <option value="2">2 Stars</option>
                            <option value="1">1 Star</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addTestimonialFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addTestimonialPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Testimonial
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddTestimonialModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Initiative Modal -->
    <div id="addInitiativeModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Initiative</h3>
                <button class="btn-secondary" type="button" onclick="hideAddInitiativeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addInitiativeForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addInitiativeTitle">Title *</label>
                        <input id="addInitiativeTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addInitiativeDescription">Description *</label>
                        <textarea id="addInitiativeDescription" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addInitiativeStatus">Status *</label>
                        <select id="addInitiativeStatus" required>
                            <option value="planned">Planned</option>
                            <option value="in_progress">In Progress</option>
                            <option value="completed">Completed</option>
                            <option value="on_hold">On Hold</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="addInitiativeTargetDate">Target Date</label>
                        <input id="addInitiativeTargetDate" type="date">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addInitiativeActive" checked>
                            <span class="toggle-slider"></span>
                            <span>Active</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Initiative
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddInitiativeModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Video Modal -->
    <div id="addVideoModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Video</h3>
                <button class="btn-secondary" type="button" onclick="hideAddVideoModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addVideoForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addVideoTitle">Title *</label>
                        <input id="addVideoTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addVideoDescription">Description</label>
                        <textarea id="addVideoDescription"></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addVideoURL">Video URL *</label>
                        <input id="addVideoURL" type="url" required placeholder="https://youtube.com/embed/...">
                    </div>
                    
                    <div class="input-group">
                        <label for="addVideoCategory">Category</label>
                        <input id="addVideoCategory" type="text" placeholder="e.g., Tutorial, Project Showcase">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addVideoFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addVideoPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Video
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddVideoModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Tutorial Modal -->
    <div id="addTutorialModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Tutorial</h3>
                <button class="btn-secondary" type="button" onclick="hideAddTutorialModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addTutorialForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addTutorialTitle">Title *</label>
                        <input id="addTutorialTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addTutorialDescription">Description *</label>
                        <textarea id="addTutorialDescription" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addTutorialInstructor">Instructor *</label>
                        <input id="addTutorialInstructor" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addTutorialDuration">Duration</label>
                        <input id="addTutorialDuration" type="text" placeholder="e.g., 2 hours">
                    </div>
                    
                    <div class="input-group">
                        <label for="addTutorialLevel">Level</label>
                        <select id="addTutorialLevel">
                            <option value="beginner">Beginner</option>
                            <option value="intermediate">Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addTutorialPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Tutorial
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddTutorialModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Exhibition Modal -->
    <div id="addExhibitionModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Exhibition</h3>
                <button class="btn-secondary" type="button" onclick="hideAddExhibitionModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addExhibitionForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addExhibitionTitle">Title *</label>
                        <input id="addExhibitionTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addExhibitionDescription">Description *</label>
                        <textarea id="addExhibitionDescription" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addExhibitionStartDate">Start Date *</label>
                        <input id="addExhibitionStartDate" type="date" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addExhibitionEndDate">End Date *</label>
                        <input id="addExhibitionEndDate" type="date" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="addExhibitionLocation">Location</label>
                        <input id="addExhibitionLocation" type="text">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addExhibitionPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Exhibition
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddExhibitionModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Design Modal -->
    <div id="addDesignModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Add Design</h3>
                <button class="btn-secondary" type="button" onclick="hideAddDesignModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addDesignForm">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="addDesignTitle">Title *</label>
                        <input id="addDesignTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addDesignDescription">Description</label>
                        <textarea id="addDesignDescription"></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="addDesignCategory">Category *</label>
                        <select id="addDesignCategory" required>
                            <option value="Architecture">Architecture</option>
                            <option value="Interior">Interior Design</option>
                            <option value="Urban">Urban Planning</option>
                            <option value="Landscape">Landscape</option>
                        </select>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="addDesignFileInput">Design File Upload *</label>
                        <div class="file-upload-container" onclick="document.getElementById('addDesignFileInput').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h4>Upload Design File</h4>
                            <p>Click to browse or drag and drop</p>
                            <p class="upload-hint">Supports: JPG, PNG, PDF, max 10MB</p>
                            <input type="file" id="addDesignFileInput" class="file-input" accept="image/*,.pdf" required>
                        </div>
                        <div id="addDesignPreview" class="image-preview"></div>
                    </div>

                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addDesignFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="addDesignPublished" checked>
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Add Design
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideAddDesignModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ===== EDIT MODALS SECTION ===== -->

    <!-- Edit News Modal -->
    <div id="editNewsModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Edit News Article</h3>
                <button class="btn-secondary" type="button" onclick="hideEditNewsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="editNewsForm">
                <input type="hidden" id="editNewsId">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="editNewsTitle">Title *</label>
                        <input id="editNewsTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="editNewsExcerpt">Excerpt *</label>
                        <textarea id="editNewsExcerpt" required></textarea>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="editNewsContent">Content *</label>
                        <textarea id="editNewsContent" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="editNewsCategory">Category</label>
                        <input id="editNewsCategory" type="text" placeholder="e.g., Announcement, Award">
                    </div>
                    
                    <div class="input-group">
                        <label for="editNewsAuthor">Author *</label>
                        <input id="editNewsAuthor" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="editNewsDate">Date *</label>
                        <input id="editNewsDate" type="date" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="editNewsReadTime">Read Time</label>
                        <input id="editNewsReadTime" type="text" placeholder="e.g., 3 min read">
                    </div>
                    
                    <!-- News Image Upload -->
                    <div class="input-group full-width">
                        <label for="editNewsImage">News Image</label>
                        <div class="file-upload-container" onclick="document.getElementById('editNewsImageInput').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h4>Upload News Image</h4>
                            <p>Click to browse or drag and drop</p>
                            <p class="upload-hint">Recommended: 1200x800px, max 5MB</p>
                            <input type="file" id="editNewsImageInput" class="file-input" accept="image/*">
                        </div>
                        <div id="editNewsImagePreview" class="image-preview"></div>
                    </div>

                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="editNewsFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="editNewsPublished">
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Update News
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideEditNewsModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Event Modal -->
    <div id="editEventModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Edit Event</h3>
                <button class="btn-secondary" type="button" onclick="hideEditEventModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="editEventForm">
                <input type="hidden" id="editEventId">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="editEventTitle">Title *</label>
                        <input id="editEventTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="editEventDescription">Description *</label>
                        <textarea id="editEventDescription" required></textarea>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="editEventExcerpt">Excerpt *</label>
                        <textarea id="editEventExcerpt" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="editEventDate">Event Date *</label>
                        <input id="editEventDate" type="date" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="editEventTime">Event Time *</label>
                        <input id="editEventTime" type="text" placeholder="e.g., 2:00 PM - 5:00 PM" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="editEventLocation">Location *</label>
                        <input id="editEventLocation" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="editEventCategory">Category</label>
                        <input id="editEventCategory" type="text" placeholder="e.g., Workshop, Conference">
                    </div>
                    
                    <div class="input-group">
                        <label for="editEventAuthor">Author *</label>
                        <input id="editEventAuthor" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="editEventReadTime">Read Time</label>
                        <input id="editEventReadTime" type="text" placeholder="e.g., 2 min read">
                    </div>
                    
                    <!-- Event Image Upload -->
                    <div class="input-group full-width">
                        <label for="editEventImage">Event Image</label>
                        <div class="file-upload-container" onclick="document.getElementById('editEventImageInput').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h4>Upload Event Image</h4>
                            <p>Click to browse or drag and drop</p>
                            <p class="upload-hint">Recommended: 1200x800px, max 5MB</p>
                            <input type="file" id="editEventImageInput" class="file-input" accept="image/*">
                        </div>
                        <div id="editEventImagePreview" class="image-preview"></div>
                    </div>

                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="editEventFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="editEventPublished">
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Update Event
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideEditEventModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Contact Submission Modal -->
    <div id="editContactModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Edit Contact Submission</h3>
                <button class="btn-secondary" type="button" onclick="hideEditContactModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="editContactForm">
                <input type="hidden" id="editContactId">
                <div class="form-grid">
                    <div class="input-group">
                        <label for="editContactName">Name *</label>
                        <input id="editContactName" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="editContactEmail">Email *</label>
                        <input id="editContactEmail" type="email" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="editContactMessage">Message *</label>
                        <textarea id="editContactMessage" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="editContactStatus">Status</label>
                        <select id="editContactStatus">
                            <option value="new">New</option>
                            <option value="read">Read</option>
                            <option value="replied">Replied</option>
                            <option value="archived">Archived</option>
                        </select>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Update Submission
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideEditContactModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Design Project Modal -->
    <div id="editDesignProjectModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Edit Design Project</h3>
                <button class="btn-secondary" type="button" onclick="hideEditDesignProjectModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="editDesignProjectForm">
                <input type="hidden" id="editDesignProjectId">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="editDesignProjectTitle">Title *</label>
                        <input id="editDesignProjectTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="editDesignProjectSummary">Summary *</label>
                        <textarea id="editDesignProjectSummary" required></textarea>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="editDesignProjectDescription">Description *</label>
                        <textarea id="editDesignProjectDescription" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="editDesignProjectCategory">Category *</label>
                        <select id="editDesignProjectCategory" required>
                            <option value="academic">Academic</option>
                            <option value="professional">Professional</option>
                            <option value="competition">Competition</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="editDesignProjectSector">Sector *</label>
                        <select id="editDesignProjectSector" required>
                            <option value="">Select Sector</option>
                            <option value="residential">Residential Architecture</option>
                            <option value="interior">Interior Design</option>
                            <option value="refurbishment">Refurbishment</option>
                            <option value="cultural">Cultural Architecture</option>
                            <option value="commercial">Commercial & Offices</option>
                            <option value="hospitality">Hospitality Architecture</option>
                            <option value="public">Public Architecture</option>
                            <option value="healthcare">Healthcare Architecture</option>
                            <option value="educational">Educational Architecture</option>
                            <option value="sports">Sports Architecture</option>
                            <option value="religious">Religious Architecture</option>
                            <option value="industrial">Industrial & Infrastructure</option>
                            <option value="landscape">Landscape & Urbanism</option>
                        </select>
                    </div>
                    
                    <!-- Main Image Upload -->
                    <div class="input-group full-width">
                        <label for="editDesignProjectMainImage">Main Image *</label>
                        <div class="file-upload-container" onclick="document.getElementById('editMainImageInput').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h4>Upload Main Image</h4>
                            <p>Click to browse or drag and drop</p>
                            <p class="upload-hint">Recommended: 1200x800px, max 5MB</p>
                            <input type="file" id="editMainImageInput" class="file-input" accept="image/*">
                        </div>
                        <div id="editMainImagePreview" class="image-preview"></div>
                    </div>

                    <div class="input-group">
                        <label for="editDesignProjectDisplayOrder">Display Order</label>
                        <input id="editDesignProjectDisplayOrder" type="number" min="0" value="0">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="editDesignProjectFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="editDesignProjectPublished">
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Update Project
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideEditDesignProjectModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Research Article Modal -->
    <div id="editResearchModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Edit Research Article</h3>
                <button class="btn-secondary" type="button" onclick="hideEditResearchModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="editResearchForm">
                <input type="hidden" id="editResearchId">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="editResearchTitle">Title *</label>
                        <input id="editResearchTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="editResearchAbstract">Abstract *</label>
                        <textarea id="editResearchAbstract" required placeholder="Brief summary of the research"></textarea>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="editResearchContent">Full Content *</label>
                        <textarea id="editResearchContent" required placeholder="Detailed research content"></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="editResearchCategory">Category *</label>
                        <select id="editResearchCategory" required>
                            <option value="sustainable">Sustainable Design</option>
                            <option value="climate">Climate Resilience</option>
                            <option value="social">Social Impact</option>
                            <option value="technological">Technological Innovation</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="editResearchAuthors">Authors *</label>
                        <input id="editResearchAuthors" type="text" required placeholder="John Doe, Jane Smith">
                    </div>
                    
                    <div class="input-group">
                        <label for="editResearchPublicationDate">Publication Date</label>
                        <input id="editResearchPublicationDate" type="date">
                    </div>
                    
                    <div class="input-group">
                        <label for="editResearchMainImage">Main Image URL</label>
                        <input id="editResearchMainImage" type="text" placeholder="/images/research/image.jpg">
                    </div>
                    
                    <div class="input-group">
                        <label for="editResearchDisplayOrder">Display Order</label>
                        <input id="editResearchDisplayOrder" type="number" min="0" value="0">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="editResearchFeatured">
                            <span class="toggle-slider"></span>
                            <span>Featured</span>
                        </label>
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="editResearchPublished">
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Update Article
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideEditResearchModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Workshop Modal -->
    <div id="editWorkshopModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Edit Workshop</h3>
                <button class="btn-secondary" type="button" onclick="hideEditWorkshopModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="editWorkshopForm">
                <input type="hidden" id="editWorkshopId">
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label for="editWorkshopTitle">Title *</label>
                        <input id="editWorkshopTitle" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="editWorkshopDescription">Description *</label>
                        <textarea id="editWorkshopDescription" required placeholder="Workshop description..."></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="editWorkshopInstructor">Instructor *</label>
                        <input id="editWorkshopInstructor" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="editWorkshopDate">Date *</label>
                        <input id="editWorkshopDate" type="date" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="editWorkshopTime">Time *</label>
                        <input id="editWorkshopTime" type="text" placeholder="e.g., 2:00 PM - 4:00 PM" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="editWorkshopLocation">Location</label>
                        <input id="editWorkshopLocation" type="text" placeholder="Online or physical location">
                    </div>
                    
                    <div class="input-group">
                        <label for="editWorkshopCapacity">Capacity</label>
                        <input id="editWorkshopCapacity" type="number" placeholder="Maximum participants">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="editWorkshopPublished">
                            <span class="toggle-slider"></span>
                            <span>Published</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Update Workshop
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideEditWorkshopModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Team Member Modal -->
    <div id="editTeamMemberModal" class="modal hidden">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Edit Team Member</h3>
                <button class="btn-secondary" type="button" onclick="hideEditTeamMemberModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="editTeamMemberForm">
                <input type="hidden" id="editTeamMemberId">
                <div class="form-grid">
                    <div class="input-group">
                        <label for="editTeamMemberName">Name *</label>
                        <input id="editTeamMemberName" type="text" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="editTeamMemberRole">Role *</label>
                        <input id="editTeamMemberRole" type="text" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label for="editTeamMemberBio">Bio *</label>
                        <textarea id="editTeamMemberBio" required></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="editTeamMemberImageFile">Profile Image</label>
                        <input type="file" id="editTeamMemberImageFile" accept="image/*">
                        <small>Optional: Team member photo</small>
                    </div>
                    
                    <div class="input-group">
                        <label for="editTeamMemberImageUrl">Or Image URL</label>
                        <input id="editTeamMemberImageUrl" type="url">
                    </div>
                    
                    <div class="input-group">
                        <label for="editTeamMemberOrder">Display Order</label>
                        <input id="editTeamMemberOrder" type="number" min="0" value="0">
                    </div>
                    
                    <div class="input-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="editTeamMemberActive">
                            <span class="toggle-slider"></span>
                            <span>Active</span>
                        </label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Update Team Member
                    </button>
                    <button type="button" class="btn-secondary" onclick="hideEditTeamMemberModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Basic modal functionality - will be enhanced in the next script update
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            const overlay = document.getElementById('overlay');
            if (modal) {
                modal.classList.remove('hidden');
            }
            if (overlay) {
                overlay.classList.add('active');
            }
        }

        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            const overlay = document.getElementById('overlay');
            if (modal) {
                modal.classList.add('hidden');
            }
            if (overlay) {
                overlay.classList.remove('active');
            }
        }

        // Modal show/hide functions
        function showAddNewsModal() { showModal('addNewsModal'); }
        function hideAddNewsModal() { hideModal('addNewsModal'); }
        function showAddEventModal() { showModal('addEventModal'); }
        function hideAddEventModal() { hideModal('addEventModal'); }
        function showAddDesignProjectModal(category = null) { 
            if (category) {
                const categorySelect = document.getElementById('addDesignProjectCategory');
                if (categorySelect) categorySelect.value = category;
            }
            showModal('addDesignProjectModal'); 
        }
        function hideAddDesignProjectModal() { hideModal('addDesignProjectModal'); }
        function showAddResearchModal(category = null) { 
            if (category) {
                const categorySelect = document.getElementById('addResearchCategory');
                if (categorySelect) categorySelect.value = category;
            }
            showModal('addResearchModal'); 
        }
        function hideAddResearchModal() { hideModal('addResearchModal'); }
        function showAddStoryModal() { showModal('addStoryModal'); }
        function hideAddStoryModal() { hideModal('addStoryModal'); }
        function showAddPhotoModal() { showModal('addPhotoModal'); }
        function hideAddPhotoModal() { hideModal('addPhotoModal'); }
        function showAddVideoModal() { showModal('addVideoModal'); }
        function hideAddVideoModal() { hideModal('addVideoModal'); }
        function showAddWorkshopModal() { showModal('addWorkshopModal'); }
        function hideAddWorkshopModal() { hideModal('addWorkshopModal'); }
        function showAddTutorialModal() { showModal('addTutorialModal'); }
        function hideAddTutorialModal() { hideModal('addTutorialModal'); }
        function showAddTestimonialModal() { showModal('addTestimonialModal'); }
        function hideAddTestimonialModal() { hideModal('addTestimonialModal'); }
        function showAddTeamMemberModal() { showModal('addTeamMemberModal'); }
        function hideAddTeamMemberModal() { hideModal('addTeamMemberModal'); }
        function showAddInitiativeModal() { showModal('addInitiativeModal'); }
        function hideAddInitiativeModal() { hideModal('addInitiativeModal'); }
        function showAddDesignModal() { showModal('addDesignModal'); }
        function hideAddDesignModal() { hideModal('addDesignModal'); }
        function showAddExhibitionModal() { showModal('addExhibitionModal'); }
        function hideAddExhibitionModal() { hideModal('addExhibitionModal'); }

        // Edit modal functions
        function showEditNewsModal() { showModal('editNewsModal'); }
        function hideEditNewsModal() { hideModal('editNewsModal'); }
        function showEditEventModal() { showModal('editEventModal'); }
        function hideEditEventModal() { hideModal('editEventModal'); }
        function showEditContactModal() { showModal('editContactModal'); }
        function hideEditContactModal() { hideModal('editContactModal'); }
        function showEditDesignProjectModal() { showModal('editDesignProjectModal'); }
        function hideEditDesignProjectModal() { hideModal('editDesignProjectModal'); }
        function showEditResearchModal() { showModal('editResearchModal'); }
        function hideEditResearchModal() { hideModal('editResearchModal'); }
        function showEditWorkshopModal() { showModal('editWorkshopModal'); }
        function hideEditWorkshopModal() { hideModal('editWorkshopModal'); }
        function showEditTeamMemberModal() { showModal('editTeamMemberModal'); }
        function hideEditTeamMemberModal() { hideModal('editTeamMemberModal'); }

        // Close modals when clicking overlay
        document.getElementById('overlay').addEventListener('click', function() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.add('hidden');
            });
            this.classList.remove('active');
        });

        // Close modal when pressing Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.add('hidden');
                });
                const overlay = document.getElementById('overlay');
                if (overlay) overlay.classList.remove('active');
            }
        });

        // File upload preview functionality
        function setupFileUploadPreview(inputId, previewId) {
            const input = document.getElementById(inputId);
            const preview = document.getElementById(previewId);
            
            if (input && preview) {
                input.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            preview.innerHTML = `<img src="${e.target.result}" alt="Preview" style="max-width: 200px; border-radius: 8px;">`;
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        }

        // Initialize file upload previews
        document.addEventListener('DOMContentLoaded', function() {
            // Add modal file uploads
            setupFileUploadPreview('addNewsImageInput', 'addNewsImagePreview');
            setupFileUploadPreview('addEventImageInput', 'addEventImagePreview');
            setupFileUploadPreview('addMainImageInput', 'addMainImagePreview');
            setupFileUploadPreview('addPhotoFileInput', 'addPhotoPreview');
            setupFileUploadPreview('addDesignFileInput', 'addDesignPreview');
            setupFileUploadPreview('addTeamMemberImageFile', 'addTeamMemberImagePreview');
            
            // Edit modal file uploads
            setupFileUploadPreview('editNewsImageInput', 'editNewsImagePreview');
            setupFileUploadPreview('editEventImageInput', 'editEventImagePreview');
            setupFileUploadPreview('editMainImageInput', 'editMainImagePreview');
            setupFileUploadPreview('editTeamMemberImageFile', 'editTeamMemberImagePreview');
        });

        // Placeholder functions for form submissions
        function handleAddNews(event) {
            event.preventDefault();
            alert('Add News functionality will be implemented in the next update');
            // Implementation will be added in the JavaScript update
        }

        function handleAddEvent(event) {
            event.preventDefault();
            alert('Add Event functionality will be implemented in the next update');
            // Implementation will be added in the JavaScript update
        }

        // Attach form handlers
        document.addEventListener('DOMContentLoaded', function() {
            const addNewsForm = document.getElementById('addNewsForm');
            if (addNewsForm) {
                addNewsForm.addEventListener('submit', handleAddNews);
            }

            const addEventForm = document.getElementById('addEventForm');
            if (addEventForm) {
                addEventForm.addEventListener('submit', handleAddEvent);
            }

            // Add similar handlers for other forms
            const forms = [
                'addDesignProjectForm', 'addResearchForm', 'addWorkshopForm',
                'addTeamMemberForm', 'addPhotoForm', 'addStoryForm',
                'addTestimonialForm', 'addInitiativeForm', 'addVideoForm',
                'addTutorialForm', 'addExhibitionForm', 'addDesignForm',
                'editNewsForm', 'editEventForm', 'editContactForm',
                'editDesignProjectForm', 'editResearchForm', 'editWorkshopForm',
                'editTeamMemberForm'
            ];

            forms.forEach(formId => {
                const form = document.getElementById(formId);
                if (form) {
                    form.addEventListener('submit', function(event) {
                        event.preventDefault();
                        alert(`${formId.replace('add', 'Add').replace('edit', 'Edit').replace('Form', '')} functionality will be implemented in the next update`);
                    });
                }
            });
        });
        // Enhanced API configuration with better error handling
const API_BASE_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
  ? 'http://localhost:4000/api' 
  : 'https://aspire-arch-server.onrender.com/api';

console.log(' Using API URL:', API_BASE_URL);

// Global state
let authToken = null;
let allItems = [];
let contactSubmissions = [];
let currentGetInvolvedTab = 'membership';
let currentMediaTab = 'photos';
let currentEducationTab = 'workshops';
let currentColleaguesTab = 'colleagues-contacts';
let currentResearchTab = 'research-all';
let currentDesignTab = 'design-all';
let currentNewsEventsTab = 'newsevents-all';
let currentPhotoCategory = 'All';

// Stats objects
let mediaStats = { photos: 0, videos: 0, designs: 0, testimonials: 0 };
let educationStats = { workshops: 0, tutorials: 0, exhibitions: 0, totalEnrolled: 0 };
let colleaguesStats = { contacts: 0, team: 0, initiatives: 0, newContacts: 0 };
let researchStats = { articles: 0, sustainable: 0, climate: 0, social: 0, technological: 0, featured: 0 };
let designStats = { total: 0, academic: 0, professional: 0, competition: 0, featured: 0 };
let newsEventsStats = { news: 0, events: 0, featuredNews: 0, featuredEvents: 0 };

// Sector mapping
const sectorLabels = {
  'residential': 'Residential Architecture',
  'interior': 'Interior Design',
  'refurbishment': 'Refurbishment',
  'cultural': 'Cultural Architecture',
  'commercial': 'Commercial & Offices',
  'hospitality': 'Hospitality Architecture',
  'public': 'Public Architecture',
  'healthcare': 'Healthcare Architecture',
  'educational': 'Educational Architecture',
  'sports': 'Sports Architecture',
  'religious': 'Religious Architecture',
  'industrial': 'Industrial & Infrastructure',
  'landscape': 'Landscape & Urbanism'
};

// DOM Elements
const loginScreen = document.getElementById('loginScreen');
const dashboard = document.getElementById('dashboard');
const sidebar = document.getElementById('sidebar');
const mobileMenuBtn = document.getElementById('mobileMenuBtn');
const overlay = document.getElementById('overlay');
const pageTitle = document.getElementById('pageTitle');
const navItems = document.querySelectorAll('.nav-item');
const sections = document.querySelectorAll('.section');

// ===== ENHANCED AUTHENTICATION SYSTEM =====

// Enhanced API Request with better token handling
async function apiRequest(endpoint, options = {}) {
  const url = `${API_BASE_URL}${endpoint}`;
  
  // Get current token with validation
  const currentToken = getValidToken();
  if (!currentToken && !endpoint.includes('/auth/login')) {
    console.warn('No valid token available, redirecting to login');
    showLogin();
    throw new Error('Authentication required');
  }

  const config = {
    headers: {
      'Content-Type': 'application/json',
      ...(currentToken ? { 'Authorization': `Bearer ${currentToken}` } : {}),
      ...options.headers,
    },
    ...options,
  };

  // For FormData requests, remove Content-Type header
  if (options.body instanceof FormData) {
    delete config.headers['Content-Type'];
  }

  try {
    console.log(` API Request: ${options.method || 'GET'} ${url}`);
    
    const response = await fetch(url, config);
    
    if (response.status === 401) {
      console.error(' Authentication failed (401)');
      clearAuthData();
      showLogin();
      throw new Error('Authentication failed. Please login again.');
    }
    
    if (!response.ok) {
      const errorText = await response.text();
      console.error(' API Error Response:', errorText);
      let errorData;
      try {
        errorData = JSON.parse(errorText);
      } catch {
        errorData = { error: `HTTP ${response.status}: ${response.statusText}` };
      }
      throw new Error(errorData.error || `HTTP error! status: ${response.status}`);
    }
    
    const data = await response.json();
    console.log(` API Success for ${endpoint}`);
    return data;
  } catch (error) {
    console.error(' API Request failed:', error);
    
    // If it's an auth error, redirect to login
    if (error.message.includes('Authentication failed') || error.message.includes('Authentication required')) {
      showLogin();
    }
    
    throw error;
  }
}

// Token management functions
function getValidToken() {
  const token = authToken || localStorage.getItem('aspire_token');
  if (!token) return null;
  
  // Basic token validation
  try {
    const payload = JSON.parse(atob(token.split('.')[1]));
    const isExpired = payload.exp && Date.now() >= payload.exp * 1000;
    if (isExpired) {
      console.warn('Token expired');
      clearAuthData();
      return null;
    }
    return token;
  } catch (error) {
    console.warn('Invalid token format');
    clearAuthData();
    return null;
  }
}

function clearAuthData() {
  authToken = null;
  localStorage.removeItem('aspire_token');
  localStorage.removeItem('aspire_token_timestamp');
}

function storeAuthData(token) {
  authToken = token;
  localStorage.setItem('aspire_token', token);
  localStorage.setItem('aspire_token_timestamp', Date.now().toString());
}

// Enhanced uploadFile function
async function uploadFile(file, type) {
  const formData = new FormData();
  formData.append('file', file);
  formData.append('type', type);

  try {
    console.log(` Uploading ${type} file:`, file.name, file.size, file.type);
    
    const response = await fetch(`${API_BASE_URL}/upload`, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${getValidToken()}`
      },
      body: formData
    });

    console.log(' Upload response status:', response.status);
    
    if (!response.ok) {
      const errorText = await response.text();
      console.error(' Upload failed with response:', errorText);
      throw new Error(`Upload failed: ${response.status} - ${errorText}`);
    }

    const data = await response.json();
    console.log(' Upload response data:', data);
    
    const fileUrl = data.fileUrl || data.url || data.path || data.filePath;
    if (!fileUrl) {
      console.error(' No file URL in response:', data);
      throw new Error('Upload response missing file URL');
    }
    
    console.log(' Upload successful, file URL:', fileUrl);
    return fileUrl;
  } catch (error) {
    console.error(' File upload error:', error);
    throw error;
  }
}

// ===== ENHANCED NAVIGATION SYSTEM =====

// Initialize navigation
function initializeNavigation() {
  navItems.forEach(item => {
    item.addEventListener('click', () => {
      const section = item.getAttribute('data-section');
      showSection(section);
      
      // Update active nav item
      navItems.forEach(nav => nav.classList.remove('active'));
      item.classList.add('active');
      
      // Update page title
      pageTitle.textContent = item.querySelector('span').textContent;
      
      // Load section-specific data
      loadSectionData(section);
      
      // Close mobile menu
      if (window.innerWidth <= 1024) {
        sidebar.classList.remove('open');
        overlay.classList.remove('active');
      }
    });
  });
}

function showSection(sectionName) {
  sections.forEach(section => {
    section.classList.add('hidden');
  });
  const targetSection = document.getElementById(sectionName + 'Section');
  if (targetSection) {
    targetSection.classList.remove('hidden');
  }
}

function loadSectionData(section) {
  const sectionHandlers = {
    'contact': loadContactData,
    'dashboard': loadDashboardData,
    'getinvolved': () => showGetInvolvedTab('membership'),
    'media': () => { loadMediaStats(); showMediaTab('photos'); },
    'education': () => { loadEducationStats(); showEducationTab('workshops'); },
    'design': () => { loadDesignStats(); showDesignTab('design-all'); },
    'newsevents': () => { loadNewsEventsStats(); showNewsEventsTab('newsevents-all'); },
    'research': () => { loadResearchStats(); showResearchTab('research-all'); },
    'colleagues': () => { loadColleaguesStats(); showColleaguesTab('colleagues-contacts'); }
  };

  const handler = sectionHandlers[section];
  if (handler) handler();
}

// ===== ENHANCED AUTHENTICATION FLOW =====

function showLogin() {
  dashboard.classList.add('hidden');
  loginScreen.classList.remove('hidden');
  clearAuthData();
}

async function showDashboard() {
  const token = getValidToken();
  if (!token) {
    showLogin();
    return;
  }

  try {
    loginScreen.classList.add('hidden');
    dashboard.classList.remove('hidden');
    
    await loadDashboardData();
    initializeEventListeners();
    console.log(' Dashboard loaded successfully');
  } catch (error) {
    console.error('Failed to load dashboard:', error);
    showLogin();
  }
}

// Enhanced login function
async function handleLogin() {
  const username = document.getElementById('username').value;
  const password = document.getElementById('password').value;
  const loginMsg = document.getElementById('loginMsg');
  
  if (!username || !password) {
    loginMsg.innerHTML = '<span class="text-danger">Please enter both username and password</span>';
    return;
  }

  try {
    loginMsg.innerHTML = '<span class="text-warning">Logging in...</span>';
    
    const result = await fetch(`${API_BASE_URL}/auth/login`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ username, password })
    });

    if (!result.ok) {
      const errorData = await result.json().catch(() => ({}));
      throw new Error(errorData.error || `Login failed: ${result.status}`);
    }

    const data = await result.json();
    
    if (data.token) {
      storeAuthData(data.token);
      console.log(' Login successful, token stored');
      await showDashboard();
    } else {
      throw new Error('No token received from server');
    }
  } catch (error) {
    console.error('Login error:', error);
    loginMsg.innerHTML = `<span class="text-danger">${error.message || 'Login failed. Check credentials.'}</span>`;
  }
}

// ===== ENHANCED DASHBOARD SYSTEM =====

async function loadDashboardData() {
  try {
    console.log(' Loading dashboard data...');
    await Promise.all([
      loadItems(),
      loadContactStats(),
      loadEducationStats(),
      loadColleaguesStats(),
      loadResearchStats(),
      loadDesignStats(),
      loadNewsEventsStats()
    ]);
  } catch (error) {
    console.error('Failed to load dashboard data:', error);
    setDefaultStats();
  }
}

async function loadItems() {
  try {
    console.log(' Loading items...');
    const data = await apiRequest('/items');
    allItems = Array.isArray(data) ? data : [];
    renderItems(allItems);
    updateStats(allItems);
  } catch (error) {
    console.error('Failed to load items:', error);
    allItems = [];
    renderItems([]);
    updateStats([]);
  }
}

function setDefaultStats() {
  const stats = {
    'newsCount': '0',
    'projectCount': '0',
    'insightCount': '0',
    'contactCount': '0',
    'workshopCount': '0',
    'tutorialCount': '0',
    'colleaguesContactCount': '0',
    'designProjectsCount': '0',
    'researchArticlesCount': '0'
  };

  Object.entries(stats).forEach(([id, value]) => {
    const element = document.getElementById(id);
    if (element) element.textContent = value;
  });
  
  const recentContainer = document.getElementById('recentItems');
  if (recentContainer) {
    recentContainer.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No recent activity</p>';
  }
}

function updateStats(items) {
  const counts = {
    news: items.filter(item => item.type === 'news').length,
    project: items.filter(item => item.type === 'project').length,
    insight: items.filter(item => item.type === 'insight').length,
    event: items.filter(item => item.type === 'event').length,
    course: items.filter(item => item.type === 'course').length
  };

  const elements = {
    'newsCount': counts.news,
    'projectCount': counts.project,
    'insightCount': counts.insight
  };

  Object.entries(elements).forEach(([id, value]) => {
    const element = document.getElementById(id);
    if (element) element.textContent = value;
  });

  // Update recent items
  const recentItems = items.slice(0, 5);
  const recentContainer = document.getElementById('recentItems');
  if (recentContainer) {
    recentContainer.innerHTML = '';
    
    if (recentItems.length === 0) {
      recentContainer.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No recent activity</p>';
      return;
    }
    
    recentItems.forEach(item => {
      const el = createItemElement(item);
      recentContainer.appendChild(el);
    });
  }
}

function renderItems(items) {
  const container = document.getElementById('items'); 
  if (!container) return;
  
  container.innerHTML = '';
  
  if (items.length === 0) {
    container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No content items found.</p>';
    return;
  }
  
  items.forEach(item => {
    const el = createItemElement(item);
    container.appendChild(el);
  });
}

function createItemElement(item) {
  const el = document.createElement('div');
  el.className = 'item';
  
  const content = document.createElement('div');
  content.className = 'item-content';
  
  const title = document.createElement('h4');
  title.className = 'item-title';
  title.textContent = item.title || 'Untitled';
  
  const meta = document.createElement('div');
  meta.className = 'item-meta';
  
  const type = document.createElement('span');
  type.className = 'item-type';
  type.textContent = item.type || 'unknown';
  
  const date = document.createElement('span');
  date.className = 'item-date';
  date.textContent = item.created_at ? new Date(item.created_at).toLocaleDateString() : 'Unknown date';
  
  meta.appendChild(type);
  meta.appendChild(date);
  
  const preview = document.createElement('div');
  preview.className = 'item-preview';
  const contentText = item.content || '';
  preview.textContent = contentText.substring(0, 150) + (contentText.length > 150 ? '...' : '');
  
  content.appendChild(title);
  content.appendChild(meta);
  content.appendChild(preview);

  // Add files list if any
  if (item.files && Array.isArray(item.files) && item.files.length > 0) {
    const filesList = document.createElement('div');
    filesList.className = 'files-list';
    item.files.forEach(file => {
      const fileItem = document.createElement('div');
      fileItem.className = 'file-item';
      const icon = document.createElement('span');
      icon.innerHTML = file.type && file.type.startsWith('image/') ? '' : '';
      const link = document.createElement('a');
      link.href = file.path || '#';
      link.target = '_blank';
      link.textContent = file.name || 'File';
      fileItem.appendChild(icon);
      fileItem.appendChild(link);
      filesList.appendChild(fileItem);
    });
    content.appendChild(filesList);
  }

  const actions = document.createElement('div');
  actions.className = 'item-actions';
  
  const editBtn = document.createElement('button');
  editBtn.className = 'btn-secondary';
  editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
  editBtn.onclick = () => editItem(item);
  
  const del = document.createElement('button');
  del.className = 'btn-danger';
  del.innerHTML = '<i class="fas fa-trash"></i> Delete';
  del.onclick = async () => {
    if (confirm('Are you sure you want to delete this item?')) {
      try {
        await apiRequest(`/items/${item.id}`, { method: 'DELETE' });
        await loadItems();
      } catch (error) {
        console.error('Delete failed:', error);
        alert('Failed to delete item: ' + error.message);
      }
    }
  };
  
  actions.appendChild(editBtn);
  actions.appendChild(del);
  content.appendChild(actions);
  
  if (item.image) {
    const img = document.createElement('img');
    img.src = item.image;
    img.alt = item.title || 'Item image';
    el.appendChild(img);
  }
  
  el.appendChild(content);
  return el;
}

// ===== ENHANCED EDIT FUNCTIONALITY =====

function editItem(item) {
  // Create edit modal dynamically
  const editModal = document.createElement('div');
  editModal.className = 'modal';
  editModal.innerHTML = `
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Edit Item</h3>
        <button class="btn-secondary" type="button" onclick="this.closest('.modal').remove()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form id="editItemForm">
        <div class="form-grid">
          <div class="input-group full-width">
            <label for="editTitle">Title *</label>
            <input id="editTitle" type="text" value="${item.title || ''}" required>
          </div>
          <div class="input-group full-width">
            <label for="editContent">Content *</label>
            <textarea id="editContent" required>${item.content || ''}</textarea>
          </div>
          <div class="input-group">
            <label for="editType">Type *</label>
            <select id="editType" required>
              <option value="news" ${item.type === 'news' ? 'selected' : ''}>News</option>
              <option value="project" ${item.type === 'project' ? 'selected' : ''}>Project</option>
              <option value="insight" ${item.type === 'insight' ? 'selected' : ''}>Insight</option>
              <option value="event" ${item.type === 'event' ? 'selected' : ''}>Event</option>
            </select>
          </div>
        </div>
        <div class="button-group">
          <button type="submit" class="btn-primary">
            <i class="fas fa-save"></i> Update Item
          </button>
          <button type="button" class="btn-secondary" onclick="this.closest('.modal').remove()">
            <i class="fas fa-times"></i> Cancel
          </button>
        </div>
      </form>
    </div>
  `;

  document.body.appendChild(editModal);

  // Handle form submission
  document.getElementById('editItemForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const updatedData = {
      title: document.getElementById('editTitle').value,
      content: document.getElementById('editContent').value,
      type: document.getElementById('editType').value
    };

    try {
      await apiRequest(`/items/${item.id}`, {
        method: 'PUT',
        body: JSON.stringify(updatedData)
      });
      
      editModal.remove();
      await loadItems();
      alert('Item updated successfully!');
    } catch (error) {
      console.error('Failed to update item:', error);
      alert('Failed to update item: ' + error.message);
    }
  });
}

// ===== ENHANCED CONTACT MANAGEMENT =====

async function loadContactData() {
  try {
    console.log(' Loading contact data...');
    await loadContactSubmissions();
  } catch (error) {
    console.error('Failed to load contact data:', error);
  }
}

async function loadContactSubmissions() {
  try {
    console.log(' Loading contact submissions...');
    const data = await apiRequest('/contact/submissions');
    console.log(' Raw submissions data:', data);
    
    contactSubmissions = Array.isArray(data) ? data : 
                        Array.isArray(data.data) ? data.data : [];
    
    console.log(` Processed ${contactSubmissions.length} submissions`);
    
    renderContactSubmissions(contactSubmissions);
    updateContactStats(contactSubmissions);
  } catch (error) {
    console.error('Failed to load contact submissions:', error);
    contactSubmissions = [];
    renderContactSubmissions([]);
    updateContactStats([]);
  }
}

async function loadContactStats() {
  try {
    const stats = await apiRequest('/contact/submissions/stats');
    const contactCountElement = document.getElementById('contactCount');
    if (contactCountElement && stats && typeof stats.total !== 'undefined') {
      contactCountElement.textContent = stats.total;
    }
  } catch (error) {
    console.error('Failed to load contact stats:', error);
    const contactCountElement = document.getElementById('contactCount');
    if (contactCountElement) contactCountElement.textContent = '0';
  }
}

function updateContactStats(submissions) {
  const total = submissions.length;
  const newCount = submissions.filter(s => s.status === 'new').length;
  const repliedCount = submissions.filter(s => s.status === 'replied').length;
  const recentCount = submissions.filter(s => {
    if (!s.created_at) return false;
    const sevenDaysAgo = new Date();
    sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
    return new Date(s.created_at) >= sevenDaysAgo;
  }).length;

  const elements = {
    'totalSubmissions': total,
    'newSubmissions': newCount,
    'repliedSubmissions': repliedCount,
    'recentSubmissions': recentCount
  };

  Object.entries(elements).forEach(([id, value]) => {
    const element = document.getElementById(id);
    if (element) element.textContent = value;
  });
}

function renderContactSubmissions(submissions) {
  const container = document.getElementById('submissionsList');
  if (!container) return;

  container.innerHTML = '';

  if (submissions.length === 0) {
    container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No contact submissions found.</p>';
    return;
  }

  submissions.forEach(submission => {
    const el = document.createElement('div');
    el.className = 'submission-item';
    
    const header = document.createElement('div');
    header.className = 'submission-header';
    
    const left = document.createElement('div');
    left.innerHTML = `
      <h4 style="margin: 0 0 0.5rem 0; color: var(--accent-light);">${submission.name || 'No name'}</h4>
      <p style="margin: 0; color: var(--text-muted);">${submission.email || 'No email'}</p>
    `;
    
    const right = document.createElement('div');
    right.innerHTML = `
      <span class="status-badge status-${submission.status || 'new'}">${submission.status || 'new'}</span>
      <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
        ${submission.created_at ? new Date(submission.created_at).toLocaleDateString() : 'Unknown date'}
      </div>
    `;
    
    header.appendChild(left);
    header.appendChild(right);
    
    const meta = document.createElement('div');
    meta.className = 'submission-meta';
    
    const statusSelect = document.createElement('select');
    statusSelect.innerHTML = `
      <option value="new" ${(submission.status || 'new') === 'new' ? 'selected' : ''}>New</option>
      <option value="read" ${(submission.status || 'new') === 'read' ? 'selected' : ''}>Read</option>
      <option value="replied" ${(submission.status || 'new') === 'replied' ? 'selected' : ''}>Replied</option>
      <option value="archived" ${(submission.status || 'new') === 'archived' ? 'selected' : ''}>Archived</option>
    `;
    statusSelect.onchange = async (e) => {
      await updateSubmissionStatus(submission.id, e.target.value);
    };
    
    const editBtn = document.createElement('button');
    editBtn.className = 'btn-secondary';
    editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
    editBtn.onclick = () => editContactSubmission(submission);
    
    const deleteBtn = document.createElement('button');
    deleteBtn.className = 'btn-danger';
    deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Delete';
    deleteBtn.onclick = async () => {
      if (confirm('Delete this submission?')) {
        await deleteSubmission(submission.id);
      }
    };
    
    meta.appendChild(statusSelect);
    meta.appendChild(editBtn);
    meta.appendChild(deleteBtn);
    
    const message = document.createElement('div');
    message.style.padding = '1rem';
    message.style.background = 'rgba(255,255,255,0.03)';
    message.style.borderRadius = '8px';
    message.style.marginTop = '1rem';
    message.textContent = submission.message || 'No message';
    
    el.appendChild(header);
    el.appendChild(meta);
    el.appendChild(message);
    container.appendChild(el);
  });
}

function editContactSubmission(submission) {
  const editModal = document.createElement('div');
  editModal.className = 'modal';
  editModal.innerHTML = `
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Edit Contact Submission</h3>
        <button class="btn-secondary" type="button" onclick="this.closest('.modal').remove()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form id="editContactForm">
        <div class="form-grid">
          <div class="input-group">
            <label for="editContactName">Name *</label>
            <input id="editContactName" type="text" value="${submission.name || ''}" required>
          </div>
          <div class="input-group">
            <label for="editContactEmail">Email *</label>
            <input id="editContactEmail" type="email" value="${submission.email || ''}" required>
          </div>
          <div class="input-group full-width">
            <label for="editContactMessage">Message *</label>
            <textarea id="editContactMessage" required>${submission.message || ''}</textarea>
          </div>
          <div class="input-group">
            <label for="editContactStatus">Status</label>
            <select id="editContactStatus">
              <option value="new" ${submission.status === 'new' ? 'selected' : ''}>New</option>
              <option value="read" ${submission.status === 'read' ? 'selected' : ''}>Read</option>
              <option value="replied" ${submission.status === 'replied' ? 'selected' : ''}>Replied</option>
              <option value="archived" ${submission.status === 'archived' ? 'selected' : ''}>Archived</option>
            </select>
          </div>
        </div>
        <div class="button-group">
          <button type="submit" class="btn-primary">
            <i class="fas fa-save"></i> Update Submission
          </button>
          <button type="button" class="btn-secondary" onclick="this.closest('.modal').remove()">
            <i class="fas fa-times"></i> Cancel
          </button>
        </div>
      </form>
    </div>
  `;

  document.body.appendChild(editModal);

  document.getElementById('editContactForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const updatedData = {
      name: document.getElementById('editContactName').value,
      email: document.getElementById('editContactEmail').value,
      message: document.getElementById('editContactMessage').value,
      status: document.getElementById('editContactStatus').value
    };

    try {
      await apiRequest(`/contact/submissions/${submission.id}`, {
        method: 'PUT',
        body: JSON.stringify(updatedData)
      });
      
      editModal.remove();
      await loadContactSubmissions();
      alert('Contact submission updated successfully!');
    } catch (error) {
      console.error('Failed to update contact submission:', error);
      alert('Failed to update contact submission: ' + error.message);
    }
  });
}

async function updateSubmissionStatus(id, status) {
  try {
    await apiRequest(`/contact/submissions/${id}/status`, {
      method: 'PUT',
      body: JSON.stringify({ status })
    });
    await loadContactSubmissions();
  } catch (error) {
    console.error('Failed to update status:', error);
    alert('Failed to update status: ' + error.message);
  }
}

async function deleteSubmission(id) {
  try {
    await apiRequest(`/contact/submissions/${id}`, { method: 'DELETE' });
    await loadContactSubmissions();
  } catch (error) {
    console.error('Failed to delete submission:', error);
    alert('Failed to delete submission: ' + error.message);
  }
}

// ===== ENHANCED GET INVOLVED MANAGEMENT =====

async function loadMembershipApplications() {
  try {
    const data = await apiRequest('/get-involved/admin/membership');
    const container = document.getElementById('membershipList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No membership applications found.</p>';
      return;
    }

    data.forEach(application => {
      const el = createGetInvolvedElement(application, 'membership');
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load membership applications:', error);
    const container = document.getElementById('membershipList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading membership applications.</p>';
    }
  }
}

async function loadDonations() {
  try {
    const data = await apiRequest('/get-involved/admin/donations');
    const container = document.getElementById('donationsList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No donations found.</p>';
      return;
    }

    data.forEach(donation => {
      const el = createGetInvolvedElement(donation, 'donations');
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load donations:', error);
    const container = document.getElementById('donationsList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading donations.</p>';
    }
  }
}

async function loadFeedback() {
  try {
    const data = await apiRequest('/get-involved/admin/feedback');
    const container = document.getElementById('feedbackList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No feedback submissions found.</p>';
      return;
    }

    data.forEach(feedback => {
      const el = createGetInvolvedElement(feedback, 'feedback');
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load feedback:', error);
    const container = document.getElementById('feedbackList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading feedback.</p>';
    }
  }
}

async function loadIdeas() {
  try {
    const data = await apiRequest('/get-involved/admin/ideas');
    const container = document.getElementById('ideasList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No idea submissions found.</p>';
      return;
    }

    data.forEach(idea => {
      const el = createGetInvolvedElement(idea, 'ideas');
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load ideas:', error);
    const container = document.getElementById('ideasList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading ideas.</p>';
    }
  }
}

async function loadPartnerships() {
  try {
    const data = await apiRequest('/get-involved/admin/partnerships');
    const container = document.getElementById('partnershipsList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No partnership inquiries found.</p>';
      return;
    }

    data.forEach(partnership => {
      const el = createGetInvolvedElement(partnership, 'partnerships');
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load partnerships:', error);
    const container = document.getElementById('partnershipsList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading partnerships.</p>';
    }
  }
}

async function loadStories() {
  try {
    const data = await apiRequest('/get-involved/admin/stories');
    const container = document.getElementById('storiesList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No community stories found.</p>';
      return;
    }

    data.forEach(story => {
      const el = createStoryElement(story);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load stories:', error);
    const container = document.getElementById('storiesList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading stories.</p>';
    }
  }
}

function createGetInvolvedElement(item, type) {
  const el = document.createElement('div');
  el.className = 'submission-item';
  
  const header = document.createElement('div');
  header.className = 'submission-header';
  
  const left = document.createElement('div');
  left.innerHTML = `
    <h4 style="margin: 0 0 0.5rem 0; color: var(--accent-light);">${item.full_name || 'No name'}</h4>
    <p style="margin: 0; color: var(--text-muted);">${item.email || 'No email'}</p>
  `;
  
  const right = document.createElement('div');
  
  // Add type-specific badges
  let badges = '';
  if (type === 'donations' && item.amount) {
    badges += `<span class="amount-badge">$${item.amount}</span>`;
  }
  if (type === 'ideas' && item.priority) {
    badges += `<span class="priority-badge priority-${item.priority}">${item.priority}</span>`;
  }
  
  right.innerHTML = `
    <span class="status-badge status-${item.status || 'new'}">${item.status || 'new'}</span>
    ${badges}
    <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
      ${item.created_at ? new Date(item.created_at).toLocaleDateString() : 'Unknown date'}
    </div>
  `;
  
  header.appendChild(left);
  header.appendChild(right);
  
  const meta = document.createElement('div');
  meta.className = 'submission-meta';
  
  const statusSelect = document.createElement('select');
  statusSelect.innerHTML = getStatusOptions(type, item.status);
  statusSelect.onchange = async (e) => {
    await updateGetInvolvedStatus(type, item.id, e.target.value);
  };
  
  const editBtn = document.createElement('button');
  editBtn.className = 'btn-secondary';
  editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
  editBtn.onclick = () => editGetInvolvedItem(item, type);
  
  const deleteBtn = document.createElement('button');
  deleteBtn.className = 'btn-danger';
  deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Delete';
  deleteBtn.onclick = async () => {
    if (confirm('Delete this submission?')) {
      await deleteGetInvolvedSubmission(type, item.id);
    }
  };
  
  meta.appendChild(statusSelect);
  meta.appendChild(editBtn);
  meta.appendChild(deleteBtn);
  
  const content = document.createElement('div');
  content.style.padding = '1rem';
  content.style.background = 'rgba(255,255,255,0.03)';
  content.style.borderRadius = '8px';
  content.style.marginTop = '1rem';
  content.innerHTML = getSubmissionContent(item, type);
  
  el.appendChild(header);
  el.appendChild(meta);
  el.appendChild(content);
  return el;
}

function createStoryElement(story) {
  const el = document.createElement('div');
  el.className = `submission-item ${story.is_featured ? 'story-featured' : ''} ${story.is_published ? 'story-published' : 'story-draft'}`;
  
  const header = document.createElement('div');
  header.className = 'submission-header';
  
  const left = document.createElement('div');
  left.innerHTML = `
    <h4 style="margin: 0 0 0.5rem 0; color: var(--accent-light);">${story.story_title}</h4>
    <p style="margin: 0; color: var(--text-muted);">By ${story.author_name}${story.author_title ? `, ${story.author_title}` : ''}</p>
  `;
  
  const right = document.createElement('div');
  right.innerHTML = `
    <span class="status-badge status-${story.status || 'published'}">${story.status || 'published'}</span>
    ${story.is_featured ? '<span class="priority-badge priority-high" style="margin-left: 0.5rem;">Featured</span>' : ''}
    <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
      ${story.created_at ? new Date(story.created_at).toLocaleDateString() : 'Unknown date'}
    </div>
  `;
  
  header.appendChild(left);
  header.appendChild(right);
  
  const meta = document.createElement('div');
  meta.className = 'submission-meta';
  
  const statusSelect = document.createElement('select');
  statusSelect.innerHTML = getStatusOptions('stories', story.status);
  statusSelect.onchange = async (e) => {
    await updateGetInvolvedStatus('stories', story.id, e.target.value);
  };
  
  const editBtn = document.createElement('button');
  editBtn.className = 'btn-secondary';
  editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
  editBtn.onclick = () => editGetInvolvedItem(story, 'stories');
  
  const deleteBtn = document.createElement('button');
  deleteBtn.className = 'btn-danger';
  deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Delete';
  deleteBtn.onclick = async () => {
    if (confirm('Delete this story?')) {
      await deleteGetInvolvedSubmission('stories', story.id);
    }
  };
  
  meta.appendChild(statusSelect);
  meta.appendChild(editBtn);
  meta.appendChild(deleteBtn);
  
  const content = document.createElement('div');
  content.style.padding = '1rem';
  content.style.background = 'rgba(255,255,255,0.03)';
  content.style.borderRadius = '8px';
  content.style.marginTop = '1rem';
  content.textContent = story.story_content.substring(0, 200) + (story.story_content.length > 200 ? '...' : '');
  
  el.appendChild(header);
  el.appendChild(meta);
  el.appendChild(content);
  return el;
}

function getStatusOptions(type, currentStatus) {
  const baseOptions = {
    membership: `
      <option value="pending" ${currentStatus === 'pending' ? 'selected' : ''}>Pending</option>
      <option value="approved" ${currentStatus === 'approved' ? 'selected' : ''}>Approved</option>
      <option value="rejected" ${currentStatus === 'rejected' ? 'selected' : ''}>Rejected</option>
      <option value="archived" ${currentStatus === 'archived' ? 'selected' : ''}>Archived</option>
    `,
    donations: `
      <option value="pending" ${currentStatus === 'pending' ? 'selected' : ''}>Pending</option>
      <option value="verified" ${currentStatus === 'verified' ? 'selected' : ''}>Verified</option>
      <option value="completed" ${currentStatus === 'completed' ? 'selected' : ''}>Completed</option>
      <option value="archived" ${currentStatus === 'archived' ? 'selected' : ''}>Archived</option>
    `,
    feedback: `
      <option value="new" ${currentStatus === 'new' ? 'selected' : ''}>New</option>
      <option value="read" ${currentStatus === 'read' ? 'selected' : ''}>Read</option>
      <option value="replied" ${currentStatus === 'replied' ? 'selected' : ''}>Replied</option>
      <option value="archived" ${currentStatus === 'archived' ? 'selected' : ''}>Archived</option>
    `,
    ideas: `
      <option value="under_review" ${currentStatus === 'under_review' ? 'selected' : ''}>Under Review</option>
      <option value="approved" ${currentStatus === 'approved' ? 'selected' : ''}>Approved</option>
      <option value="implemented" ${currentStatus === 'implemented' ? 'selected' : ''}>Implemented</option>
      <option value="rejected" ${currentStatus === 'rejected' ? 'selected' : ''}>Rejected</option>
      <option value="archived" ${currentStatus === 'archived' ? 'selected' : ''}>Archived</option>
    `,
    partnerships: `
      <option value="pending" ${currentStatus === 'pending' ? 'selected' : ''}>Pending</option>
      <option value="under_review" ${currentStatus === 'under_review' ? 'selected' : ''}>Under Review</option>
      <option value="approved" ${currentStatus === 'approved' ? 'selected' : ''}>Approved</option>
      <option value="rejected" ${currentStatus === 'rejected' ? 'selected' : ''}>Rejected</option>
      <option value="archived" ${currentStatus === 'archived' ? 'selected' : ''}>Archived</option>
    `,
    stories: `
      <option value="draft" ${currentStatus === 'draft' ? 'selected' : ''}>Draft</option>
      <option value="published" ${currentStatus === 'published' ? 'selected' : ''}>Published</option>
      <option value="archived" ${currentStatus === 'archived' ? 'selected' : ''}>Archived</option>
    `
  };
  
  return baseOptions[type] || baseOptions.feedback;
}

function getSubmissionContent(submission, type) {
  switch(type) {
    case 'membership':
      return `
        <p><strong>Type:</strong> ${submission.membership_type}</p>
        <p><strong>Organization:</strong> ${submission.organization || 'Not specified'}</p>
        <p><strong>Position:</strong> ${submission.position || 'Not specified'}</p>
        ${submission.message ? `<p><strong>Message:</strong> ${submission.message}</p>` : ''}
      `;
    case 'donations':
      return `
        <p><strong>Amount:</strong> $${submission.amount} ${submission.currency}</p>
        <p><strong>Payment Method:</strong> ${submission.payment_method}</p>
        ${submission.bank_name ? `<p><strong>Bank:</strong> ${submission.bank_name}</p>` : ''}
        ${submission.mtn_mobile_number ? `<p><strong>MTN Number:</strong> ${submission.mtn_mobile_number}</p>` : ''}
      `;
    case 'feedback':
      return `
        <p><strong>Category:</strong> ${submission.category}</p>
        ${submission.subject ? `<p><strong>Subject:</strong> ${submission.subject}</p>` : ''}
        <p><strong>Message:</strong> ${submission.message}</p>
        ${submission.rating ? `<p><strong>Rating:</strong> ${''.repeat(submission.rating)}${''.repeat(5-submission.rating)}</p>` : ''}
      `;
    case 'ideas':
      return `
        <p><strong>Title:</strong> ${submission.idea_title}</p>
        <p><strong>Category:</strong> ${submission.category}</p>
        <p><strong>Description:</strong> ${submission.description.substring(0, 200)}${submission.description.length > 200 ? '...' : ''}</p>
        ${submission.target_audience ? `<p><strong>Target Audience:</strong> ${submission.target_audience}</p>` : ''}
      `;
    case 'partnerships':
      return `
        <p><strong>Organization:</strong> ${submission.organization}</p>
        <p><strong>Partnership Type:</strong> ${submission.partnership_type}</p>
        ${submission.position ? `<p><strong>Position:</strong> ${submission.position}</p>` : ''}
        <p><strong>Proposal:</strong> ${submission.proposal ? submission.proposal.substring(0, 200) + (submission.proposal.length > 200 ? '...' : '') : 'No proposal provided'}</p>
      `;
    default:
      return '<p>No content available</p>';
  }
}

async function updateGetInvolvedStatus(type, id, status) {
  try {
    await apiRequest(`/get-involved/admin/${type}/${id}/status`, {
      method: 'PUT',
      body: JSON.stringify({ status })
    });
    // Reload the current tab
    showGetInvolvedTab(currentGetInvolvedTab);
  } catch (error) {
    console.error('Failed to update status:', error);
    alert('Failed to update status: ' + error.message);
  }
}

async function deleteGetInvolvedSubmission(type, id) {
  try {
    await apiRequest(`/get-involved/admin/${type}/${id}`, { method: 'DELETE' });
    // Reload the current tab
    showGetInvolvedTab(currentGetInvolvedTab);
  } catch (error) {
    console.error('Failed to delete submission:', error);
    alert('Failed to delete submission: ' + error.message);
  }
}

function editGetInvolvedItem(item, type) {
  alert(`Edit ${type} functionality coming soon!`);
  // TODO: Implement specific edit modals for each type
}

// ===== ENHANCED TAB MANAGEMENT =====

function initializeTabs() {
  // Get Involved Tabs
  document.querySelectorAll('.get-involved-tab[data-tab]').forEach(tab => {
    tab.addEventListener('click', (e) => {
      e.preventDefault();
      const tabName = tab.getAttribute('data-tab');
      if (tabName.startsWith('design-')) {
        showDesignTab(tabName);
      } else if (tabName.startsWith('research-')) {
        showResearchTab(tabName);
      } else if (tabName.startsWith('colleagues-')) {
        showColleaguesTab(tabName);
      } else if (tabName.startsWith('newsevents-')) {
        showNewsEventsTab(tabName);
      } else if (['photos', 'videos', 'designs', 'testimonials'].includes(tabName)) {
        showMediaTab(tabName);
      } else if (['workshops', 'tutorials', 'exhibitions'].includes(tabName)) {
        showEducationTab(tabName);
      } else {
        showGetInvolvedTab(tabName);
      }
    });
  });

  // Photo Category Filter
  document.querySelectorAll('.filter-btn[data-category]').forEach(btn => {
    btn.addEventListener('click', () => {
      const category = btn.getAttribute('data-category');
      currentPhotoCategory = category;
      
      document.querySelectorAll('.filter-btn').forEach(b => {
        b.classList.remove('active');
      });
      btn.classList.add('active');
      
      filterPhotosByCategory(category);
    });
  });
}

function showGetInvolvedTab(tabName) {
  hideAllTabs();
  showTab(tabName, 'get-involved');
  currentGetInvolvedTab = tabName;

  switch(tabName) {
    case 'membership': loadMembershipApplications(); break;
    case 'donations': loadDonations(); break;
    case 'feedback': loadFeedback(); break;
    case 'ideas': loadIdeas(); break;
    case 'partnerships': loadPartnerships(); break;
    case 'stories': loadStories(); break;
  }
}

function showMediaTab(tabName) {
  hideAllTabs();
  showTab(tabName, 'media');
  currentMediaTab = tabName;

  switch(tabName) {
    case 'photos': loadPhotos(); break;
    case 'videos': loadVideos(); break;
    case 'designs': loadDesigns(); break;
    case 'testimonials': loadTestimonials(); break;
  }
}

function showEducationTab(tabName) {
  hideAllTabs();
  showTab(tabName, 'education');
  currentEducationTab = tabName;

  switch(tabName) {
    case 'workshops': loadWorkshops(); break;
    case 'tutorials': loadTutorials(); break;
    case 'exhibitions': loadExhibitions(); break;
  }
}

function showDesignTab(tabName) {
  hideAllTabs();
  showTab(tabName, 'design');
  currentDesignTab = tabName;

  switch(tabName) {
    case 'design-all': loadDesignProjects(); break;
    case 'design-academic': loadAcademicProjects(); break;
    case 'design-professional': loadProfessionalProjects(); break;
    case 'design-competition': loadCompetitionProjects(); break;
  }
}

function showResearchTab(tabName) {
  hideAllTabs();
  showTab(tabName, 'research');
  currentResearchTab = tabName;

  switch(tabName) {
    case 'research-all': loadResearchArticles(); break;
    case 'research-sustainable': loadSustainableResearch(); break;
    case 'research-climate': loadClimateResearch(); break;
    case 'research-social': loadSocialResearch(); break;
    case 'research-technological': loadTechnologicalResearch(); break;
  }
}

function showNewsEventsTab(tabName) {
  hideAllTabs();
  showTab(tabName, 'newsevents');
  currentNewsEventsTab = tabName;

  switch(tabName) {
    case 'newsevents-all': loadAllNewsEvents(); break;
    case 'newsevents-news': loadNewsArticles(); break;
    case 'newsevents-events': loadEvents(); break;
  }
}

function showColleaguesTab(tabName) {
  hideAllTabs();
  showTab(tabName, 'colleagues');
  currentColleaguesTab = tabName;

  switch(tabName) {
    case 'colleagues-contacts': loadColleaguesContacts(); break;
    case 'colleagues-team': loadTeamMembers(); break;
    case 'colleagues-initiatives': loadInitiatives(); break;
  }
}

function hideAllTabs() {
  document.querySelectorAll('.get-involved-content').forEach(content => {
    content.classList.remove('active');
  });
  document.querySelectorAll('.get-involved-tab').forEach(tab => {
    tab.classList.remove('active');
  });
}

function showTab(tabName, prefix = '') {
  const contentId = prefix ? `${tabName}Tab` : tabName;
  const tabSelector = `[data-tab="${tabName}"]`;
  
  const contentElement = document.getElementById(contentId);
  const tabElement = document.querySelector(tabSelector);
  
  if (contentElement) contentElement.classList.add('active');
  if (tabElement) tabElement.classList.add('active');
}

// ===== ENHANCED EVENT LISTENERS =====

function initializeEventListeners() {
  // Mobile menu
  if (mobileMenuBtn) {
    mobileMenuBtn.addEventListener('click', () => {
      sidebar.classList.add('open');
      if (overlay) overlay.classList.add('active');
    });
  }

  if (overlay) {
    overlay.addEventListener('click', () => {
      sidebar.classList.remove('open');
      overlay.classList.remove('active');
    });
  }

  // Login button
  const loginBtn = document.getElementById('loginBtn');
  if (loginBtn) {
    loginBtn.addEventListener('click', handleLogin);
  }

  // Logout button
  const logoutBtn = document.getElementById('logoutBtn');
  if (logoutBtn) {
    logoutBtn.addEventListener('click', () => { 
      clearAuthData();
      showLogin();
    });
  }

  // Refresh buttons
  const refreshButtons = {
    'refreshSubmissions': loadContactSubmissions,
    'refreshGetInvolved': () => showGetInvolvedTab(currentGetInvolvedTab),
    'refreshMedia': () => { loadMediaStats(); showMediaTab(currentMediaTab); },
    'refreshEducation': () => { loadEducationStats(); showEducationTab(currentEducationTab); },
    'refreshDesign': () => { loadDesignStats(); showDesignTab(currentDesignTab); },
    'refreshNewsEvents': () => { loadNewsEventsStats(); showNewsEventsTab(currentNewsEventsTab); },
    'refreshResearch': () => { loadResearchStats(); showResearchTab(currentResearchTab); },
    'refreshColleagues': () => { loadColleaguesStats(); showColleaguesTab(currentColleaguesTab); }
  };

  Object.entries(refreshButtons).forEach(([id, handler]) => {
    const button = document.getElementById(id);
    if (button) {
      button.addEventListener('click', handler);
    }
  });

  // Initialize tabs
  initializeTabs();
  initializeNavigation();
}

// ===== DATA LOADING FUNCTIONS FOR OTHER SECTIONS =====

// Media Library
async function loadPhotos() {
  try {
    const data = await apiRequest('/media/photos');
    const container = document.getElementById('photosList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No photos found.</p>';
      return;
    }

    data.forEach(photo => {
      const el = createMediaElement(photo, 'photo');
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load photos:', error);
    const container = document.getElementById('photosList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading photos.</p>';
    }
  }
}

async function loadVideos() {
  try {
    const data = await apiRequest('/media/videos');
    const container = document.getElementById('videosList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No videos found.</p>';
      return;
    }

    data.forEach(video => {
      const el = createMediaElement(video, 'video');
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load videos:', error);
    const container = document.getElementById('videosList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading videos.</p>';
    }
  }
}

async function loadDesigns() {
  try {
    const data = await apiRequest('/media/designs');
    const container = document.getElementById('designsList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No designs found.</p>';
      return;
    }

    data.forEach(design => {
      const el = createMediaElement(design, 'design');
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load designs:', error);
    const container = document.getElementById('designsList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading designs.</p>';
    }
  }
}

async function loadTestimonials() {
  try {
    const data = await apiRequest('/media/testimonials');
    const container = document.getElementById('testimonialsList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No testimonials found.</p>';
      return;
    }

    data.forEach(testimonial => {
      const el = createTestimonialElement(testimonial);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load testimonials:', error);
    const container = document.getElementById('testimonialsList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading testimonials.</p>';
    }
  }
}

function createMediaElement(item, type) {
  const el = document.createElement('div');
  el.className = 'item';
  
  const content = document.createElement('div');
  content.className = 'item-content';
  
  const title = document.createElement('h4');
  title.className = 'item-title';
  title.textContent = item.title;
  
  const meta = document.createElement('div');
  meta.className = 'item-meta';
  
  const category = document.createElement('span');
  category.className = 'item-type';
  category.textContent = item.category || type;
  
  const date = document.createElement('span');
  date.className = 'item-date';
  date.textContent = item.created_at ? new Date(item.created_at).toLocaleDateString() : 'Unknown date';
  
  meta.appendChild(category);
  meta.appendChild(date);
  
  const preview = document.createElement('div');
  preview.className = 'item-preview';
  preview.textContent = item.description || 'No description available';
  
  content.appendChild(title);
  content.appendChild(meta);
  content.appendChild(preview);

  const actions = document.createElement('div');
  actions.className = 'item-actions';
  
  const featuredBtn = document.createElement('button');
  featuredBtn.className = item.is_featured ? 'btn-primary' : 'btn-secondary';
  featuredBtn.innerHTML = `<i class="fas ${item.is_featured ? 'fa-star' : 'fa-star'}"></i> ${item.is_featured ? 'Featured' : 'Feature'}`;
  featuredBtn.onclick = async () => {
    await toggleFeatured('media', type, item.id, !item.is_featured);
  };
  
  const editBtn = document.createElement('button');
  editBtn.className = 'btn-secondary';
  editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
  editBtn.onclick = () => editMediaItem(item, type);
  
  const del = document.createElement('button');
  del.className = 'btn-danger';
  del.innerHTML = '<i class="fas fa-trash"></i> Delete';
  del.onclick = async () => {
    if (confirm('Are you sure you want to delete this item?')) {
      await deleteMediaItem(type, item.id);
    }
  };
  
  actions.appendChild(featuredBtn);
  actions.appendChild(editBtn);
  actions.appendChild(del);
  content.appendChild(actions);
  
  if (item.image_url || item.thumbnail_url) {
    const imgContainer = document.createElement('div');
    imgContainer.style.marginLeft = '1rem';
    imgContainer.style.flexShrink = '0';
    
    const img = document.createElement('img');
    img.src = item.image_url || item.thumbnail_url;
    img.alt = item.title;
    img.style.width = '100px';
    img.style.height = '80px';
    img.style.objectFit = 'cover';
    img.style.borderRadius = '6px';
    img.style.border = '1px solid var(--border-light)';
    
    imgContainer.appendChild(img);
    el.appendChild(imgContainer);
  }
  
  el.appendChild(content);
  return el;
}

function createTestimonialElement(testimonial) {
  const el = document.createElement('div');
  el.className = 'submission-item';
  
  const stars = testimonial.rating ? ''.repeat(testimonial.rating) + ''.repeat(5 - testimonial.rating) : '';
  
  el.innerHTML = `
    <div class="submission-header">
      <div>
        <h4 style="margin: 0 0 0.5rem 0; color: var(--accent-light);">${testimonial.name}</h4>
        <p style="margin: 0; color: var(--text-muted);">${testimonial.role}${testimonial.organization ? ` at ${testimonial.organization}` : ''}</p>
      </div>
      <div>
        <span class="status-badge status-${testimonial.status || 'published'}">${testimonial.status || 'published'}</span>
        ${testimonial.is_featured ? '<span class="priority-badge priority-high" style="margin-left: 0.5rem;">Featured</span>' : ''}
        <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
          ${testimonial.created_at ? new Date(testimonial.created_at).toLocaleDateString() : 'Unknown date'}
        </div>
      </div>
    </div>
    ${stars ? `<div class="testimonial-rating">${stars}</div>` : ''}
    <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 8px; margin-top: 1rem;">
      <p style="margin: 0; font-style: italic;">"${testimonial.quote}"</p>
      ${testimonial.project ? `<p style="margin: 0.5rem 0 0 0; color: var(--text-muted); font-size: 0.9rem;">Project: ${testimonial.project}</p>` : ''}
    </div>
    <div class="submission-meta">
      <select onchange="updateTestimonialStatus(${testimonial.id}, this.value)">
        <option value="published" ${testimonial.status === 'published' ? 'selected' : ''}>Published</option>
        <option value="draft" ${testimonial.status === 'draft' ? 'selected' : ''}>Draft</option>
        <option value="archived" ${testimonial.status === 'archived' ? 'selected' : ''}>Archived</option>
      </select>
      <button class="btn-secondary" onclick="toggleFeatured('media', 'testimonials', ${testimonial.id}, ${!testimonial.is_featured})">
        <i class="fas ${testimonial.is_featured ? 'fa-star' : 'fa-star'}"></i> ${testimonial.is_featured ? 'Unfeature' : 'Feature'}
      </button>
      <button class="btn-danger" onclick="deleteMediaItem('testimonials', ${testimonial.id})">
        <i class="fas fa-trash"></i> Delete
      </button>
    </div>
  `;
  
  return el;
}

// Design Projects
async function loadDesignProjects() {
  try {
    const data = await apiRequest('/design/admin/projects');
    const container = document.getElementById('designProjectsList');
    if (!container) return;

    container.innerHTML = '';

    if (!data.data || data.data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No design projects found.</p>';
      return;
    }

    data.data.forEach(project => {
      const el = createDesignProjectElement(project);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load design projects:', error);
    const container = document.getElementById('designProjectsList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading design projects.</p>';
    }
  }
}

async function loadAcademicProjects() {
  try {
    const data = await apiRequest('/design/admin/projects/academic');
    const container = document.getElementById('academicProjectsList');
    if (!container) return;

    container.innerHTML = '';

    if (!data.data || data.data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No academic projects found.</p>';
      return;
    }

    data.data.forEach(project => {
      const el = createDesignProjectElement(project);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load academic projects:', error);
    const container = document.getElementById('academicProjectsList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading academic projects.</p>';
    }
  }
}

async function loadProfessionalProjects() {
  try {
    const data = await apiRequest('/design/admin/projects/professional');
    const container = document.getElementById('professionalProjectsList');
    if (!container) return;

    container.innerHTML = '';

    if (!data.data || data.data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No professional projects found.</p>';
      return;
    }

    data.data.forEach(project => {
      const el = createDesignProjectElement(project);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load professional projects:', error);
    const container = document.getElementById('professionalProjectsList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading professional projects.</p>';
    }
  }
}

async function loadCompetitionProjects() {
  try {
    const data = await apiRequest('/design/admin/projects/competition');
    const container = document.getElementById('competitionProjectsList');
    if (!container) return;

    container.innerHTML = '';

    if (!data.data || data.data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No competition projects found.</p>';
      return;
    }

    data.data.forEach(project => {
      const el = createDesignProjectElement(project);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load competition projects:', error);
    const container = document.getElementById('competitionProjectsList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading competition projects.</p>';
    }
  }
}

function createDesignProjectElement(project) {
  const el = document.createElement('div');
  el.className = 'item';
  el.setAttribute('data-sector', project.sector || '');
  
  const content = document.createElement('div');
  content.className = 'item-content';
  
  const title = document.createElement('h4');
  title.className = 'item-title';
  title.textContent = project.title;
  
  const meta = document.createElement('div');
  meta.className = 'item-meta';
  
  const category = document.createElement('span');
  category.className = 'item-type';
  category.textContent = project.category;
  
  const sector = document.createElement('span');
  sector.className = 'sector-badge';
  sector.textContent = sectorLabels[project.sector] || project.sector || 'No Sector';
  
  const status = document.createElement('span');
  status.className = 'item-date';
  status.textContent = project.is_published ? 'Published' : 'Draft';
  status.style.color = project.is_published ? 'var(--success)' : 'var(--warning)';
  
  meta.appendChild(category);
  meta.appendChild(sector);
  meta.appendChild(status);
  
  const preview = document.createElement('div');
  preview.className = 'item-preview';
  preview.textContent = project.summary || 'No summary available';
  
  // Add image preview if available
  if (project.main_image) {
    const imgContainer = document.createElement('div');
    imgContainer.style.marginLeft = '1rem';
    imgContainer.style.flexShrink = '0';
    
    const img = document.createElement('img');
    img.src = project.main_image;
    img.alt = project.title;
    img.style.width = '100px';
    img.style.height = '80px';
    img.style.objectFit = 'cover';
    img.style.borderRadius = '6px';
    img.style.border = '1px solid var(--border-light)';
    
    imgContainer.appendChild(img);
    el.appendChild(imgContainer);
  }
  
  content.appendChild(title);
  content.appendChild(meta);
  content.appendChild(preview);

  const actions = document.createElement('div');
  actions.className = 'item-actions';
  
  const editBtn = document.createElement('button');
  editBtn.className = 'btn-secondary';
  editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
  editBtn.onclick = () => editDesignProject(project);
  
  const toggleBtn = document.createElement('button');
  toggleBtn.className = project.is_published ? 'btn-warning' : 'btn-primary';
  toggleBtn.innerHTML = `<i class="fas ${project.is_published ? 'fa-eye-slash' : 'fa-eye'}"></i> ${project.is_published ? 'Unpublish' : 'Publish'}`;
  toggleBtn.onclick = async () => {
    await toggleDesignProject(project.id, !project.is_published);
  };
  
  const featuredBtn = document.createElement('button');
  featuredBtn.className = project.is_featured ? 'btn-warning' : 'btn-secondary';
  featuredBtn.innerHTML = `<i class="fas ${project.is_featured ? 'fa-star' : 'fa-star'}"></i> ${project.is_featured ? 'Unfeature' : 'Feature'}`;
  featuredBtn.onclick = async () => {
    await toggleFeaturedDesignProject(project.id, !project.is_featured);
  };
  
  const del = document.createElement('button');
  del.className = 'btn-danger';
  del.innerHTML = '<i class="fas fa-trash"></i> Delete';
  del.onclick = async () => {
    if (confirm('Are you sure you want to delete this design project?')) {
      await deleteDesignProject(project.id);
    }
  };
  
  actions.appendChild(editBtn);
  actions.appendChild(toggleBtn);
  actions.appendChild(featuredBtn);
  actions.appendChild(del);
  content.appendChild(actions);
  
  el.appendChild(content);
  return el;
}

// Research Insights
async function loadResearchArticles() {
  try {
    const data = await apiRequest('/research/admin/articles');
    const container = document.getElementById('researchArticlesList');
    if (!container) return;

    container.innerHTML = '';

    if (!data.data || data.data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No research articles found.</p>';
      return;
    }

    data.data.forEach(article => {
      const el = createResearchArticleElement(article);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load research articles:', error);
    const container = document.getElementById('researchArticlesList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading research articles.</p>';
    }
  }
}

async function loadSustainableResearch() {
  try {
    const data = await apiRequest('/research/articles/sustainable');
    const container = document.getElementById('sustainableResearchList');
    if (!container) return;

    container.innerHTML = '';

    if (!data.data || data.data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No sustainable design research found.</p>';
      return;
    }

    data.data.forEach(article => {
      const el = createResearchArticleElement(article);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load sustainable research:', error);
    const container = document.getElementById('sustainableResearchList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading sustainable research.</p>';
    }
  }
}

async function loadClimateResearch() {
  try {
    const data = await apiRequest('/research/articles/climate');
    const container = document.getElementById('climateResearchList');
    if (!container) return;

    container.innerHTML = '';

    if (!data.data || data.data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No climate resilience research found.</p>';
      return;
    }

    data.data.forEach(article => {
      const el = createResearchArticleElement(article);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load climate research:', error);
    const container = document.getElementById('climateResearchList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading climate research.</p>';
    }
  }
}

async function loadSocialResearch() {
  try {
    const data = await apiRequest('/research/articles/social');
    const container = document.getElementById('socialResearchList');
    if (!container) return;

    container.innerHTML = '';

    if (!data.data || data.data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No social impact research found.</p>';
      return;
    }

    data.data.forEach(article => {
      const el = createResearchArticleElement(article);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load social research:', error);
    const container = document.getElementById('socialResearchList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading social research.</p>';
    }
  }
}

async function loadTechnologicalResearch() {
  try {
    const data = await apiRequest('/research/articles/technological');
    const container = document.getElementById('technologicalResearchList');
    if (!container) return;

    container.innerHTML = '';

    if (!data.data || data.data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No technological innovation research found.</p>';
      return;
    }

    data.data.forEach(article => {
      const el = createResearchArticleElement(article);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load technological research:', error);
    const container = document.getElementById('technologicalResearchList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading technological research.</p>';
    }
  }
}

function createResearchArticleElement(article) {
  const el = document.createElement('div');
  el.className = 'item';
  
  const content = document.createElement('div');
  content.className = 'item-content';
  
  const title = document.createElement('h4');
  title.className = 'item-title';
  title.textContent = article.title;
  
  const meta = document.createElement('div');
  meta.className = 'item-meta';
  
  const category = document.createElement('span');
  category.className = 'item-type';
  category.textContent = getCategoryDisplayName(article.category);
  
  const authors = document.createElement('span');
  authors.className = 'item-date';
  authors.textContent = article.authors || 'Unknown authors';
  
  meta.appendChild(category);
  meta.appendChild(authors);
  
  const preview = document.createElement('div');
  preview.className = 'item-preview';
  preview.textContent = article.abstract || article.content?.substring(0, 150) + '...' || 'No abstract available';
  
  // Add publication date if available
  if (article.publication_date) {
    const pubDate = document.createElement('div');
    pubDate.className = 'item-date';
    pubDate.textContent = `Published: ${new Date(article.publication_date).toLocaleDateString()}`;
    meta.appendChild(pubDate);
  }
  
  // Add image preview if available
  if (article.main_image) {
    const imgContainer = document.createElement('div');
    imgContainer.style.marginLeft = '1rem';
    imgContainer.style.flexShrink = '0';
    
    const img = document.createElement('img');
    img.src = article.main_image;
    img.alt = article.title;
    img.style.width = '100px';
    img.style.height = '80px';
    img.style.objectFit = 'cover';
    img.style.borderRadius = '6px';
    img.style.border = '1px solid var(--border-light)';
    
    imgContainer.appendChild(img);
    el.appendChild(imgContainer);
  }
  
  content.appendChild(title);
  content.appendChild(meta);
  content.appendChild(preview);

  const actions = document.createElement('div');
  actions.className = 'item-actions';
  
  const editBtn = document.createElement('button');
  editBtn.className = 'btn-secondary';
  editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
  editBtn.onclick = () => editResearchArticle(article);
  
  const toggleBtn = document.createElement('button');
  toggleBtn.className = article.is_published ? 'btn-warning' : 'btn-primary';
  toggleBtn.innerHTML = `<i class="fas ${article.is_published ? 'fa-eye-slash' : 'fa-eye'}"></i> ${article.is_published ? 'Unpublish' : 'Publish'}`;
  toggleBtn.onclick = async () => {
    await toggleResearchArticle(article.id, !article.is_published);
  };
  
  const featuredBtn = document.createElement('button');
  featuredBtn.className = article.is_featured ? 'btn-warning' : 'btn-secondary';
  featuredBtn.innerHTML = `<i class="fas ${article.is_featured ? 'fa-star' : 'fa-star'}"></i> ${article.is_featured ? 'Unfeature' : 'Feature'}`;
  featuredBtn.onclick = async () => {
    await toggleFeaturedResearchArticle(article.id, !article.is_featured);
  };
  
  const del = document.createElement('button');
  del.className = 'btn-danger';
  del.innerHTML = '<i class="fas fa-trash"></i> Delete';
  del.onclick = async () => {
    if (confirm('Are you sure you want to delete this research article?')) {
      await deleteResearchArticle(article.id);
    }
  };
  
  actions.appendChild(editBtn);
  actions.appendChild(toggleBtn);
  actions.appendChild(featuredBtn);
  actions.appendChild(del);
  content.appendChild(actions);
  
  el.appendChild(content);
  return el;
}

function getCategoryDisplayName(category) {
  const categories = {
    'sustainable': 'Sustainable Design',
    'climate': 'Climate Resilience',
    'social': 'Social Impact',
    'technological': 'Technological Innovation'
  };
  return categories[category] || category;
}

// News & Events
async function loadAllNewsEvents() {
  try {
    const data = await apiRequest('/newsevents/all');
    const container = document.getElementById('allNewsEventsList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No news or events found.</p>';
      return;
    }

    data.forEach(item => {
      const el = createNewsEventElement(item);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load all news & events:', error);
    const container = document.getElementById('allNewsEventsList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading news and events.</p>';
    }
  }
}

async function loadNewsArticles() {
  try {
    const data = await apiRequest('/newsevents/news');
    const container = document.getElementById('newsArticlesList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No news articles found.</p>';
      return;
    }

    data.forEach(article => {
      const el = createNewsEventElement(article);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load news articles:', error);
    const container = document.getElementById('newsArticlesList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading news articles.</p>';
    }
  }
}

async function loadEvents() {
  try {
    const data = await apiRequest('/newsevents/events');
    const container = document.getElementById('eventsList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No events found.</p>';
      return;
    }

    data.forEach(event => {
      const el = createNewsEventElement(event);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load events:', error);
    const container = document.getElementById('eventsList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading events.</p>';
    }
  }
}

function createNewsEventElement(item) {
  const el = document.createElement('div');
  el.className = 'item';
  
  const content = document.createElement('div');
  content.className = 'item-content';
  
  const title = document.createElement('h4');
  title.className = 'item-title';
  title.textContent = item.title;
  
  const meta = document.createElement('div');
  meta.className = 'item-meta';
  
  const type = document.createElement('span');
  type.className = item.type === 'news' ? 'news-badge' : 'event-badge';
  type.textContent = item.type === 'news' ? 'News' : 'Event';
  
  const author = document.createElement('span');
  author.className = 'item-type';
  author.textContent = `By ${item.author}`;
  
  const date = document.createElement('span');
  date.className = 'item-date';
  date.textContent = new Date(item.date).toLocaleDateString();
  
  const status = document.createElement('span');
  status.className = 'item-date';
  status.textContent = item.is_published ? 'Published' : 'Draft';
  status.style.color = item.is_published ? 'var(--success)' : 'var(--warning)';
  
  meta.appendChild(type);
  meta.appendChild(author);
  meta.appendChild(date);
  meta.appendChild(status);
  
  const preview = document.createElement('div');
  preview.className = 'item-preview';
  preview.textContent = item.excerpt || item.description || 'No excerpt available';
  
  // Add date and location for events
  if (item.type === 'event') {
    const dateDisplay = document.createElement('div');
    dateDisplay.className = 'date-display';
    dateDisplay.innerHTML = `<strong>Date:</strong> ${new Date(item.eventDate).toLocaleDateString()}`;
    
    const timeDisplay = document.createElement('div');
    timeDisplay.className = 'date-display';
    timeDisplay.innerHTML = `<strong>Time:</strong> ${item.eventTime}`;
    
    const locationDisplay = document.createElement('div');
    locationDisplay.className = 'location-display';
    locationDisplay.innerHTML = `<strong>Location:</strong> ${item.location}`;
    
    content.appendChild(dateDisplay);
    content.appendChild(timeDisplay);
    content.appendChild(locationDisplay);
  }
  
  // Add image preview if available
  if (item.image) {
    const imgContainer = document.createElement('div');
    imgContainer.style.marginLeft = '1rem';
    imgContainer.style.flexShrink = '0';
    
    const img = document.createElement('img');
    img.src = item.image;
    img.alt = item.title;
    img.style.width = '100px';
    img.style.height = '80px';
    img.style.objectFit = 'cover';
    img.style.borderRadius = '6px';
    img.style.border = '1px solid var(--border-light)';
    
    imgContainer.appendChild(img);
    el.appendChild(imgContainer);
  }
  
  content.appendChild(title);
  content.appendChild(meta);
  content.appendChild(preview);

  const actions = document.createElement('div');
  actions.className = 'item-actions';
  
  const editBtn = document.createElement('button');
  editBtn.className = 'btn-secondary';
  editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
  editBtn.onclick = () => editNewsEvent(item);
  
  const toggleBtn = document.createElement('button');
  toggleBtn.className = item.is_published ? 'btn-warning' : 'btn-primary';
  toggleBtn.innerHTML = `<i class="fas ${item.is_published ? 'fa-eye-slash' : 'fa-eye'}"></i> ${item.is_published ? 'Unpublish' : 'Publish'}`;
  toggleBtn.onclick = async () => {
    await toggleNewsEvent(item.id, !item.is_published, item.type);
  };
  
  const featuredBtn = document.createElement('button');
  featuredBtn.className = item.is_featured ? 'btn-warning' : 'btn-secondary';
  featuredBtn.innerHTML = `<i class="fas ${item.is_featured ? 'fa-star' : 'fa-star'}"></i> ${item.is_featured ? 'Unfeature' : 'Feature'}`;
  featuredBtn.onclick = async () => {
    await toggleFeaturedNewsEvent(item.id, !item.is_featured, item.type);
  };
  
  const del = document.createElement('button');
  del.className = 'btn-danger';
  del.innerHTML = '<i class="fas fa-trash"></i> Delete';
  del.onclick = async () => {
    if (confirm(`Are you sure you want to delete this ${item.type}?`)) {
      await deleteNewsEvent(item.id, item.type);
    }
  };
  
  actions.appendChild(editBtn);
  actions.appendChild(toggleBtn);
  actions.appendChild(featuredBtn);
  actions.appendChild(del);
  content.appendChild(actions);
  
  el.appendChild(content);
  return el;
}

// Architecture Colleagues
async function loadColleaguesContacts() {
  try {
    const data = await apiRequest('/thecolleagueuni/contacts');
    const container = document.getElementById('colleaguesContactsList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No contact submissions found.</p>';
      return;
    }

    data.forEach(contact => {
      const el = createContactElement(contact);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load colleagues contacts:', error);
    const container = document.getElementById('colleaguesContactsList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading contacts.</p>';
    }
  }
}

async function loadTeamMembers() {
  try {
    const data = await apiRequest('/thecolleagueuni/team');
    const container = document.getElementById('colleaguesTeamList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No team members found.</p>';
      return;
    }

    data.forEach(member => {
      const el = createTeamMemberElement(member);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load team members:', error);
    const container = document.getElementById('colleaguesTeamList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading team members.</p>';
    }
  }
}

async function loadInitiatives() {
  try {
    const data = await apiRequest('/colleagues/initiatives');
    const container = document.getElementById('colleaguesInitiativesList');
    if (!container) return;

    container.innerHTML = '';

    if (!data || data.length === 0) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">No initiatives found.</p>';
      return;
    }

    data.forEach(initiative => {
      const el = createInitiativeElement(initiative);
      container.appendChild(el);
    });
  } catch (error) {
    console.error('Failed to load initiatives:', error);
    const container = document.getElementById('colleaguesInitiativesList');
    if (container) {
      container.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 2rem;">Error loading initiatives.</p>';
    }
  }
}

function createContactElement(contact) {
  const el = document.createElement('div');
  el.className = 'submission-item';
  
  el.innerHTML = `
    <div class="submission-header">
      <div>
        <h4 style="margin: 0 0 0.5rem 0; color: var(--accent-light);">${contact.name}</h4>
        <p style="margin: 0; color: var(--text-muted);">${contact.email}</p>
        ${contact.organization ? `<p style="margin: 0; color: var(--text-muted);">${contact.organization}</p>` : ''}
      </div>
      <div>
        <span class="status-badge status-${contact.status || 'new'}">${contact.status || 'new'}</span>
        <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
          ${contact.created_at ? new Date(contact.created_at).toLocaleDateString() : 'Unknown date'}
        </div>
      </div>
    </div>
    <div style="padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 8px; margin-top: 1rem;">
      <p style="margin: 0;">${contact.message}</p>
    </div>
    <div class="submission-meta">
      <select onchange="updateColleaguesContactStatus(${contact.id}, this.value)">
        <option value="new" ${contact.status === 'new' ? 'selected' : ''}>New</option>
        <option value="contacted" ${contact.status === 'contacted' ? 'selected' : ''}>Contacted</option>
        <option value="responded" ${contact.status === 'responded' ? 'selected' : ''}>Responded</option>
        <option value="archived" ${contact.status === 'archived' ? 'selected' : ''}>Archived</option>
      </select>
      <button class="btn-danger" onclick="deleteColleaguesContact(${contact.id})">
        <i class="fas fa-trash"></i> Delete
      </button>
    </div>
  `;
  
  return el;
}

function createTeamMemberElement(member) {
  const el = document.createElement('div');
  el.className = 'item';
  
  const content = document.createElement('div');
  content.className = 'item-content';
  
  const title = document.createElement('h4');
  title.className = 'item-title';
  title.textContent = member.name;
  
  const meta = document.createElement('div');
  meta.className = 'item-meta';
  
  const role = document.createElement('span');
  role.className = 'item-type';
  role.textContent = member.role;
  
  const status = document.createElement('span');
  status.className = 'item-date';
  status.textContent = member.is_active ? 'Active' : 'Inactive';
  status.style.color = member.is_active ? 'var(--success)' : 'var(--warning)';
  
  meta.appendChild(role);
  meta.appendChild(status);
  
  const preview = document.createElement('div');
  preview.className = 'item-preview';
  preview.textContent = member.bio || 'No bio available';
  
  content.appendChild(title);
  content.appendChild(meta);
  content.appendChild(preview);

  const actions = document.createElement('div');
  actions.className = 'item-actions';
  
  const editBtn = document.createElement('button');
  editBtn.className = 'btn-secondary';
  editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
  editBtn.onclick = () => editTeamMember(member);
  
  const toggleBtn = document.createElement('button');
  toggleBtn.className = member.is_active ? 'btn-warning' : 'btn-primary';
  toggleBtn.innerHTML = `<i class="fas ${member.is_active ? 'fa-user-slash' : 'fa-user-check'}"></i> ${member.is_active ? 'Deactivate' : 'Activate'}`;
  toggleBtn.onclick = async () => {
    await toggleTeamMember(member.id, !member.is_active);
  };
  
  const del = document.createElement('button');
  del.className = 'btn-danger';
  del.innerHTML = '<i class="fas fa-trash"></i> Delete';
  del.onclick = async () => {
    if (confirm('Are you sure you want to delete this team member?')) {
      await deleteTeamMember(member.id);
    }
  };
  
  actions.appendChild(editBtn);
  actions.appendChild(toggleBtn);
  actions.appendChild(del);
  content.appendChild(actions);
  
  if (member.image_url) {
    const imgContainer = document.createElement('div');
    imgContainer.style.marginLeft = '1rem';
    imgContainer.style.flexShrink = '0';
    
    const img = document.createElement('img');
    img.src = member.image_url;
    img.alt = member.name;
    img.style.width = '100px';
    img.style.height = '80px';
    img.style.objectFit = 'cover';
    img.style.borderRadius = '6px';
    img.style.border = '1px solid var(--border-light)';
    
    imgContainer.appendChild(img);
    el.appendChild(imgContainer);
  }
  
  el.appendChild(content);
  return el;
}

function createInitiativeElement(initiative) {
  const el = document.createElement('div');
  el.className = 'item';
  
  const content = document.createElement('div');
  content.className = 'item-content';
  
  const title = document.createElement('h4');
  title.className = 'item-title';
  title.textContent = initiative.title;
  
  const meta = document.createElement('div');
  meta.className = 'item-meta';
  
  const status = document.createElement('span');
  status.className = 'item-type';
  status.textContent = initiative.status;
  status.style.color = getStatusColor(initiative.status);
  
  const date = document.createElement('span');
  date.className = 'item-date';
  date.textContent = initiative.target_date ? new Date(initiative.target_date).toLocaleDateString() : 'No target date';
  
  meta.appendChild(status);
  meta.appendChild(date);
  
  const preview = document.createElement('div');
  preview.className = 'item-preview';
  preview.textContent = initiative.description || 'No description available';
  
  content.appendChild(title);
  content.appendChild(meta);
  content.appendChild(preview);

  const actions = document.createElement('div');
  actions.className = 'item-actions';
  
  const editBtn = document.createElement('button');
  editBtn.className = 'btn-secondary';
  editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
  editBtn.onclick = () => editInitiative(initiative);
  
  const toggleBtn = document.createElement('button');
  toggleBtn.className = initiative.is_active ? 'btn-warning' : 'btn-primary';
  toggleBtn.innerHTML = `<i class="fas ${initiative.is_active ? 'fa-pause' : 'fa-play'}"></i> ${initiative.is_active ? 'Pause' : 'Activate'}`;
  toggleBtn.onclick = async () => {
    await toggleInitiative(initiative.id, !initiative.is_active);
  };
  
  const del = document.createElement('button');
  del.className = 'btn-danger';
  del.innerHTML = '<i class="fas fa-trash"></i> Delete';
  del.onclick = async () => {
    if (confirm('Are you sure you want to delete this initiative?')) {
      await deleteInitiative(initiative.id);
    }
  };
  
  actions.appendChild(editBtn);
  actions.appendChild(toggleBtn);
  actions.appendChild(del);
  content.appendChild(actions);
  
  el.appendChild(content);
  return el;
}

function getStatusColor(status) {
  const colors = {
    'planned': 'var(--info)',
    'in_progress': 'var(--warning)',
    'completed': 'var(--success)',
    'on_hold': 'var(--danger)'
  };
  return colors[status] || 'var(--text-muted)';
}

// ===== STATS LOADING FUNCTIONS =====

async function loadMediaStats() {
  try {
    const stats = await apiRequest('/media/stats');
    mediaStats = stats;
    
    document.getElementById('photosCount').textContent = stats.photos || 0;
    document.getElementById('videosCount').textContent = stats.videos || 0;
    document.getElementById('designsCount').textContent = stats.designs || 0;
    document.getElementById('testimonialsCount').textContent = stats.testimonials || 0;
  } catch (error) {
    console.error('Failed to load media stats:', error);
  }
}

async function loadEducationStats() {
  try {
    const stats = await apiRequest('/education/stats');
    educationStats = stats;
    
    document.getElementById('workshopsCount').textContent = stats.workshops || 0;
    document.getElementById('tutorialsCount').textContent = stats.tutorials || 0;
    document.getElementById('exhibitionsCount').textContent = stats.exhibitions || 0;
    document.getElementById('totalEnrolled').textContent = stats.totalEnrolled || 0;

    // Update dashboard stats
    document.getElementById('workshopCount').textContent = stats.workshops || 0;
    document.getElementById('tutorialCount').textContent = stats.tutorials || 0;
  } catch (error) {
    console.error('Failed to load education stats:', error);
  }
}

async function loadDesignStats() {
  try {
    const data = await apiRequest('/design/admin/stats');
    designStats.total = data.data.total || 0;
    designStats.academic = data.data.academic || 0;
    designStats.professional = data.data.professional || 0;
    designStats.competition = data.data.competition || 0;
    designStats.featured = data.data.featured || 0;

    // Update dashboard stats
    document.getElementById('designProjectsCount').textContent = designStats.total;
    document.getElementById('designTotalProjects').textContent = designStats.total;
    document.getElementById('designAcademicProjects').textContent = designStats.academic;
    document.getElementById('designProfessionalProjects').textContent = designStats.professional;
    document.getElementById('designCompetitionProjects').textContent = designStats.competition;
  } catch (error) {
    console.error('Failed to load design stats:', error);
  }
}

async function loadResearchStats() {
  try {
    const data = await apiRequest('/research/admin/stats');
    researchStats.articles = data.data.total || 0;
    researchStats.sustainable = data.data.sustainable || 0;
    researchStats.climate = data.data.climate || 0;
    researchStats.social = data.data.social || 0;
    researchStats.technological = data.data.technological || 0;
    researchStats.featured = data.data.featured || 0;

    // Update dashboard stats
    document.getElementById('researchArticlesCount').textContent = researchStats.articles;
    document.getElementById('researchTotalArticles').textContent = researchStats.articles;
    document.getElementById('researchSustainable').textContent = researchStats.sustainable;
    document.getElementById('researchClimate').textContent = researchStats.climate;
    document.getElementById('researchSocial').textContent = researchStats.social;
    document.getElementById('researchFeatured').textContent = researchStats.featured;
  } catch (error) {
    console.error('Failed to load research stats:', error);
  }
}

async function loadNewsEventsStats() {
  try {
    const data = await apiRequest('/newsevents/health');
    newsEventsStats.news = data.counts?.news || 0;
    newsEventsStats.events = data.counts?.events || 0;
    
    // For featured counts, we'd need to load actual data and filter
    // For now, we'll set placeholder values
    newsEventsStats.featuredNews = 0;
    newsEventsStats.featuredEvents = 0;

    // Update dashboard stats
    document.getElementById('newsCount').textContent = newsEventsStats.news;
    document.getElementById('eventsCount').textContent = newsEventsStats.events;
    
    // Update news & events section stats
    document.getElementById('newsTotal').textContent = newsEventsStats.news;
    document.getElementById('eventsTotal').textContent = newsEventsStats.events;
    document.getElementById('newsFeatured').textContent = newsEventsStats.featuredNews;
    document.getElementById('eventsFeatured').textContent = newsEventsStats.featuredEvents;
  } catch (error) {
    console.error('Failed to load news & events stats:', error);
  }
}

async function loadColleaguesStats() {
  try {
    // Get contacts count from /thecolleagueuni/contacts
    const contactsResponse = await apiRequest('/thecolleagueuni/contacts');
    colleaguesStats.contacts = Array.isArray(contactsResponse) ? contactsResponse.length : 0;
    colleaguesStats.newContacts = Array.isArray(contactsResponse) ? 
      contactsResponse.filter(c => c.status === 'new').length : 0;

    // Get team members count from /thecolleagueuni/team
    const teamResponse = await apiRequest('/thecolleagueuni/team');
    colleaguesStats.team = Array.isArray(teamResponse) ? teamResponse.length : 0;

    // Get initiatives count from /thecolleagueuni/initiatives
    const initiativesResponse = await apiRequest('/thecolleagueuni/initiatives');
    colleaguesStats.initiatives = Array.isArray(initiativesResponse) ? initiativesResponse.length : 0;

    // Update stats display if elements exist
    const elements = {
      'colleaguesTotalContacts': colleaguesStats.contacts,
      'colleaguesTeamMembers': colleaguesStats.team,
      'colleaguesInitiatives': colleaguesStats.initiatives,
      'colleaguesNewContacts': colleaguesStats.newContacts,
      'colleaguesContactCount': colleaguesStats.contacts
    };

    Object.entries(elements).forEach(([id, value]) => {
      const element = document.getElementById(id);
      if (element) {
        element.textContent = value;
      }
    });

  } catch (error) {
    console.error('Failed to load colleagues stats:', error);
    // Set default values on error
    colleaguesStats = { contacts: 0, team: 0, initiatives: 0, newContacts: 0 };
  }
}

// ===== FILTER FUNCTIONS =====

function filterPhotosByCategory(category) {
  const container = document.getElementById('photosList');
  if (!container) return;
  
  const items = container.querySelectorAll('.item');
  items.forEach(item => {
    const typeElement = item.querySelector('.item-type');
    if (typeElement) {
      const itemCategory = typeElement.textContent;
      if (category === 'All' || itemCategory === category) {
        item.style.display = 'flex';
      } else {
        item.style.display = 'none';
      }
    }
  });
}

function filterDesignProjectsBySector() {
  const sector = document.getElementById('sectorFilter')?.value;
  filterProjectsBySector('designProjectsList', sector);
}

function filterAcademicProjectsBySector() {
  const sector = document.getElementById('academicSectorFilter')?.value;
  filterProjectsBySector('academicProjectsList', sector);
}

function filterProfessionalProjectsBySector() {
  const sector = document.getElementById('professionalSectorFilter')?.value;
  filterProjectsBySector('professionalProjectsList', sector);
}

function filterCompetitionProjectsBySector() {
  const sector = document.getElementById('competitionSectorFilter')?.value;
  filterProjectsBySector('competitionProjectsList', sector);
}

function filterProjectsBySector(containerId, sector) {
  const container = document.getElementById(containerId);
  if (!container) return;
  
  const projects = container.querySelectorAll('.item');
  projects.forEach(project => {
    const projectSector = project.getAttribute('data-sector');
    if (!sector || projectSector === sector) {
      project.style.display = 'flex';
    } else {
      project.style.display = 'none';
    }
  });
}

// ===== MODAL FUNCTIONS =====

// Base Modal Functions
function showModal(modalId) {
  const modal = document.getElementById(modalId);
  const overlay = document.getElementById('overlay');
  if (modal) {
    modal.classList.remove('hidden');
    modal.style.zIndex = 1101;
  }
  if (overlay) overlay.classList.add('active');
}

function hideModal(modalId) {
  const modal = document.getElementById(modalId);
  const overlay = document.getElementById('overlay');
  if (modal) modal.classList.add('hidden');
  if (overlay) overlay.classList.remove('active');
}

// Modal Show/Hide Functions
function showAddNewsModal() { showModal('addNewsModal'); }
function hideAddNewsModal() { hideModal('addNewsModal'); }
function showAddEventModal() { showModal('addEventModal'); }
function hideAddEventModal() { hideModal('addEventModal'); }
function showAddDesignProjectModal(category = null) { 
    if (category) {
        document.getElementById('addDesignProjectCategory').value = category;
    }
    showModal('addDesignProjectModal'); 
}
function hideAddDesignProjectModal() { hideModal('addDesignProjectModal'); }
function showAddResearchModal(category = null) { 
    if (category) {
        document.getElementById('addResearchCategory').value = category;
    }
    showModal('addResearchModal'); 
}
function hideAddResearchModal() { hideModal('addResearchModal'); }
function showAddStoryModal() { showModal('addStoryModal'); }
function hideAddStoryModal() { hideModal('addStoryModal'); }
function showAddPhotoModal() { showModal('addPhotoModal'); }
function hideAddPhotoModal() { hideModal('addPhotoModal'); }
function showAddVideoModal() { showModal('addVideoModal'); }
function hideAddVideoModal() { hideModal('addVideoModal'); }
function showAddWorkshopModal() { showModal('addWorkshopModal'); }
function hideAddWorkshopModal() { hideModal('addWorkshopModal'); }
function showAddTutorialModal() { showModal('addTutorialModal'); }
function hideAddTutorialModal() { hideModal('addTutorialModal'); }
function showAddTestimonialModal() { showModal('addTestimonialModal'); }
function hideAddTestimonialModal() { hideModal('addTestimonialModal'); }
function showAddTeamMemberModal() { showModal('addTeamMemberModal'); }
function hideAddTeamMemberModal() { hideModal('addTeamMemberModal'); }
function showAddInitiativeModal() { showModal('addInitiativeModal'); }
function hideAddInitiativeModal() { hideModal('addInitiativeModal'); }
function showAddDesignModal() { showModal('addDesignModal'); }
function hideAddDesignModal() { hideModal('addDesignModal'); }
function showAddExhibitionModal() { showModal('addExhibitionModal'); }
function hideAddExhibitionModal() { hideModal('addExhibitionModal'); }

// Edit modal functions
function showEditNewsModal() { showModal('editNewsModal'); }
function hideEditNewsModal() { hideModal('editNewsModal'); }
function showEditEventModal() { showModal('editEventModal'); }
function hideEditEventModal() { hideModal('editEventModal'); }
function showEditContactModal() { showModal('editContactModal'); }
function hideEditContactModal() { hideModal('editContactModal'); }
function showEditDesignProjectModal() { showModal('editDesignProjectModal'); }
function hideEditDesignProjectModal() { hideModal('editDesignProjectModal'); }
function showEditResearchModal() { showModal('editResearchModal'); }
function hideEditResearchModal() { hideModal('editResearchModal'); }
function showEditWorkshopModal() { showModal('editWorkshopModal'); }
function hideEditWorkshopModal() { hideModal('editWorkshopModal'); }
function showEditTeamMemberModal() { showModal('editTeamMemberModal'); }
function hideEditTeamMemberModal() { hideModal('editTeamMemberModal'); }

// ===== FORM HANDLERS =====

// Add News Handler
async function handleAddNews(event) {
  event.preventDefault();
  
  try {
    const formData = new FormData();
    formData.append('title', document.getElementById('addNewsTitle').value);
    formData.append('excerpt', document.getElementById('addNewsExcerpt').value);
    formData.append('content', document.getElementById('addNewsContent').value);
    formData.append('author', document.getElementById('addNewsAuthor').value);
    formData.append('category', document.getElementById('addNewsCategory').value);
    formData.append('date', document.getElementById('addNewsDate').value);
    formData.append('readTime', document.getElementById('addNewsReadTime').value);
    formData.append('isFeatured', document.getElementById('addNewsFeatured').checked);
    formData.append('isPublished', document.getElementById('addNewsPublished').checked);

    const imageFile = document.getElementById('addNewsImageInput').files[0];
    if (imageFile) {
      formData.append('image', imageFile);
    }

    await apiRequest('/newsevents/news', {
      method: 'POST',
      body: formData
    });

    hideAddNewsModal();
    await loadNewsArticles();
    await loadAllNewsEvents();
    alert('News article added successfully!');
  } catch (error) {
    console.error('Failed to add news:', error);
    alert('Failed to add news: ' + error.message);
  }
}

// Add Event Handler
async function handleAddEvent(event) {
  event.preventDefault();
  
  try {
    const formData = new FormData();
    formData.append('title', document.getElementById('addEventTitle').value);
    formData.append('description', document.getElementById('addEventDescription').value);
    formData.append('excerpt', document.getElementById('addEventExcerpt').value);
    formData.append('eventDate', document.getElementById('addEventDate').value);
    formData.append('eventTime', document.getElementById('addEventTime').value);
    formData.append('location', document.getElementById('addEventLocation').value);
    formData.append('category', document.getElementById('addEventCategory').value);
    formData.append('author', document.getElementById('addEventAuthor').value);
    formData.append('readTime', document.getElementById('addEventReadTime').value);
    formData.append('isFeatured', document.getElementById('addEventFeatured').checked);
    formData.append('isPublished', document.getElementById('addEventPublished').checked);

    const imageFile = document.getElementById('addEventImageInput').files[0];
    if (imageFile) {
      formData.append('image', imageFile);
    }

    await apiRequest('/newsevents/events', {
      method: 'POST',
      body: formData
    });

    hideAddEventModal();
    await loadEvents();
    await loadAllNewsEvents();
    alert('Event added successfully!');
  } catch (error) {
    console.error('Failed to add event:', error);
    alert('Failed to add event: ' + error.message);
  }
}

// Add Design Project Handler
async function handleAddDesignProject(event) {
  event.preventDefault();
  
  try {
    const formData = new FormData();
    formData.append('title', document.getElementById('addDesignProjectTitle').value);
    formData.append('summary', document.getElementById('addDesignProjectSummary').value);
    formData.append('description', document.getElementById('addDesignProjectDescription').value);
    formData.append('category', document.getElementById('addDesignProjectCategory').value);
    formData.append('sector', document.getElementById('addDesignProjectSector').value);
    formData.append('displayOrder', document.getElementById('addDesignProjectDisplayOrder').value);
    formData.append('isFeatured', document.getElementById('addDesignProjectFeatured').checked);
    formData.append('isPublished', document.getElementById('addDesignProjectPublished').checked);

    const mainImageFile = document.getElementById('addMainImageInput').files[0];
    if (mainImageFile) {
      formData.append('mainImage', mainImageFile);
    }

    await apiRequest('/design/admin/projects', {
      method: 'POST',
      body: formData
    });

    hideAddDesignProjectModal();
    await loadDesignProjects();
    alert('Design project added successfully!');
  } catch (error) {
    console.error('Failed to add design project:', error);
    alert('Failed to add design project: ' + error.message);
  }
}

// Add Research Article Handler
async function handleAddResearch(event) {
  event.preventDefault();
  
  try {
    const researchData = {
      title: document.getElementById('addResearchTitle').value,
      abstract: document.getElementById('addResearchAbstract').value,
      content: document.getElementById('addResearchContent').value,
      category: document.getElementById('addResearchCategory').value,
      authors: document.getElementById('addResearchAuthors').value,
      publicationDate: document.getElementById('addResearchPublicationDate').value,
      mainImage: document.getElementById('addResearchMainImage').value,
      displayOrder: document.getElementById('addResearchDisplayOrder').value,
      isFeatured: document.getElementById('addResearchFeatured').checked,
      isPublished: document.getElementById('addResearchPublished').checked
    };

    await apiRequest('/research/admin/articles', {
      method: 'POST',
      body: JSON.stringify(researchData)
    });

    hideAddResearchModal();
    await loadResearchArticles();
    alert('Research article added successfully!');
  } catch (error) {
    console.error('Failed to add research article:', error);
    alert('Failed to add research article: ' + error.message);
  }
}

// Add Workshop Handler
async function handleAddWorkshop(event) {
  event.preventDefault();
  
  try {
    const workshopData = {
      title: document.getElementById('addWorkshopTitle').value,
      description: document.getElementById('addWorkshopDescription').value,
      instructor: document.getElementById('addWorkshopInstructor').value,
      date: document.getElementById('addWorkshopDate').value,
      time: document.getElementById('addWorkshopTime').value,
      location: document.getElementById('addWorkshopLocation').value,
      capacity: document.getElementById('addWorkshopCapacity').value,
      isPublished: document.getElementById('addWorkshopPublished').checked
    };

    await apiRequest('/education/workshops', {
      method: 'POST',
      body: JSON.stringify(workshopData)
    });

    hideAddWorkshopModal();
    await loadWorkshops();
    alert('Workshop added successfully!');
  } catch (error) {
    console.error('Failed to add workshop:', error);
    alert('Failed to add workshop: ' + error.message);
  }
}

// Add Photo Handler
async function handleAddPhoto(event) {
  event.preventDefault();
  
  try {
    const formData = new FormData();
    formData.append('title', document.getElementById('addPhotoTitle').value);
    formData.append('description', document.getElementById('addPhotoDescription').value);
    formData.append('category', document.getElementById('addPhotoCategory').value);
    formData.append('isFeatured', document.getElementById('addPhotoFeatured').checked);
    formData.append('isPublished', document.getElementById('addPhotoPublished').checked);

    const photoFile = document.getElementById('addPhotoFileInput').files[0];
    if (photoFile) {
      formData.append('photo', photoFile);
    }

    await apiRequest('/media/photos', {
      method: 'POST',
      body: formData
    });

    hideAddPhotoModal();
    await loadPhotos();
    alert('Photo added successfully!');
  } catch (error) {
    console.error('Failed to add photo:', error);
    alert('Failed to add photo: ' + error.message);
  }
}

// Add Story Handler
async function handleAddStory(event) {
  event.preventDefault();
  
  try {
    const storyData = {
      storyTitle: document.getElementById('addStoryTitle').value,
      storyContent: document.getElementById('addStoryContent').value,
      authorName: document.getElementById('addStoryAuthorName').value,
      authorTitle: document.getElementById('addStoryAuthorTitle').value,
      category: document.getElementById('addStoryCategory').value,
      isFeatured: document.getElementById('addStoryFeatured').checked,
      isPublished: document.getElementById('addStoryPublished').checked
    };

    await apiRequest('/get-involved/admin/stories', {
      method: 'POST',
      body: JSON.stringify(storyData)
    });

    hideAddStoryModal();
    await loadStories();
    alert('Community story added successfully!');
  } catch (error) {
    console.error('Failed to add story:', error);
    alert('Failed to add story: ' + error.message);
  }
}

// Add Testimonial Handler
async function handleAddTestimonial(event) {
  event.preventDefault();
  
  try {
    const testimonialData = {
      name: document.getElementById('addTestimonialName').value,
      role: document.getElementById('addTestimonialRole').value,
      organization: document.getElementById('addTestimonialOrganization').value,
      quote: document.getElementById('addTestimonialQuote').value,
      project: document.getElementById('addTestimonialProject').value,
      rating: document.getElementById('addTestimonialRating').value,
      isFeatured: document.getElementById('addTestimonialFeatured').checked,
      isPublished: document.getElementById('addTestimonialPublished').checked
    };

    await apiRequest('/media/testimonials', {
      method: 'POST',
      body: JSON.stringify(testimonialData)
    });

    hideAddTestimonialModal();
    await loadTestimonials();
    alert('Testimonial added successfully!');
  } catch (error) {
    console.error('Failed to add testimonial:', error);
    alert('Failed to add testimonial: ' + error.message);
  }
}

// Add Team Member Handler
async function handleAddTeamMember(event) {
  event.preventDefault();
  
  try {
    const formData = new FormData();
    formData.append('name', document.getElementById('addTeamMemberName').value);
    formData.append('role', document.getElementById('addTeamMemberRole').value);
    formData.append('bio', document.getElementById('addTeamMemberBio').value);
    formData.append('displayOrder', document.getElementById('addTeamMemberOrder').value);
    formData.append('isActive', document.getElementById('addTeamMemberActive').checked);

    const imageFile = document.getElementById('addTeamMemberImageFile').files[0];
    if (imageFile) {
      formData.append('image', imageFile);
    } else if (document.getElementById('addTeamMemberImageUrl').value) {
      formData.append('imageUrl', document.getElementById('addTeamMemberImageUrl').value);
    }

    await apiRequest('/thecolleagueuni/team', {
      method: 'POST',
      body: formData
    });

    hideAddTeamMemberModal();
    await loadTeamMembers();
    alert('Team member added successfully!');
  } catch (error) {
    console.error('Failed to add team member:', error);
    alert('Failed to add team member: ' + error.message);
  }
}

// Add Initiative Handler
async function handleAddInitiative(event) {
  event.preventDefault();
  
  try {
    const initiativeData = {
      title: document.getElementById('addInitiativeTitle').value,
      description: document.getElementById('addInitiativeDescription').value,
      status: document.getElementById('addInitiativeStatus').value,
      targetDate: document.getElementById('addInitiativeTargetDate').value,
      isActive: document.getElementById('addInitiativeActive').checked
    };

    await apiRequest('/colleagues/initiatives', {
      method: 'POST',
      body: JSON.stringify(initiativeData)
    });

    hideAddInitiativeModal();
    await loadInitiatives();
    alert('Initiative added successfully!');
  } catch (error) {
    console.error('Failed to add initiative:', error);
    alert('Failed to add initiative: ' + error.message);
  }
}

// ===== FILE UPLOAD PREVIEW FUNCTIONALITY =====

function setupFileUploadPreview(inputId, previewId) {
  const input = document.getElementById(inputId);
  const preview = document.getElementById(previewId);
  
  if (input && preview) {
    input.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          preview.innerHTML = `<img src="${e.target.result}" alt="Preview" style="max-width: 200px; border-radius: 8px;">`;
        };
        reader.readAsDataURL(file);
      }
    });
  }
}

// ===== INITIALIZATION =====

// Auto show if token present
document.addEventListener('DOMContentLoaded', function() {
  console.log(' Initializing Admin Dashboard...');
  
  // Initialize file upload previews
  setupFileUploadPreview('addNewsImageInput', 'addNewsImagePreview');
  setupFileUploadPreview('addEventImageInput', 'addEventImagePreview');
  setupFileUploadPreview('addMainImageInput', 'addMainImagePreview');
  setupFileUploadPreview('addPhotoFileInput', 'addPhotoPreview');
  setupFileUploadPreview('addDesignFileInput', 'addDesignPreview');
  setupFileUploadPreview('addTeamMemberImageFile', 'addTeamMemberImagePreview');
  
  // Edit modal file uploads
  setupFileUploadPreview('editNewsImageInput', 'editNewsImagePreview');
  setupFileUploadPreview('editEventImageInput', 'editEventImagePreview');
  setupFileUploadPreview('editMainImageInput', 'editMainImagePreview');
  setupFileUploadPreview('editTeamMemberImageFile', 'editTeamMemberImagePreview');

  // Attach form handlers
  const addNewsForm = document.getElementById('addNewsForm');
  if (addNewsForm) {
    addNewsForm.addEventListener('submit', handleAddNews);
  }

  const addEventForm = document.getElementById('addEventForm');
  if (addEventForm) {
    addEventForm.addEventListener('submit', handleAddEvent);
  }

  const addDesignProjectForm = document.getElementById('addDesignProjectForm');
  if (addDesignProjectForm) {
    addDesignProjectForm.addEventListener('submit', handleAddDesignProject);
  }

  const addResearchForm = document.getElementById('addResearchForm');
  if (addResearchForm) {
    addResearchForm.addEventListener('submit', handleAddResearch);
  }

  const addWorkshopForm = document.getElementById('addWorkshopForm');
  if (addWorkshopForm) {
    addWorkshopForm.addEventListener('submit', handleAddWorkshop);
  }

  const addPhotoForm = document.getElementById('addPhotoForm');
  if (addPhotoForm) {
    addPhotoForm.addEventListener('submit', handleAddPhoto);
  }

  const addStoryForm = document.getElementById('addStoryForm');
  if (addStoryForm) {
    addStoryForm.addEventListener('submit', handleAddStory);
  }

  const addTestimonialForm = document.getElementById('addTestimonialForm');
  if (addTestimonialForm) {
    addTestimonialForm.addEventListener('submit', handleAddTestimonial);
  }

  const addTeamMemberForm = document.getElementById('addTeamMemberForm');
  if (addTeamMemberForm) {
    addTeamMemberForm.addEventListener('submit', handleAddTeamMember);
  }

  const addInitiativeForm = document.getElementById('addInitiativeForm');
  if (addInitiativeForm) {
    addInitiativeForm.addEventListener('submit', handleAddInitiative);
  }

  // Attach placeholder handlers for other forms
  const otherForms = [
    'addVideoForm', 'addTutorialForm', 'addExhibitionForm', 'addDesignForm',
    'editNewsForm', 'editEventForm', 'editContactForm', 'editDesignProjectForm',
    'editResearchForm', 'editWorkshopForm', 'editTeamMemberForm'
  ];

  otherForms.forEach(formId => {
    const form = document.getElementById(formId);
    if (form) {
      form.addEventListener('submit', function(event) {
        event.preventDefault();
        alert(`${formId.replace('add', 'Add').replace('edit', 'Edit').replace('Form', '')} functionality will be implemented in the next update`);
      });
    }
  });

  // Check authentication
  const token = getValidToken();
  if (token) {
    console.log(' Valid token found, showing dashboard');
    showDashboard();
  } else {
    console.log(' No valid token found, showing login');
    showLogin();
  }
});

// Close modals when clicking overlay
document.getElementById('overlay').addEventListener('click', function() {
  document.querySelectorAll('.modal').forEach(modal => {
    modal.classList.add('hidden');
  });
  this.classList.remove('active');
});

// Close modal when pressing Escape key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    document.querySelectorAll('.modal').forEach(modal => {
      modal.classList.add('hidden');
    });
    const overlay = document.getElementById('overlay');
    if (overlay) overlay.classList.remove('active');
  }
});

// ===== PLACEHOLDER FUNCTIONS FOR CRUD OPERATIONS =====

// These functions will be implemented based on your specific backend API

async function toggleFeatured(section, type, id, featured) {
  try {
    await apiRequest(`/${section}/${type}/${id}/feature`, {
      method: 'PUT',
      body: JSON.stringify({ featured })
    });
    // Reload the current tab based on section and type
    switch(section) {
      case 'media':
        showMediaTab(currentMediaTab);
        break;
      case 'design':
        showDesignTab(currentDesignTab);
        break;
      case 'research':
        showResearchTab(currentResearchTab);
        break;
      case 'newsevents':
        showNewsEventsTab(currentNewsEventsTab);
        break;
    }
  } catch (error) {
    console.error('Failed to toggle featured:', error);
    alert('Failed to update featured status: ' + error.message);
  }
}

async function deleteMediaItem(type, id) {
  try {
    await apiRequest(`/media/${type}/${id}`, { method: 'DELETE' });
    showMediaTab(currentMediaTab);
  } catch (error) {
    console.error('Failed to delete media item:', error);
    alert('Failed to delete item: ' + error.message);
  }
}

async function updateTestimonialStatus(id, status) {
  try {
    await apiRequest(`/media/testimonials/${id}/status`, {
      method: 'PUT',
      body: JSON.stringify({ status })
    });
    showMediaTab('testimonials');
  } catch (error) {
    console.error('Failed to update testimonial status:', error);
    alert('Failed to update status: ' + error.message);
  }
}

async function toggleDesignProject(id, published) {
  try {
    await apiRequest(`/design/admin/projects/${id}/publish`, {
      method: 'PUT',
      body: JSON.stringify({ published })
    });
    showDesignTab(currentDesignTab);
  } catch (error) {
    console.error('Failed to toggle design project:', error);
    alert('Failed to update publish status: ' + error.message);
  }
}

async function toggleFeaturedDesignProject(id, featured) {
  try {
    await apiRequest(`/design/admin/projects/${id}/feature`, {
      method: 'PUT',
      body: JSON.stringify({ featured })
    });
    showDesignTab(currentDesignTab);
  } catch (error) {
    console.error('Failed to toggle featured design project:', error);
    alert('Failed to update featured status: ' + error.message);
  }
}

async function deleteDesignProject(id) {
  try {
    await apiRequest(`/design/admin/projects/${id}`, { method: 'DELETE' });
    showDesignTab(currentDesignTab);
  } catch (error) {
    console.error('Failed to delete design project:', error);
    alert('Failed to delete project: ' + error.message);
  }
}

async function toggleResearchArticle(id, published) {
  try {
    await apiRequest(`/research/admin/articles/${id}/publish`, {
      method: 'PUT',
      body: JSON.stringify({ published })
    });
    showResearchTab(currentResearchTab);
  } catch (error) {
    console.error('Failed to toggle research article:', error);
    alert('Failed to update publish status: ' + error.message);
  }
}

async function toggleFeaturedResearchArticle(id, featured) {
  try {
    await apiRequest(`/research/admin/articles/${id}/feature`, {
      method: 'PUT',
      body: JSON.stringify({ featured })
    });
    showResearchTab(currentResearchTab);
  } catch (error) {
    console.error('Failed to toggle featured research article:', error);
    alert('Failed to update featured status: ' + error.message);
  }
}

async function deleteResearchArticle(id) {
  try {
    await apiRequest(`/research/admin/articles/${id}`, { method: 'DELETE' });
    showResearchTab(currentResearchTab);
  } catch (error) {
    console.error('Failed to delete research article:', error);
    alert('Failed to delete article: ' + error.message);
  }
}

async function toggleNewsEvent(id, published, type) {
  try {
    await apiRequest(`/newsevents/${type}/${id}/publish`, {
      method: 'PUT',
      body: JSON.stringify({ published })
    });
    showNewsEventsTab(currentNewsEventsTab);
  } catch (error) {
    console.error('Failed to toggle news/event:', error);
    alert('Failed to update publish status: ' + error.message);
  }
}

async function toggleFeaturedNewsEvent(id, featured, type) {
  try {
    await apiRequest(`/newsevents/${type}/${id}/feature`, {
      method: 'PUT',
      body: JSON.stringify({ featured })
    });
    showNewsEventsTab(currentNewsEventsTab);
  } catch (error) {
    console.error('Failed to toggle featured news/event:', error);
    alert('Failed to update featured status: ' + error.message);
  }
}

async function deleteNewsEvent(id, type) {
  try {
    await apiRequest(`/newsevents/${type}/${id}`, { method: 'DELETE' });
    showNewsEventsTab(currentNewsEventsTab);
  } catch (error) {
    console.error('Failed to delete news/event:', error);
    alert('Failed to delete item: ' + error.message);
  }
}

async function updateColleaguesContactStatus(id, status) {
  try {
    await apiRequest(`/thecolleagueuni/contacts/${id}/status`, {
      method: 'PUT',
      body: JSON.stringify({ status })
    });
    showColleaguesTab('colleagues-contacts');
  } catch (error) {
    console.error('Failed to update contact status:', error);
    alert('Failed to update status: ' + error.message);
  }
}

async function deleteColleaguesContact(id) {
  try {
    await apiRequest(`/thecolleagueuni/contacts/${id}`, { method: 'DELETE' });
    showColleaguesTab('colleagues-contacts');
  } catch (error) {
    console.error('Failed to delete contact:', error);
    alert('Failed to delete contact: ' + error.message);
  }
}

async function toggleTeamMember(id, active) {
  try {
    await apiRequest(`/thecolleagueuni/team/${id}/active`, {
      method: 'PUT',
      body: JSON.stringify({ active })
    });
    showColleaguesTab('colleagues-team');
  } catch (error) {
    console.error('Failed to toggle team member:', error);
    alert('Failed to update active status: ' + error.message);
  }
}

async function deleteTeamMember(id) {
  try {
    await apiRequest(`/thecolleagueuni/team/${id}`, { method: 'DELETE' });
    showColleaguesTab('colleagues-team');
  } catch (error) {
    console.error('Failed to delete team member:', error);
    alert('Failed to delete team member: ' + error.message);
  }
}

async function toggleInitiative(id, active) {
  try {
    await apiRequest(`/colleagues/initiatives/${id}/active`, {
      method: 'PUT',
      body: JSON.stringify({ active })
    });
    showColleaguesTab('colleagues-initiatives');
  } catch (error) {
    console.error('Failed to toggle initiative:', error);
    alert('Failed to update active status: ' + error.message);
  }
}

async function deleteInitiative(id) {
  try {
    await apiRequest(`/colleagues/initiatives/${id}`, { method: 'DELETE' });
    showColleaguesTab('colleagues-initiatives');
  } catch (error) {
    console.error('Failed to delete initiative:', error);
    alert('Failed to delete initiative: ' + error.message);
  }
}

// Edit functions placeholder
function editMediaItem(item, type) {
  alert(`Edit ${type} functionality coming soon!`);
}

function editEducationItem(item, type) {
  alert(`Edit ${type} functionality coming soon!`);
}

function editDesignProject(project) {
  alert('Edit design project functionality coming soon!');
}

function editResearchArticle(article) {
  alert('Edit research article functionality coming soon!');
}

function editNewsEvent(item) {
  alert(`Edit ${item.type} functionality coming soon!`);
}

function editTeamMember(member) {
  alert('Edit team member functionality coming soon!');
}

function editInitiative(initiative) {
  alert('Edit initiative functionality coming soon!');
}

console.log(' Admin Dashboard JavaScript loaded successfully');
    </script>
</body>s
</html>